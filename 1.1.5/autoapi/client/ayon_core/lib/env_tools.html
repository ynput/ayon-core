<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=prev href=dateutils.html><link rel=next href=events.html><link rel=icon href=../../../../img/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.8"><title>env_tools - ayon-core</title><link rel=stylesheet href=../../../../assets/stylesheets/main.8608ea7d.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><script src=https://unpkg.com/iframe-worker/shim></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../../css/custom.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#client.ayon_core.lib.env_tools class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../../index.html title=ayon-core class="md-header__button md-logo" aria-label=ayon-core data-md-component=logo> <img src=../../../../img/ay-symbol-blackw-full.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ayon-core </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> env_tools </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../../index.html title=ayon-core class="md-nav__button md-logo" aria-label=ayon-core data-md-component=logo> <img src=../../../../img/ay-symbol-blackw-full.png alt=logo> </a> ayon-core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../index.html class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../../license.html class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1 checked> <div class="md-nav__link md-nav__container"> <a href=../../index.html class="md-nav__link "> <span class=md-ellipsis> client </span> </a> <label class="md-nav__link " for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> client </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1 checked> <div class="md-nav__link md-nav__container"> <a href=../index.html class="md-nav__link "> <span class=md-ellipsis> ayon_core </span> </a> <label class="md-nav__link " for=__nav_3_1_1 id=__nav_3_1_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_1_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1> <span class="md-nav__icon md-icon"></span> ayon_core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../__main__.html class=md-nav__link> <span class=md-ellipsis> __main__ </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../addon/base.html class=md-nav__link> <span class=md-ellipsis> addon </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../cli.html class=md-nav__link> <span class=md-ellipsis> cli </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../hooks/pre_add_last_workfile_arg.html class=md-nav__link> <span class=md-ellipsis> hooks </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../host/dirmap.html class=md-nav__link> <span class=md-ellipsis> host </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1_6 checked> <div class="md-nav__link md-nav__container"> <a href=index.html class="md-nav__link "> <span class=md-ellipsis> lib </span> </a> <label class="md-nav__link " for=__nav_3_1_1_6 id=__nav_3_1_1_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_1_1_6_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1_6> <span class="md-nav__icon md-icon"></span> lib </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=attribute_definitions.html class=md-nav__link> <span class=md-ellipsis> attribute_definitions </span> </a> </li> <li class=md-nav__item> <a href=ayon_connection.html class=md-nav__link> <span class=md-ellipsis> ayon_connection </span> </a> </li> <li class=md-nav__item> <a href=ayon_info.html class=md-nav__link> <span class=md-ellipsis> ayon_info </span> </a> </li> <li class=md-nav__item> <a href=cache.html class=md-nav__link> <span class=md-ellipsis> cache </span> </a> </li> <li class=md-nav__item> <a href=dateutils.html class=md-nav__link> <span class=md-ellipsis> dateutils </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> env_tools </span> <span class="md-nav__icon md-icon"></span> </label> <a href=env_tools.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> env_tools </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools class=md-nav__link> <span class=md-ellipsis> env_tools </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools.CycleError class=md-nav__link> <span class=md-ellipsis> CycleError </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools.DynamicKeyClashError class=md-nav__link> <span class=md-ellipsis> DynamicKeyClashError </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools._PartialFormatDict class=md-nav__link> <span class=md-ellipsis> _PartialFormatDict </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools._partial_format class=md-nav__link> <span class=md-ellipsis> _partial_format </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools._topological_sort class=md-nav__link> <span class=md-ellipsis> _topological_sort </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools.compute_env_variables_structure class=md-nav__link> <span class=md-ellipsis> compute_env_variables_structure </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools.env_value_to_bool class=md-nav__link> <span class=md-ellipsis> env_value_to_bool </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools.get_paths_from_environ class=md-nav__link> <span class=md-ellipsis> get_paths_from_environ </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools.merge_env_variables class=md-nav__link> <span class=md-ellipsis> merge_env_variables </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools.parse_env_variables_structure class=md-nav__link> <span class=md-ellipsis> parse_env_variables_structure </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=events.html class=md-nav__link> <span class=md-ellipsis> events </span> </a> </li> <li class=md-nav__item> <a href=execute.html class=md-nav__link> <span class=md-ellipsis> execute </span> </a> </li> <li class=md-nav__item> <a href=file_transaction.html class=md-nav__link> <span class=md-ellipsis> file_transaction </span> </a> </li> <li class=md-nav__item> <a href=local_settings.html class=md-nav__link> <span class=md-ellipsis> local_settings </span> </a> </li> <li class=md-nav__item> <a href=log.html class=md-nav__link> <span class=md-ellipsis> log </span> </a> </li> <li class=md-nav__item> <a href=path_templates.html class=md-nav__link> <span class=md-ellipsis> path_templates </span> </a> </li> <li class=md-nav__item> <a href=path_tools.html class=md-nav__link> <span class=md-ellipsis> path_tools </span> </a> </li> <li class=md-nav__item> <a href=plugin_tools.html class=md-nav__link> <span class=md-ellipsis> plugin_tools </span> </a> </li> <li class=md-nav__item> <a href=profiles_filtering.html class=md-nav__link> <span class=md-ellipsis> profiles_filtering </span> </a> </li> <li class=md-nav__item> <a href=profiling.html class=md-nav__link> <span class=md-ellipsis> profiling </span> </a> </li> <li class=md-nav__item> <a href=python_module_tools.html class=md-nav__link> <span class=md-ellipsis> python_module_tools </span> </a> </li> <li class=md-nav__item> <a href=terminal.html class=md-nav__link> <span class=md-ellipsis> terminal </span> </a> </li> <li class=md-nav__item> <a href=transcoding.html class=md-nav__link> <span class=md-ellipsis> transcoding </span> </a> </li> <li class=md-nav__item> <a href=vendor_bin_utils.html class=md-nav__link> <span class=md-ellipsis> vendor_bin_utils </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../pipeline/actions.html class=md-nav__link> <span class=md-ellipsis> pipeline </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../plugins/actions/open_file_explorer.html class=md-nav__link> <span class=md-ellipsis> plugins </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../resources/app_icons/index.html class=md-nav__link> <span class=md-ellipsis> resources </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../scripts/ocio_wrapper.html class=md-nav__link> <span class=md-ellipsis> scripts </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../settings/lib.html class=md-nav__link> <span class=md-ellipsis> settings </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../style/color_defs.html class=md-nav__link> <span class=md-ellipsis> style </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../tests/conftest.html class=md-nav__link> <span class=md-ellipsis> tests </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../tools/attribute_defs/_constants.html class=md-nav__link> <span class=md-ellipsis> tools </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../vendor/python/qargparse.html class=md-nav__link> <span class=md-ellipsis> vendor </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../version.html class=md-nav__link> <span class=md-ellipsis> version </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../server/settings/conversion.html class=md-nav__link> <span class=md-ellipsis> server </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools class=md-nav__link> <span class=md-ellipsis> env_tools </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools.CycleError class=md-nav__link> <span class=md-ellipsis> CycleError </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools.DynamicKeyClashError class=md-nav__link> <span class=md-ellipsis> DynamicKeyClashError </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools._PartialFormatDict class=md-nav__link> <span class=md-ellipsis> _PartialFormatDict </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools._partial_format class=md-nav__link> <span class=md-ellipsis> _partial_format </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools._topological_sort class=md-nav__link> <span class=md-ellipsis> _topological_sort </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools.compute_env_variables_structure class=md-nav__link> <span class=md-ellipsis> compute_env_variables_structure </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools.env_value_to_bool class=md-nav__link> <span class=md-ellipsis> env_value_to_bool </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools.get_paths_from_environ class=md-nav__link> <span class=md-ellipsis> get_paths_from_environ </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools.merge_env_variables class=md-nav__link> <span class=md-ellipsis> merge_env_variables </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.env_tools.parse_env_variables_structure class=md-nav__link> <span class=md-ellipsis> parse_env_variables_structure </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>env_tools</h1> <div class="doc doc-object doc-module"> <a id=client.ayon_core.lib.env_tools></a> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=client.ayon_core.lib.env_tools.CycleError class="doc doc-heading"> <code>CycleError</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=ValueError>ValueError</span></code></p> <p>Raised when a cycle is detected in dynamic env variables compute.</p> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/env_tools.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>CycleError</span><span class=p>(</span><span class=ne>ValueError</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Raised when a cycle is detected in dynamic env variables compute.&quot;&quot;&quot;</span>
    <span class=k>pass</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-class"> <h2 id=client.ayon_core.lib.env_tools.DynamicKeyClashError class="doc doc-heading"> <code>DynamicKeyClashError</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=Exception>Exception</span></code></p> <p>Raised when dynamic key clashes with an existing key.</p> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/env_tools.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>DynamicKeyClashError</span><span class=p>(</span><span class=ne>Exception</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Raised when dynamic key clashes with an existing key.&quot;&quot;&quot;</span>
    <span class=k>pass</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-class"> <h2 id=client.ayon_core.lib.env_tools._PartialFormatDict class="doc doc-heading"> <code>_PartialFormatDict</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=dict>dict</span></code></p> <p>This supports partial formatting.</p> <p>Missing keys are replaced with the return value of <strong>missing</strong>.</p> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/env_tools.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>_PartialFormatDict</span><span class=p>(</span><span class=nb>dict</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;This supports partial formatting.</span>

<span class=sd>    Missing keys are replaced with the return value of __missing__.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_missing_template</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;{{</span><span class=si>{key}</span><span class=s2>}}&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=nf>set_missing_template</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>template</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_missing_template</span> <span class=o>=</span> <span class=n>template</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__missing__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_missing_template</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=n>key</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.env_tools._partial_format class="doc doc-heading"> <code class="highlight language-python"><span class=n>_partial_format</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>data</span><span class=p>,</span> <span class=n>missing_template</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return string <code>s</code> formatted by <code>data</code> allowing a partial format</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>value</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The string that will be formatted</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>The dictionary used to format with.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>missing_template</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>The template to use when a key is missing from the data. If <code>None</code>, the key will remain unformatted.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=example open> <summary>Example</summary> <blockquote> <blockquote> <blockquote> <p>_partial_format("{d} {a} {b} {c} {d}", {'b': "and", 'd': "left"}) 'left {a} and {c} left'</p> </blockquote> </blockquote> </blockquote> </details> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/env_tools.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>_partial_format</span><span class=p>(</span>
    <span class=n>value</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
    <span class=n>data</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span>
    <span class=n>missing_template</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return string `s` formatted by `data` allowing a partial format</span>

<span class=sd>    Arguments:</span>
<span class=sd>        value (str): The string that will be formatted</span>
<span class=sd>        data (dict): The dictionary used to format with.</span>
<span class=sd>        missing_template (Optional[str]): The template to use when a key is</span>
<span class=sd>            missing from the data. If `None`, the key will remain unformatted.</span>

<span class=sd>    Example:</span>
<span class=sd>        &gt;&gt;&gt; _partial_format(&quot;{d} {a} {b} {c} {d}&quot;, {&#39;b&#39;: &quot;and&quot;, &#39;d&#39;: &quot;left&quot;})</span>
<span class=sd>        &#39;left {a} and {c} left&#39;</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>mapping</span> <span class=o>=</span> <span class=n>_PartialFormatDict</span><span class=p>(</span><span class=o>**</span><span class=n>data</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>missing_template</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>mapping</span><span class=o>.</span><span class=n>set_missing_template</span><span class=p>(</span><span class=n>missing_template</span><span class=p>)</span>

    <span class=n>formatter</span> <span class=o>=</span> <span class=n>Formatter</span><span class=p>()</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>output</span> <span class=o>=</span> <span class=n>formatter</span><span class=o>.</span><span class=n>vformat</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=p>(),</span> <span class=n>mapping</span><span class=p>)</span>
    <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
        <span class=n>r_token</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s2>&quot;({.*?})&quot;</span><span class=p>)</span>
        <span class=n>output</span> <span class=o>=</span> <span class=n>value</span>
        <span class=k>for</span> <span class=n>match</span> <span class=ow>in</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=n>r_token</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=n>output</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=n>match</span><span class=p>,</span> <span class=n>match</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=o>**</span><span class=n>data</span><span class=p>),</span> <span class=n>output</span><span class=p>)</span>
            <span class=k>except</span> <span class=p>(</span><span class=ne>KeyError</span><span class=p>,</span> <span class=ne>ValueError</span><span class=p>,</span> <span class=ne>IndexError</span><span class=p>):</span>
                <span class=k>continue</span>
    <span class=k>return</span> <span class=n>output</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.env_tools._topological_sort class="doc doc-heading"> <code class="highlight language-python"><span class=n>_topological_sort</span><span class=p>(</span><span class=n>dependencies</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Sort values subject to dependency constraints.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>dependencies</code> </td> <td> <code>dict[str, set[str]</code> </td> <td> <div class=doc-md-description> <p>Mapping of environment variable keys to a set of keys they depend on.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=tuple>tuple</span>[<span title=list>list</span>[<span title=str>str</span>], <span title=list>list</span>[<span title=str>str</span>]]</code> </td> <td> <div class=doc-md-description> <p>tuple[list[str], list[str]]: A tuple of two lists. The first list contains the ordered keys in which order should be environment keys filled, the second list contains the keys that would cause cyclic fill of values.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/env_tools.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>149</span>
<span class=normal>150</span>
<span class=normal>151</span>
<span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span>
<span class=normal>164</span>
<span class=normal>165</span>
<span class=normal>166</span>
<span class=normal>167</span>
<span class=normal>168</span>
<span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span>
<span class=normal>172</span>
<span class=normal>173</span>
<span class=normal>174</span>
<span class=normal>175</span>
<span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>_topological_sort</span><span class=p>(</span>
    <span class=n>dependencies</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>set</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Sort values subject to dependency constraints.</span>

<span class=sd>    Args:</span>
<span class=sd>        dependencies (dict[str, set[str]): Mapping of environment variable</span>
<span class=sd>            keys to a set of keys they depend on.</span>

<span class=sd>    Returns:</span>
<span class=sd>        tuple[list[str], list[str]]: A tuple of two lists. The first list</span>
<span class=sd>            contains the ordered keys in which order should be environment</span>
<span class=sd>            keys filled, the second list contains the keys that would cause</span>
<span class=sd>            cyclic fill of values.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>num_heads</span> <span class=o>=</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>  <span class=c1># num arrows pointing in</span>
    <span class=n>tails</span> <span class=o>=</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>  <span class=c1># list of arrows going out</span>
    <span class=n>heads</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># unique list of heads in order first seen</span>
    <span class=k>for</span> <span class=n>head</span><span class=p>,</span> <span class=n>tail_values</span> <span class=ow>in</span> <span class=n>dependencies</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=k>for</span> <span class=n>tail_value</span> <span class=ow>in</span> <span class=n>tail_values</span><span class=p>:</span>
            <span class=n>num_heads</span><span class=p>[</span><span class=n>tail_value</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
            <span class=k>if</span> <span class=n>head</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>tails</span><span class=p>:</span>
                <span class=n>heads</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>head</span><span class=p>)</span>
            <span class=n>tails</span><span class=p>[</span><span class=n>head</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>tail_value</span><span class=p>)</span>

    <span class=n>ordered</span> <span class=o>=</span> <span class=p>[</span><span class=n>head</span> <span class=k>for</span> <span class=n>head</span> <span class=ow>in</span> <span class=n>heads</span> <span class=k>if</span> <span class=n>head</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>num_heads</span><span class=p>]</span>
    <span class=k>for</span> <span class=n>head</span> <span class=ow>in</span> <span class=n>ordered</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>tail</span> <span class=ow>in</span> <span class=n>tails</span><span class=p>[</span><span class=n>head</span><span class=p>]:</span>
            <span class=n>num_heads</span><span class=p>[</span><span class=n>tail</span><span class=p>]</span> <span class=o>-=</span> <span class=mi>1</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>num_heads</span><span class=p>[</span><span class=n>tail</span><span class=p>]:</span>
                <span class=n>ordered</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>tail</span><span class=p>)</span>
    <span class=n>cyclic</span> <span class=o>=</span> <span class=p>[</span><span class=n>tail</span> <span class=k>for</span> <span class=n>tail</span><span class=p>,</span> <span class=n>heads</span> <span class=ow>in</span> <span class=n>num_heads</span><span class=o>.</span><span class=n>items</span><span class=p>()</span> <span class=k>if</span> <span class=n>heads</span><span class=p>]</span>
    <span class=k>return</span> <span class=n>ordered</span><span class=p>,</span> <span class=n>cyclic</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.env_tools.compute_env_variables_structure class="doc doc-heading"> <code class="highlight language-python"><span class=n>compute_env_variables_structure</span><span class=p>(</span><span class=n>env</span><span class=p>,</span> <span class=n>fill_dynamic_keys</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Compute the result from recursive dynamic environment.</p> <details class=note open> <summary>Keys that are not present in the data will remain unformatted as the</summary> <p>original keys. So they can be formatted against the current user environment when merging. So {"A": "{key}"} will remain {key} if not present in the dynamic environment.</p> </details> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/env_tools.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span>
<span class=normal>242</span>
<span class=normal>243</span>
<span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span>
<span class=normal>288</span>
<span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>compute_env_variables_structure</span><span class=p>(</span>
    <span class=n>env</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span>
    <span class=n>fill_dynamic_keys</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Compute the result from recursive dynamic environment.</span>

<span class=sd>    Note: Keys that are not present in the data will remain unformatted as the</span>
<span class=sd>        original keys. So they can be formatted against the current user</span>
<span class=sd>        environment when merging. So {&quot;A&quot;: &quot;{key}&quot;} will remain {key} if not</span>
<span class=sd>        present in the dynamic environment.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>env</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>

    <span class=c1># Collect dependencies</span>
    <span class=n>dependencies</span> <span class=o>=</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=nb>set</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>env</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>dependent_keys</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s2>&quot;{(.+?)}&quot;</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>dependent_key</span> <span class=ow>in</span> <span class=n>dependent_keys</span><span class=p>:</span>
            <span class=c1># Ignore reference to itself or key is not in env</span>
            <span class=k>if</span> <span class=n>dependent_key</span> <span class=o>!=</span> <span class=n>key</span> <span class=ow>and</span> <span class=n>dependent_key</span> <span class=ow>in</span> <span class=n>env</span><span class=p>:</span>
                <span class=n>dependencies</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>dependent_key</span><span class=p>)</span>

    <span class=n>ordered</span><span class=p>,</span> <span class=n>cyclic</span> <span class=o>=</span> <span class=n>_topological_sort</span><span class=p>(</span><span class=n>dependencies</span><span class=p>)</span>

    <span class=c1># Check cycle</span>
    <span class=k>if</span> <span class=n>cyclic</span><span class=p>:</span>
        <span class=k>raise</span> <span class=n>CycleError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;A cycle is detected on: </span><span class=si>{</span><span class=n>cyclic</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Format dynamic values</span>
    <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=nb>reversed</span><span class=p>(</span><span class=n>ordered</span><span class=p>):</span>
        <span class=k>if</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>env</span><span class=p>:</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>env</span><span class=p>[</span><span class=n>key</span><span class=p>],</span> <span class=nb>str</span><span class=p>):</span>
                <span class=k>continue</span>
            <span class=n>data</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
            <span class=n>data</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>    <span class=c1># format without itself</span>
            <span class=n>env</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>_partial_format</span><span class=p>(</span><span class=n>env</span><span class=p>[</span><span class=n>key</span><span class=p>],</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>

    <span class=c1># Format dynamic keys</span>
    <span class=k>if</span> <span class=n>fill_dynamic_keys</span><span class=p>:</span>
        <span class=n>formatted</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>env</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
                <span class=n>formatted</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
                <span class=k>continue</span>

            <span class=n>new_key</span> <span class=o>=</span> <span class=n>_partial_format</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>env</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>new_key</span> <span class=ow>in</span> <span class=n>formatted</span><span class=p>:</span>
                <span class=k>raise</span> <span class=n>DynamicKeyClashError</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;Key clashes on: </span><span class=si>{</span><span class=n>new_key</span><span class=si>}</span><span class=s2> (source: </span><span class=si>{</span><span class=n>key</span><span class=si>}</span><span class=s2>)&quot;</span>
                <span class=p>)</span>

            <span class=n>formatted</span><span class=p>[</span><span class=n>new_key</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
        <span class=n>env</span> <span class=o>=</span> <span class=n>formatted</span>

    <span class=k>return</span> <span class=n>env</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.env_tools.env_value_to_bool class="doc doc-heading"> <code class="highlight language-python"><span class=n>env_value_to_bool</span><span class=p>(</span><span class=n>env_key</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Convert environment variable value to boolean.</p> <p>Function is based on value of the environemt variable. Value is lowered so function is not case sensitive.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>bool</code></td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>If value match to one of ["true", "yes", "1"] result if True but if value match to ["false", "no", "0"] result is False else default value is returned.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/env_tools.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>env_value_to_bool</span><span class=p>(</span>
    <span class=n>env_key</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=n>value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=n>default</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Convert environment variable value to boolean.</span>

<span class=sd>    Function is based on value of the environemt variable. Value is lowered</span>
<span class=sd>    so function is not case sensitive.</span>

<span class=sd>    Returns:</span>
<span class=sd>        bool: If value match to one of [&quot;true&quot;, &quot;yes&quot;, &quot;1&quot;] result if True</span>
<span class=sd>            but if value match to [&quot;false&quot;, &quot;no&quot;, &quot;0&quot;] result is False else</span>
<span class=sd>            default value is returned.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>value</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>env_key</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>default</span>

    <span class=k>if</span> <span class=n>value</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>value</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>env_key</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>value</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>value</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
        <span class=k>if</span> <span class=n>value</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&quot;true&quot;</span><span class=p>,</span> <span class=s2>&quot;yes&quot;</span><span class=p>,</span> <span class=s2>&quot;1&quot;</span><span class=p>,</span> <span class=s2>&quot;on&quot;</span><span class=p>):</span>
            <span class=k>return</span> <span class=kc>True</span>
        <span class=k>elif</span> <span class=n>value</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&quot;false&quot;</span><span class=p>,</span> <span class=s2>&quot;no&quot;</span><span class=p>,</span> <span class=s2>&quot;0&quot;</span><span class=p>,</span> <span class=s2>&quot;off&quot;</span><span class=p>):</span>
            <span class=k>return</span> <span class=kc>False</span>
    <span class=k>return</span> <span class=n>default</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.env_tools.get_paths_from_environ class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_paths_from_environ</span><span class=p>(</span><span class=n>env_key</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>env_value</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>return_first</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return existing paths from specific environment variable.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>env_key</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Environment key where should look for paths.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>env_value</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Value of environment variable. Argument <code>env_key</code> is skipped if this argument is entered.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>return_first</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Return first found value or return list of found paths. <code>None</code> or empty list returned if nothing found.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Optional>Optional</span>[<span title=typing.Union>Union</span>[<span title=str>str</span>, <span title=list>list</span>[<span title=str>str</span>]]]</code> </td> <td> <div class=doc-md-description> <p>Optional[Union[str, list[str]]]: Result of found path/s.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/env_tools.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_paths_from_environ</span><span class=p>(</span>
    <span class=n>env_key</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=n>env_value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=n>return_first</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]]]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return existing paths from specific environment variable.</span>

<span class=sd>    Args:</span>
<span class=sd>        env_key (Optional[str]): Environment key where should look for paths.</span>
<span class=sd>        env_value (Optional[str]): Value of environment variable.</span>
<span class=sd>            Argument `env_key` is skipped if this argument is entered.</span>
<span class=sd>        return_first (bool): Return first found value or return list of found</span>
<span class=sd>            paths. `None` or empty list returned if nothing found.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Optional[Union[str, list[str]]]: Result of found path/s.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>existing_paths</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>env_key</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>env_value</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>return_first</span><span class=p>:</span>
            <span class=k>return</span> <span class=kc>None</span>
        <span class=k>return</span> <span class=n>existing_paths</span>

    <span class=k>if</span> <span class=n>env_value</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>env_value</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>env_key</span><span class=p>)</span> <span class=ow>or</span> <span class=s2>&quot;&quot;</span>

    <span class=n>path_items</span> <span class=o>=</span> <span class=n>env_value</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>pathsep</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>path_items</span><span class=p>:</span>
        <span class=c1># Skip empty string</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>path</span><span class=p>:</span>
            <span class=k>continue</span>
        <span class=c1># Normalize path</span>
        <span class=n>path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>normpath</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
        <span class=c1># Check if path exists</span>
        <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
            <span class=c1># Return path if `return_first` is set to True</span>
            <span class=k>if</span> <span class=n>return_first</span><span class=p>:</span>
                <span class=k>return</span> <span class=n>path</span>
            <span class=c1># Store path</span>
            <span class=n>existing_paths</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>

    <span class=c1># Return None if none of paths exists</span>
    <span class=k>if</span> <span class=n>return_first</span><span class=p>:</span>
        <span class=k>return</span> <span class=kc>None</span>
    <span class=c1># Return all existing paths from environment variable</span>
    <span class=k>return</span> <span class=n>existing_paths</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.env_tools.merge_env_variables class="doc doc-heading"> <code class="highlight language-python"><span class=n>merge_env_variables</span><span class=p>(</span><span class=n>src_env</span><span class=p>,</span> <span class=n>dst_env</span><span class=p>,</span> <span class=n>missing_template</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Merge the tools environment with the 'current_env'.</p> <p>This finalizes the join with a current environment by formatting the remainder of dynamic variables with that from the current environment.</p> <p>Remaining missing variables result in an empty value.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>src_env</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>The dynamic environment</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>dst_env</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>The target environment variables mapping to merge the dynamic environment into.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>missing_template</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Argument passed to '_partial_format' during merging. <code>None</code> should keep missing keys unchanged.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=dict>dict</span>[<span title=str>str</span>, <span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>dict[str, str]: The resulting environment after the merge.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/env_tools.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>merge_env_variables</span><span class=p>(</span>
    <span class=n>src_env</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span>
    <span class=n>dst_env</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span>
    <span class=n>missing_template</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Merge the tools environment with the &#39;current_env&#39;.</span>

<span class=sd>    This finalizes the join with a current environment by formatting the</span>
<span class=sd>    remainder of dynamic variables with that from the current environment.</span>

<span class=sd>    Remaining missing variables result in an empty value.</span>

<span class=sd>    Args:</span>
<span class=sd>        src_env (dict): The dynamic environment</span>
<span class=sd>        dst_env (dict): The target environment variables mapping to merge</span>
<span class=sd>            the dynamic environment into.</span>
<span class=sd>        missing_template (str): Argument passed to &#39;_partial_format&#39; during</span>
<span class=sd>            merging. `None` should keep missing keys unchanged.</span>

<span class=sd>    Returns:</span>
<span class=sd>        dict[str, str]: The resulting environment after the merge.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>result</span> <span class=o>=</span> <span class=n>dst_env</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>src_env</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>result</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>_partial_format</span><span class=p>(</span>
            <span class=nb>str</span><span class=p>(</span><span class=n>value</span><span class=p>),</span> <span class=n>dst_env</span><span class=p>,</span> <span class=n>missing_template</span>
        <span class=p>)</span>

    <span class=k>return</span> <span class=n>result</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.env_tools.parse_env_variables_structure class="doc doc-heading"> <code class="highlight language-python"><span class=n>parse_env_variables_structure</span><span class=p>(</span><span class=n>env</span><span class=p>,</span> <span class=n>platform_name</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Parse environment for platform-specific values and paths as lists.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>env</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>The source environment to read.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>platform_name</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=client.ayon_core.lib.env_tools.PlatformName>PlatformName</span>]</code> </td> <td> <div class=doc-md-description> <p>Name of platform to parse for. Defaults to current platform.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> <code><span title=dict>dict</span>[<span title=str>str</span>, <span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>The flattened environment for a platform.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/env_tools.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>parse_env_variables_structure</span><span class=p>(</span>
    <span class=n>env</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>EnvValue</span><span class=p>],</span>
    <span class=n>platform_name</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>PlatformName</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Parse environment for platform-specific values and paths as lists.</span>

<span class=sd>    Args:</span>
<span class=sd>        env (dict): The source environment to read.</span>
<span class=sd>        platform_name (Optional[PlatformName]): Name of platform to parse for.</span>
<span class=sd>            Defaults to current platform.</span>

<span class=sd>    Returns:</span>
<span class=sd>        dict: The flattened environment for a platform.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>platform_name</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>platform_name</span> <span class=o>=</span> <span class=n>platform</span><span class=o>.</span><span class=n>system</span><span class=p>()</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>

    <span class=c1># Separator based on OS &#39;os.pathsep&#39; is &#39;;&#39; on Windows and &#39;:&#39; on Unix</span>
    <span class=n>sep</span> <span class=o>=</span> <span class=s2>&quot;;&quot;</span> <span class=k>if</span> <span class=n>platform_name</span> <span class=o>==</span> <span class=s2>&quot;windows&quot;</span> <span class=k>else</span> <span class=s2>&quot;:&quot;</span>

    <span class=n>result</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=k>for</span> <span class=n>variable</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>env</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=c1># Platform specific values</span>
        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
            <span class=n>value</span> <span class=o>=</span> <span class=n>value</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>platform_name</span><span class=p>)</span>

        <span class=c1># Allow to have lists as values in the tool data</span>
        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=p>(</span><span class=nb>list</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>)):</span>
            <span class=n>value</span> <span class=o>=</span> <span class=n>sep</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>value</span><span class=p>:</span>
            <span class=k>continue</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Expected &#39;str&#39; got &#39;</span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=si>}</span><span class=s2>&#39;&quot;</span><span class=p>)</span>

        <span class=n>result</span><span class=p>[</span><span class=n>variable</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>

    <span class=k>return</span> <span class=n>result</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["navigation.sections", "navigation.path", "navigation.prune"], "search": "../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../../assets/javascripts/bundle.c8b220af.min.js></script> </body> </html>