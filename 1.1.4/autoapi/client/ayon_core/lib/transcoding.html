<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=prev href=terminal.html><link rel=next href=vendor_bin_utils.html><link rel=icon href=../../../../img/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.8"><title>transcoding - ayon-core</title><link rel=stylesheet href=../../../../assets/stylesheets/main.8608ea7d.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><script src=https://unpkg.com/iframe-worker/shim></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../../css/custom.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#client.ayon_core.lib.transcoding class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../../index.html title=ayon-core class="md-header__button md-logo" aria-label=ayon-core data-md-component=logo> <img src=../../../../img/ay-symbol-blackw-full.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ayon-core </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> transcoding </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../../index.html title=ayon-core class="md-nav__button md-logo" aria-label=ayon-core data-md-component=logo> <img src=../../../../img/ay-symbol-blackw-full.png alt=logo> </a> ayon-core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../index.html class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../../license.html class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1 checked> <div class="md-nav__link md-nav__container"> <a href=../../index.html class="md-nav__link "> <span class=md-ellipsis> client </span> </a> <label class="md-nav__link " for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> client </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1 checked> <div class="md-nav__link md-nav__container"> <a href=../index.html class="md-nav__link "> <span class=md-ellipsis> ayon_core </span> </a> <label class="md-nav__link " for=__nav_3_1_1 id=__nav_3_1_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_1_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1> <span class="md-nav__icon md-icon"></span> ayon_core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../__main__.html class=md-nav__link> <span class=md-ellipsis> __main__ </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../addon/base.html class=md-nav__link> <span class=md-ellipsis> addon </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../cli.html class=md-nav__link> <span class=md-ellipsis> cli </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../hooks/pre_add_last_workfile_arg.html class=md-nav__link> <span class=md-ellipsis> hooks </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../host/dirmap.html class=md-nav__link> <span class=md-ellipsis> host </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1_6 checked> <div class="md-nav__link md-nav__container"> <a href=index.html class="md-nav__link "> <span class=md-ellipsis> lib </span> </a> <label class="md-nav__link " for=__nav_3_1_1_6 id=__nav_3_1_1_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_1_1_6_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1_6> <span class="md-nav__icon md-icon"></span> lib </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=attribute_definitions.html class=md-nav__link> <span class=md-ellipsis> attribute_definitions </span> </a> </li> <li class=md-nav__item> <a href=ayon_connection.html class=md-nav__link> <span class=md-ellipsis> ayon_connection </span> </a> </li> <li class=md-nav__item> <a href=ayon_info.html class=md-nav__link> <span class=md-ellipsis> ayon_info </span> </a> </li> <li class=md-nav__item> <a href=cache.html class=md-nav__link> <span class=md-ellipsis> cache </span> </a> </li> <li class=md-nav__item> <a href=dateutils.html class=md-nav__link> <span class=md-ellipsis> dateutils </span> </a> </li> <li class=md-nav__item> <a href=env_tools.html class=md-nav__link> <span class=md-ellipsis> env_tools </span> </a> </li> <li class=md-nav__item> <a href=events.html class=md-nav__link> <span class=md-ellipsis> events </span> </a> </li> <li class=md-nav__item> <a href=execute.html class=md-nav__link> <span class=md-ellipsis> execute </span> </a> </li> <li class=md-nav__item> <a href=file_transaction.html class=md-nav__link> <span class=md-ellipsis> file_transaction </span> </a> </li> <li class=md-nav__item> <a href=local_settings.html class=md-nav__link> <span class=md-ellipsis> local_settings </span> </a> </li> <li class=md-nav__item> <a href=log.html class=md-nav__link> <span class=md-ellipsis> log </span> </a> </li> <li class=md-nav__item> <a href=path_templates.html class=md-nav__link> <span class=md-ellipsis> path_templates </span> </a> </li> <li class=md-nav__item> <a href=path_tools.html class=md-nav__link> <span class=md-ellipsis> path_tools </span> </a> </li> <li class=md-nav__item> <a href=plugin_tools.html class=md-nav__link> <span class=md-ellipsis> plugin_tools </span> </a> </li> <li class=md-nav__item> <a href=profiles_filtering.html class=md-nav__link> <span class=md-ellipsis> profiles_filtering </span> </a> </li> <li class=md-nav__item> <a href=profiling.html class=md-nav__link> <span class=md-ellipsis> profiling </span> </a> </li> <li class=md-nav__item> <a href=python_module_tools.html class=md-nav__link> <span class=md-ellipsis> python_module_tools </span> </a> </li> <li class=md-nav__item> <a href=terminal.html class=md-nav__link> <span class=md-ellipsis> terminal </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> transcoding </span> <span class="md-nav__icon md-icon"></span> </label> <a href=transcoding.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> transcoding </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding class=md-nav__link> <span class=md-ellipsis> transcoding </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.RationalToInt class=md-nav__link> <span class=md-ellipsis> RationalToInt </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding._get_image_dimensions class=md-nav__link> <span class=md-ellipsis> _get_image_dimensions </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.convert_color_values class=md-nav__link> <span class=md-ellipsis> convert_color_values </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.convert_colorspace class=md-nav__link> <span class=md-ellipsis> convert_colorspace </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.convert_ffprobe_fps_to_float class=md-nav__link> <span class=md-ellipsis> convert_ffprobe_fps_to_float </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.convert_ffprobe_fps_value class=md-nav__link> <span class=md-ellipsis> convert_ffprobe_fps_value </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.convert_for_ffmpeg class=md-nav__link> <span class=md-ellipsis> convert_for_ffmpeg </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.convert_input_paths_for_ffmpeg class=md-nav__link> <span class=md-ellipsis> convert_input_paths_for_ffmpeg </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.convert_value_by_type_name class=md-nav__link> <span class=md-ellipsis> convert_value_by_type_name </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_convert_rgb_channels class=md-nav__link> <span class=md-ellipsis> get_convert_rgb_channels </span> </a> <nav class=md-nav aria-label=get_convert_rgb_channels> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_convert_rgb_channels--examples class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_ffmpeg_codec_args class=md-nav__link> <span class=md-ellipsis> get_ffmpeg_codec_args </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_ffmpeg_format_args class=md-nav__link> <span class=md-ellipsis> get_ffmpeg_format_args </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_ffprobe_data class=md-nav__link> <span class=md-ellipsis> get_ffprobe_data </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_ffprobe_streams class=md-nav__link> <span class=md-ellipsis> get_ffprobe_streams </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_media_mime_type class=md-nav__link> <span class=md-ellipsis> get_media_mime_type </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_oiio_info_for_input class=md-nav__link> <span class=md-ellipsis> get_oiio_info_for_input </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_oiio_input_and_channel_args class=md-nav__link> <span class=md-ellipsis> get_oiio_input_and_channel_args </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_rescaled_command_arguments class=md-nav__link> <span class=md-ellipsis> get_rescaled_command_arguments </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_review_info_by_layer_name class=md-nav__link> <span class=md-ellipsis> get_review_info_by_layer_name </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_review_layer_name class=md-nav__link> <span class=md-ellipsis> get_review_layer_name </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_transcode_temp_directory class=md-nav__link> <span class=md-ellipsis> get_transcode_temp_directory </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.parse_oiio_xml_output class=md-nav__link> <span class=md-ellipsis> parse_oiio_xml_output </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.should_convert_for_ffmpeg class=md-nav__link> <span class=md-ellipsis> should_convert_for_ffmpeg </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.split_cmd_args class=md-nav__link> <span class=md-ellipsis> split_cmd_args </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=vendor_bin_utils.html class=md-nav__link> <span class=md-ellipsis> vendor_bin_utils </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../pipeline/actions.html class=md-nav__link> <span class=md-ellipsis> pipeline </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../plugins/actions/open_file_explorer.html class=md-nav__link> <span class=md-ellipsis> plugins </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../resources/app_icons/index.html class=md-nav__link> <span class=md-ellipsis> resources </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../scripts/ocio_wrapper.html class=md-nav__link> <span class=md-ellipsis> scripts </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../settings/lib.html class=md-nav__link> <span class=md-ellipsis> settings </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../style/color_defs.html class=md-nav__link> <span class=md-ellipsis> style </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../tests/conftest.html class=md-nav__link> <span class=md-ellipsis> tests </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../tools/attribute_defs/_constants.html class=md-nav__link> <span class=md-ellipsis> tools </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../vendor/python/qargparse.html class=md-nav__link> <span class=md-ellipsis> vendor </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../version.html class=md-nav__link> <span class=md-ellipsis> version </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../server/settings/conversion.html class=md-nav__link> <span class=md-ellipsis> server </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding class=md-nav__link> <span class=md-ellipsis> transcoding </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.RationalToInt class=md-nav__link> <span class=md-ellipsis> RationalToInt </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding._get_image_dimensions class=md-nav__link> <span class=md-ellipsis> _get_image_dimensions </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.convert_color_values class=md-nav__link> <span class=md-ellipsis> convert_color_values </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.convert_colorspace class=md-nav__link> <span class=md-ellipsis> convert_colorspace </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.convert_ffprobe_fps_to_float class=md-nav__link> <span class=md-ellipsis> convert_ffprobe_fps_to_float </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.convert_ffprobe_fps_value class=md-nav__link> <span class=md-ellipsis> convert_ffprobe_fps_value </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.convert_for_ffmpeg class=md-nav__link> <span class=md-ellipsis> convert_for_ffmpeg </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.convert_input_paths_for_ffmpeg class=md-nav__link> <span class=md-ellipsis> convert_input_paths_for_ffmpeg </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.convert_value_by_type_name class=md-nav__link> <span class=md-ellipsis> convert_value_by_type_name </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_convert_rgb_channels class=md-nav__link> <span class=md-ellipsis> get_convert_rgb_channels </span> </a> <nav class=md-nav aria-label=get_convert_rgb_channels> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_convert_rgb_channels--examples class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_ffmpeg_codec_args class=md-nav__link> <span class=md-ellipsis> get_ffmpeg_codec_args </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_ffmpeg_format_args class=md-nav__link> <span class=md-ellipsis> get_ffmpeg_format_args </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_ffprobe_data class=md-nav__link> <span class=md-ellipsis> get_ffprobe_data </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_ffprobe_streams class=md-nav__link> <span class=md-ellipsis> get_ffprobe_streams </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_media_mime_type class=md-nav__link> <span class=md-ellipsis> get_media_mime_type </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_oiio_info_for_input class=md-nav__link> <span class=md-ellipsis> get_oiio_info_for_input </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_oiio_input_and_channel_args class=md-nav__link> <span class=md-ellipsis> get_oiio_input_and_channel_args </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_rescaled_command_arguments class=md-nav__link> <span class=md-ellipsis> get_rescaled_command_arguments </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_review_info_by_layer_name class=md-nav__link> <span class=md-ellipsis> get_review_info_by_layer_name </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_review_layer_name class=md-nav__link> <span class=md-ellipsis> get_review_layer_name </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.get_transcode_temp_directory class=md-nav__link> <span class=md-ellipsis> get_transcode_temp_directory </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.parse_oiio_xml_output class=md-nav__link> <span class=md-ellipsis> parse_oiio_xml_output </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.should_convert_for_ffmpeg class=md-nav__link> <span class=md-ellipsis> should_convert_for_ffmpeg </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.lib.transcoding.split_cmd_args class=md-nav__link> <span class=md-ellipsis> split_cmd_args </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>transcoding</h1> <div class="doc doc-object doc-module"> <a id=client.ayon_core.lib.transcoding></a> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=client.ayon_core.lib.transcoding.RationalToInt class="doc doc-heading"> <code>RationalToInt</code> </h2> <div class="doc doc-contents "> <p>Rational value stored as division of 2 integers using string.</p> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span>
<span class=normal>150</span>
<span class=normal>151</span>
<span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span>
<span class=normal>164</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>RationalToInt</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Rational value stored as division of 2 integers using string.&quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>string_value</span><span class=p>):</span>
        <span class=n>parts</span> <span class=o>=</span> <span class=n>string_value</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;/&quot;</span><span class=p>)</span>
        <span class=n>top</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>parts</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
        <span class=n>bottom</span> <span class=o>=</span> <span class=mf>1.0</span>
        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
            <span class=n>bottom</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>parts</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_value</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>top</span><span class=p>)</span> <span class=o>/</span> <span class=nb>float</span><span class=p>(</span><span class=n>bottom</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_string_value</span> <span class=o>=</span> <span class=n>string_value</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>value</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_value</span>

    <span class=nd>@property</span>
    <span class=k>def</span><span class=w> </span><span class=nf>string_value</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_string_value</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__format__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_string_value</span><span class=o>.</span><span class=fm>__format__</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__float__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_value</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_string_value</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=s2>&quot;&lt;</span><span class=si>{}</span><span class=s2>&gt; </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_string_value</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding._get_image_dimensions class="doc doc-heading"> <code class="highlight language-python"><span class=n>_get_image_dimensions</span><span class=p>(</span><span class=n>application</span><span class=p>,</span> <span class=n>input_path</span><span class=p>,</span> <span class=n>log</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Uses 'ffprobe' first and then 'oiiotool' if available to get dim.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>application</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>"oiiotool"|"ffmpeg"</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>input_path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>path to image file</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=logging.Logger>Logger</span>]</code> </td> <td> <div class=doc-md-description> <p>Logger used for logging.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p>Returns: (tuple) (int, int, dict) - (height, width, sample_aspect_ratio) Raises: RuntimeError if image dimensions couldn't be parsed out.</p> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1343</span>
<span class=normal>1344</span>
<span class=normal>1345</span>
<span class=normal>1346</span>
<span class=normal>1347</span>
<span class=normal>1348</span>
<span class=normal>1349</span>
<span class=normal>1350</span>
<span class=normal>1351</span>
<span class=normal>1352</span>
<span class=normal>1353</span>
<span class=normal>1354</span>
<span class=normal>1355</span>
<span class=normal>1356</span>
<span class=normal>1357</span>
<span class=normal>1358</span>
<span class=normal>1359</span>
<span class=normal>1360</span>
<span class=normal>1361</span>
<span class=normal>1362</span>
<span class=normal>1363</span>
<span class=normal>1364</span>
<span class=normal>1365</span>
<span class=normal>1366</span>
<span class=normal>1367</span>
<span class=normal>1368</span>
<span class=normal>1369</span>
<span class=normal>1370</span>
<span class=normal>1371</span>
<span class=normal>1372</span>
<span class=normal>1373</span>
<span class=normal>1374</span>
<span class=normal>1375</span>
<span class=normal>1376</span>
<span class=normal>1377</span>
<span class=normal>1378</span>
<span class=normal>1379</span>
<span class=normal>1380</span>
<span class=normal>1381</span>
<span class=normal>1382</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>_get_image_dimensions</span><span class=p>(</span><span class=n>application</span><span class=p>,</span> <span class=n>input_path</span><span class=p>,</span> <span class=n>log</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Uses &#39;ffprobe&#39; first and then &#39;oiiotool&#39; if available to get dim.</span>

<span class=sd>    Args:</span>
<span class=sd>        application (str): &quot;oiiotool&quot;|&quot;ffmpeg&quot;</span>
<span class=sd>        input_path (str): path to image file</span>
<span class=sd>        log (Optional[logging.Logger]): Logger used for logging.</span>
<span class=sd>    Returns:</span>
<span class=sd>        (tuple) (int, int, dict) - (height, width, sample_aspect_ratio)</span>
<span class=sd>    Raises:</span>
<span class=sd>        RuntimeError if image dimensions couldn&#39;t be parsed out.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># ffmpeg command</span>
    <span class=n>input_file_metadata</span> <span class=o>=</span> <span class=n>get_ffprobe_data</span><span class=p>(</span><span class=n>input_path</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>log</span><span class=p>)</span>
    <span class=n>input_width</span> <span class=o>=</span> <span class=n>input_height</span> <span class=o>=</span> <span class=mi>0</span>
    <span class=n>stream</span> <span class=o>=</span> <span class=nb>next</span><span class=p>(</span>
        <span class=p>(</span>
            <span class=n>s</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>input_file_metadata</span><span class=p>[</span><span class=s2>&quot;streams&quot;</span><span class=p>]</span>
            <span class=k>if</span> <span class=n>s</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;codec_type&quot;</span><span class=p>)</span> <span class=o>==</span> <span class=s2>&quot;video&quot;</span>
        <span class=p>),</span>
        <span class=p>{}</span>
    <span class=p>)</span>
    <span class=k>if</span> <span class=n>stream</span><span class=p>:</span>
        <span class=n>input_width</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>stream</span><span class=p>[</span><span class=s2>&quot;width&quot;</span><span class=p>])</span>
        <span class=n>input_height</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>stream</span><span class=p>[</span><span class=s2>&quot;height&quot;</span><span class=p>])</span>

    <span class=c1># fallback for weird files with width=0, height=0</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>input_width</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>or</span> <span class=n>input_height</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=ow>and</span> <span class=n>application</span> <span class=o>==</span> <span class=s2>&quot;oiiotool&quot;</span><span class=p>:</span>
        <span class=c1># Load info about file from oiio tool</span>
        <span class=n>input_info</span> <span class=o>=</span> <span class=n>get_oiio_info_for_input</span><span class=p>(</span><span class=n>input_path</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>log</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>input_info</span><span class=p>:</span>
            <span class=n>input_width</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>input_info</span><span class=p>[</span><span class=s2>&quot;width&quot;</span><span class=p>])</span>
            <span class=n>input_height</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>input_info</span><span class=p>[</span><span class=s2>&quot;height&quot;</span><span class=p>])</span>

    <span class=k>if</span> <span class=n>input_width</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>or</span> <span class=n>input_height</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span><span class=s2>&quot;Couldn&#39;t read </span><span class=si>{}</span><span class=s2> either &quot;</span>
                           <span class=s2>&quot;with ffprobe or oiiotool&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>input_path</span><span class=p>))</span>

    <span class=n>stream_input_par</span> <span class=o>=</span> <span class=n>stream</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;sample_aspect_ratio&quot;</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>input_height</span><span class=p>,</span> <span class=n>input_width</span><span class=p>,</span> <span class=n>stream_input_par</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.convert_color_values class="doc doc-heading"> <code class="highlight language-python"><span class=n>convert_color_values</span><span class=p>(</span><span class=n>application</span><span class=p>,</span> <span class=n>color_value</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get color mapping for ffmpeg and oiiotool.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>application</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Application for which command should be created.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>color_value</code> </td> <td> <code><span title=tuple>tuple</span>[<span title=int>int</span>, <span title=int>int</span>, <span title=int>int</span>, <span title=float>float</span>]</code> </td> <td> <div class=doc-md-description> <p>List of 8bit int values for RGBA.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>str</code></td> <td> </td> <td> <div class=doc-md-description> <p>ffmpeg returns hex string, oiiotool is string with floats.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1385</span>
<span class=normal>1386</span>
<span class=normal>1387</span>
<span class=normal>1388</span>
<span class=normal>1389</span>
<span class=normal>1390</span>
<span class=normal>1391</span>
<span class=normal>1392</span>
<span class=normal>1393</span>
<span class=normal>1394</span>
<span class=normal>1395</span>
<span class=normal>1396</span>
<span class=normal>1397</span>
<span class=normal>1398</span>
<span class=normal>1399</span>
<span class=normal>1400</span>
<span class=normal>1401</span>
<span class=normal>1402</span>
<span class=normal>1403</span>
<span class=normal>1404</span>
<span class=normal>1405</span>
<span class=normal>1406</span>
<span class=normal>1407</span>
<span class=normal>1408</span>
<span class=normal>1409</span>
<span class=normal>1410</span>
<span class=normal>1411</span>
<span class=normal>1412</span>
<span class=normal>1413</span>
<span class=normal>1414</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>convert_color_values</span><span class=p>(</span><span class=n>application</span><span class=p>,</span> <span class=n>color_value</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get color mapping for ffmpeg and oiiotool.</span>

<span class=sd>    Args:</span>
<span class=sd>        application (str): Application for which command should be created.</span>
<span class=sd>        color_value (tuple[int, int, int, float]): List of 8bit int values</span>
<span class=sd>            for RGBA.</span>

<span class=sd>    Returns:</span>
<span class=sd>        str: ffmpeg returns hex string, oiiotool is string with floats.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>red</span><span class=p>,</span> <span class=n>green</span><span class=p>,</span> <span class=n>blue</span><span class=p>,</span> <span class=n>alpha</span> <span class=o>=</span> <span class=n>color_value</span>

    <span class=k>if</span> <span class=n>application</span> <span class=o>==</span> <span class=s2>&quot;ffmpeg&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=s2>&quot;</span><span class=si>{0:0&gt;2X}{1:0&gt;2X}{2:0&gt;2X}</span><span class=s2>@</span><span class=si>{3}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
            <span class=n>red</span><span class=p>,</span> <span class=n>green</span><span class=p>,</span> <span class=n>blue</span><span class=p>,</span> <span class=n>alpha</span>
        <span class=p>)</span>
    <span class=k>elif</span> <span class=n>application</span> <span class=o>==</span> <span class=s2>&quot;oiiotool&quot;</span><span class=p>:</span>
        <span class=n>red</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>red</span> <span class=o>/</span> <span class=mi>255</span><span class=p>)</span>
        <span class=n>green</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>green</span> <span class=o>/</span> <span class=mi>255</span><span class=p>)</span>
        <span class=n>blue</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>blue</span> <span class=o>/</span> <span class=mi>255</span><span class=p>)</span>

        <span class=k>return</span> <span class=s2>&quot;</span><span class=si>{0:.3f}</span><span class=s2>,</span><span class=si>{1:.3f}</span><span class=s2>,</span><span class=si>{2:.3f}</span><span class=s2>,</span><span class=si>{3:.3f}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
            <span class=n>red</span><span class=p>,</span> <span class=n>green</span><span class=p>,</span> <span class=n>blue</span><span class=p>,</span> <span class=n>alpha</span><span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
            <span class=s2>&quot;</span><span class=se>\&quot;</span><span class=s2>application</span><span class=se>\&quot;</span><span class=s2> input argument should &quot;</span>
            <span class=s2>&quot;be either </span><span class=se>\&quot;</span><span class=s2>ffmpeg</span><span class=se>\&quot;</span><span class=s2> or </span><span class=se>\&quot;</span><span class=s2>oiiotool</span><span class=se>\&quot;</span><span class=s2>&quot;</span>
        <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.convert_colorspace class="doc doc-heading"> <code class="highlight language-python"><span class=n>convert_colorspace</span><span class=p>(</span><span class=n>input_path</span><span class=p>,</span> <span class=n>output_path</span><span class=p>,</span> <span class=n>config_path</span><span class=p>,</span> <span class=n>source_colorspace</span><span class=p>,</span> <span class=n>target_colorspace</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>view</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>display</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>additional_command_args</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Convert source file from one color space to another.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>input_path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Path that should be converted. It is expected that contains single file or image sequence of same type (sequence in format 'file.FRAMESTART-FRAMEEND#.ext', see oiio docs, eg <code>big.1-3#.tif</code>)</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>output_path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Path to output filename. (must follow format of 'input_path', eg. single file or sequence in 'file.FRAMESTART-FRAMEEND#.ext', <code>output.1-3#.tif</code>)</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>config_path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>path to OCIO config file</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>source_colorspace</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>ocio valid color space of source files</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>target_colorspace</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>ocio valid target color space if filled, 'view' and 'display' must be empty</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>view</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>name for viewer space (ocio valid) both 'view' and 'display' must be filled (if 'target_colorspace')</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>display</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>name for display-referred reference space (ocio valid) both 'view' and 'display' must be filled (if 'target_colorspace')</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>additional_command_args</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>arguments for oiiotool (like binary depth for .dpx)</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>logger</code> </td> <td> <code><span title=logging.Logger>Logger</span></code> </td> <td> <div class=doc-md-description> <p>Logger used for logging.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p>Raises: ValueError: if misconfigured</p> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1100</span>
<span class=normal>1101</span>
<span class=normal>1102</span>
<span class=normal>1103</span>
<span class=normal>1104</span>
<span class=normal>1105</span>
<span class=normal>1106</span>
<span class=normal>1107</span>
<span class=normal>1108</span>
<span class=normal>1109</span>
<span class=normal>1110</span>
<span class=normal>1111</span>
<span class=normal>1112</span>
<span class=normal>1113</span>
<span class=normal>1114</span>
<span class=normal>1115</span>
<span class=normal>1116</span>
<span class=normal>1117</span>
<span class=normal>1118</span>
<span class=normal>1119</span>
<span class=normal>1120</span>
<span class=normal>1121</span>
<span class=normal>1122</span>
<span class=normal>1123</span>
<span class=normal>1124</span>
<span class=normal>1125</span>
<span class=normal>1126</span>
<span class=normal>1127</span>
<span class=normal>1128</span>
<span class=normal>1129</span>
<span class=normal>1130</span>
<span class=normal>1131</span>
<span class=normal>1132</span>
<span class=normal>1133</span>
<span class=normal>1134</span>
<span class=normal>1135</span>
<span class=normal>1136</span>
<span class=normal>1137</span>
<span class=normal>1138</span>
<span class=normal>1139</span>
<span class=normal>1140</span>
<span class=normal>1141</span>
<span class=normal>1142</span>
<span class=normal>1143</span>
<span class=normal>1144</span>
<span class=normal>1145</span>
<span class=normal>1146</span>
<span class=normal>1147</span>
<span class=normal>1148</span>
<span class=normal>1149</span>
<span class=normal>1150</span>
<span class=normal>1151</span>
<span class=normal>1152</span>
<span class=normal>1153</span>
<span class=normal>1154</span>
<span class=normal>1155</span>
<span class=normal>1156</span>
<span class=normal>1157</span>
<span class=normal>1158</span>
<span class=normal>1159</span>
<span class=normal>1160</span>
<span class=normal>1161</span>
<span class=normal>1162</span>
<span class=normal>1163</span>
<span class=normal>1164</span>
<span class=normal>1165</span>
<span class=normal>1166</span>
<span class=normal>1167</span>
<span class=normal>1168</span>
<span class=normal>1169</span>
<span class=normal>1170</span>
<span class=normal>1171</span>
<span class=normal>1172</span>
<span class=normal>1173</span>
<span class=normal>1174</span>
<span class=normal>1175</span>
<span class=normal>1176</span>
<span class=normal>1177</span>
<span class=normal>1178</span>
<span class=normal>1179</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>convert_colorspace</span><span class=p>(</span>
    <span class=n>input_path</span><span class=p>,</span>
    <span class=n>output_path</span><span class=p>,</span>
    <span class=n>config_path</span><span class=p>,</span>
    <span class=n>source_colorspace</span><span class=p>,</span>
    <span class=n>target_colorspace</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=n>view</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=n>display</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=n>additional_command_args</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Convert source file from one color space to another.</span>

<span class=sd>    Args:</span>
<span class=sd>        input_path (str): Path that should be converted. It is expected that</span>
<span class=sd>            contains single file or image sequence of same type</span>
<span class=sd>            (sequence in format &#39;file.FRAMESTART-FRAMEEND#.ext&#39;, see oiio docs,</span>
<span class=sd>            eg `big.1-3#.tif`)</span>
<span class=sd>        output_path (str): Path to output filename.</span>
<span class=sd>            (must follow format of &#39;input_path&#39;, eg. single file or</span>
<span class=sd>             sequence in &#39;file.FRAMESTART-FRAMEEND#.ext&#39;, `output.1-3#.tif`)</span>
<span class=sd>        config_path (str): path to OCIO config file</span>
<span class=sd>        source_colorspace (str): ocio valid color space of source files</span>
<span class=sd>        target_colorspace (str): ocio valid target color space</span>
<span class=sd>                    if filled, &#39;view&#39; and &#39;display&#39; must be empty</span>
<span class=sd>        view (str): name for viewer space (ocio valid)</span>
<span class=sd>            both &#39;view&#39; and &#39;display&#39; must be filled (if &#39;target_colorspace&#39;)</span>
<span class=sd>        display (str): name for display-referred reference space (ocio valid)</span>
<span class=sd>            both &#39;view&#39; and &#39;display&#39; must be filled (if &#39;target_colorspace&#39;)</span>
<span class=sd>        additional_command_args (list): arguments for oiiotool (like binary</span>
<span class=sd>            depth for .dpx)</span>
<span class=sd>        logger (logging.Logger): Logger used for logging.</span>
<span class=sd>    Raises:</span>
<span class=sd>        ValueError: if misconfigured</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>logger</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>

    <span class=n>input_info</span> <span class=o>=</span> <span class=n>get_oiio_info_for_input</span><span class=p>(</span><span class=n>input_path</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>

    <span class=c1># Collect channels to export</span>
    <span class=n>input_arg</span><span class=p>,</span> <span class=n>channels_arg</span> <span class=o>=</span> <span class=n>get_oiio_input_and_channel_args</span><span class=p>(</span><span class=n>input_info</span><span class=p>)</span>

    <span class=c1># Prepare subprocess arguments</span>
    <span class=n>oiio_cmd</span> <span class=o>=</span> <span class=n>get_oiio_tool_args</span><span class=p>(</span>
        <span class=s2>&quot;oiiotool&quot;</span><span class=p>,</span>
        <span class=c1># Don&#39;t add any additional attributes</span>
        <span class=s2>&quot;--nosoftwareattrib&quot;</span><span class=p>,</span>
        <span class=s2>&quot;--colorconfig&quot;</span><span class=p>,</span> <span class=n>config_path</span>
    <span class=p>)</span>

    <span class=n>oiio_cmd</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span>
        <span class=n>input_arg</span><span class=p>,</span> <span class=n>input_path</span><span class=p>,</span>
        <span class=c1># Tell oiiotool which channels should be put to top stack</span>
        <span class=c1>#   (and output)</span>
        <span class=s2>&quot;--ch&quot;</span><span class=p>,</span> <span class=n>channels_arg</span>
    <span class=p>])</span>

    <span class=k>if</span> <span class=nb>all</span><span class=p>([</span><span class=n>target_colorspace</span><span class=p>,</span> <span class=n>view</span><span class=p>,</span> <span class=n>display</span><span class=p>]):</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Colorspace and both screen and display&quot;</span>
                         <span class=s2>&quot; cannot be set together.&quot;</span>
                         <span class=s2>&quot;Choose colorspace or screen and display&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>target_colorspace</span> <span class=ow>and</span> <span class=ow>not</span> <span class=nb>all</span><span class=p>([</span><span class=n>view</span><span class=p>,</span> <span class=n>display</span><span class=p>]):</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Both screen and display must be set.&quot;</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>additional_command_args</span><span class=p>:</span>
        <span class=n>oiio_cmd</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>additional_command_args</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>target_colorspace</span><span class=p>:</span>
        <span class=n>oiio_cmd</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s2>&quot;--colorconvert:subimages=0&quot;</span><span class=p>,</span>
                         <span class=n>source_colorspace</span><span class=p>,</span>
                         <span class=n>target_colorspace</span><span class=p>])</span>
    <span class=k>if</span> <span class=n>view</span> <span class=ow>and</span> <span class=n>display</span><span class=p>:</span>
        <span class=n>oiio_cmd</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s2>&quot;--iscolorspace&quot;</span><span class=p>,</span> <span class=n>source_colorspace</span><span class=p>])</span>
        <span class=n>oiio_cmd</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s2>&quot;--ociodisplay:subimages=0&quot;</span><span class=p>,</span> <span class=n>display</span><span class=p>,</span> <span class=n>view</span><span class=p>])</span>

    <span class=n>oiio_cmd</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s2>&quot;-o&quot;</span><span class=p>,</span> <span class=n>output_path</span><span class=p>])</span>

    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&quot;Conversion command: </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s2>&quot; &quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>oiio_cmd</span><span class=p>)))</span>
    <span class=n>run_subprocess</span><span class=p>(</span><span class=n>oiio_cmd</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.convert_ffprobe_fps_to_float class="doc doc-heading"> <code class="highlight language-python"><span class=n>convert_ffprobe_fps_to_float</span><span class=p>(</span><span class=n>value</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Convert string value of frame rate to float.</p> <p>Copy of 'convert_ffprobe_fps_value' which raises exceptions on invalid value, does not convert value to string and does not return "Unknown" string.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>value</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Value to be converted.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>Float</code></td> <td> </td> <td> <div class=doc-md-description> <p>Converted frame rate in float. If divisor in value is '0' then '0.0' is returned.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=ValueError>ValueError</span></code> </td> <td> <div class=doc-md-description> <p>Passed value is invalid for conversion.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1063</span>
<span class=normal>1064</span>
<span class=normal>1065</span>
<span class=normal>1066</span>
<span class=normal>1067</span>
<span class=normal>1068</span>
<span class=normal>1069</span>
<span class=normal>1070</span>
<span class=normal>1071</span>
<span class=normal>1072</span>
<span class=normal>1073</span>
<span class=normal>1074</span>
<span class=normal>1075</span>
<span class=normal>1076</span>
<span class=normal>1077</span>
<span class=normal>1078</span>
<span class=normal>1079</span>
<span class=normal>1080</span>
<span class=normal>1081</span>
<span class=normal>1082</span>
<span class=normal>1083</span>
<span class=normal>1084</span>
<span class=normal>1085</span>
<span class=normal>1086</span>
<span class=normal>1087</span>
<span class=normal>1088</span>
<span class=normal>1089</span>
<span class=normal>1090</span>
<span class=normal>1091</span>
<span class=normal>1092</span>
<span class=normal>1093</span>
<span class=normal>1094</span>
<span class=normal>1095</span>
<span class=normal>1096</span>
<span class=normal>1097</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>convert_ffprobe_fps_to_float</span><span class=p>(</span><span class=n>value</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Convert string value of frame rate to float.</span>

<span class=sd>    Copy of &#39;convert_ffprobe_fps_value&#39; which raises exceptions on invalid</span>
<span class=sd>    value, does not convert value to string and does not return &quot;Unknown&quot;</span>
<span class=sd>    string.</span>

<span class=sd>    Args:</span>
<span class=sd>        value (str): Value to be converted.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Float: Converted frame rate in float. If divisor in value is &#39;0&#39; then</span>
<span class=sd>            &#39;0.0&#39; is returned.</span>

<span class=sd>    Raises:</span>
<span class=sd>        ValueError: Passed value is invalid for conversion.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>value</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Got empty value.&quot;</span><span class=p>)</span>

    <span class=n>items</span> <span class=o>=</span> <span class=n>value</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;/&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>items</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
        <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=n>items</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>

    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>items</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>((</span>
            <span class=s2>&quot;FPS expression contains multiple dividers </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>.&quot;</span>
        <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>value</span><span class=p>))</span>

    <span class=n>dividend</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>items</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span>
    <span class=n>divisor</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>items</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span>
    <span class=k>if</span> <span class=n>divisor</span> <span class=o>==</span> <span class=mf>0.0</span><span class=p>:</span>
        <span class=k>return</span> <span class=mf>0.0</span>
    <span class=k>return</span> <span class=n>dividend</span> <span class=o>/</span> <span class=n>divisor</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.convert_ffprobe_fps_value class="doc doc-heading"> <code class="highlight language-python"><span class=n>convert_ffprobe_fps_value</span><span class=p>(</span><span class=n>str_value</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Returns (str) value of fps from ffprobe frame format (120/1)</p> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1043</span>
<span class=normal>1044</span>
<span class=normal>1045</span>
<span class=normal>1046</span>
<span class=normal>1047</span>
<span class=normal>1048</span>
<span class=normal>1049</span>
<span class=normal>1050</span>
<span class=normal>1051</span>
<span class=normal>1052</span>
<span class=normal>1053</span>
<span class=normal>1054</span>
<span class=normal>1055</span>
<span class=normal>1056</span>
<span class=normal>1057</span>
<span class=normal>1058</span>
<span class=normal>1059</span>
<span class=normal>1060</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>convert_ffprobe_fps_value</span><span class=p>(</span><span class=n>str_value</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns (str) value of fps from ffprobe frame format (120/1)&quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>str_value</span> <span class=o>==</span> <span class=s2>&quot;0/0&quot;</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;WARNING: Source has </span><span class=se>\&quot;</span><span class=s2>r_frame_rate</span><span class=se>\&quot;</span><span class=s2> value set to </span><span class=se>\&quot;</span><span class=s2>0/0</span><span class=se>\&quot;</span><span class=s2>.&quot;</span><span class=p>)</span>
        <span class=k>return</span> <span class=s2>&quot;Unknown&quot;</span>

    <span class=n>items</span> <span class=o>=</span> <span class=n>str_value</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;/&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>items</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>fps</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>items</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>

    <span class=k>elif</span> <span class=nb>len</span><span class=p>(</span><span class=n>items</span><span class=p>)</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
        <span class=n>fps</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>items</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>/</span> <span class=nb>float</span><span class=p>(</span><span class=n>items</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>

    <span class=c1># Check if fps is integer or float number</span>
    <span class=k>if</span> <span class=nb>int</span><span class=p>(</span><span class=n>fps</span><span class=p>)</span> <span class=o>==</span> <span class=n>fps</span><span class=p>:</span>
        <span class=n>fps</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>fps</span><span class=p>)</span>

    <span class=k>return</span> <span class=nb>str</span><span class=p>(</span><span class=n>fps</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.convert_for_ffmpeg class="doc doc-heading"> <code class="highlight language-python"><span class=n>convert_for_ffmpeg</span><span class=p>(</span><span class=n>first_input_path</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>,</span> <span class=n>input_frame_start</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>input_frame_end</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Convert source file to format supported in ffmpeg.</p> <p>Currently can convert only exrs.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>first_input_path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Path to first file of a sequence or a single file path for non-sequential input.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>output_dir</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Path to directory where output will be rendered. Must not be same as input's directory.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>input_frame_start</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Frame start of input.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>input_frame_end</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Frame end of input.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>logger</code> </td> <td> <code><span title=logging.Logger>Logger</span></code> </td> <td> <div class=doc-md-description> <p>Logger used for logging.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=ValueError>ValueError</span></code> </td> <td> <div class=doc-md-description> <p>If input filepath has extension not supported by function. Currently is supported only ".exr" extension.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>534</span>
<span class=normal>535</span>
<span class=normal>536</span>
<span class=normal>537</span>
<span class=normal>538</span>
<span class=normal>539</span>
<span class=normal>540</span>
<span class=normal>541</span>
<span class=normal>542</span>
<span class=normal>543</span>
<span class=normal>544</span>
<span class=normal>545</span>
<span class=normal>546</span>
<span class=normal>547</span>
<span class=normal>548</span>
<span class=normal>549</span>
<span class=normal>550</span>
<span class=normal>551</span>
<span class=normal>552</span>
<span class=normal>553</span>
<span class=normal>554</span>
<span class=normal>555</span>
<span class=normal>556</span>
<span class=normal>557</span>
<span class=normal>558</span>
<span class=normal>559</span>
<span class=normal>560</span>
<span class=normal>561</span>
<span class=normal>562</span>
<span class=normal>563</span>
<span class=normal>564</span>
<span class=normal>565</span>
<span class=normal>566</span>
<span class=normal>567</span>
<span class=normal>568</span>
<span class=normal>569</span>
<span class=normal>570</span>
<span class=normal>571</span>
<span class=normal>572</span>
<span class=normal>573</span>
<span class=normal>574</span>
<span class=normal>575</span>
<span class=normal>576</span>
<span class=normal>577</span>
<span class=normal>578</span>
<span class=normal>579</span>
<span class=normal>580</span>
<span class=normal>581</span>
<span class=normal>582</span>
<span class=normal>583</span>
<span class=normal>584</span>
<span class=normal>585</span>
<span class=normal>586</span>
<span class=normal>587</span>
<span class=normal>588</span>
<span class=normal>589</span>
<span class=normal>590</span>
<span class=normal>591</span>
<span class=normal>592</span>
<span class=normal>593</span>
<span class=normal>594</span>
<span class=normal>595</span>
<span class=normal>596</span>
<span class=normal>597</span>
<span class=normal>598</span>
<span class=normal>599</span>
<span class=normal>600</span>
<span class=normal>601</span>
<span class=normal>602</span>
<span class=normal>603</span>
<span class=normal>604</span>
<span class=normal>605</span>
<span class=normal>606</span>
<span class=normal>607</span>
<span class=normal>608</span>
<span class=normal>609</span>
<span class=normal>610</span>
<span class=normal>611</span>
<span class=normal>612</span>
<span class=normal>613</span>
<span class=normal>614</span>
<span class=normal>615</span>
<span class=normal>616</span>
<span class=normal>617</span>
<span class=normal>618</span>
<span class=normal>619</span>
<span class=normal>620</span>
<span class=normal>621</span>
<span class=normal>622</span>
<span class=normal>623</span>
<span class=normal>624</span>
<span class=normal>625</span>
<span class=normal>626</span>
<span class=normal>627</span>
<span class=normal>628</span>
<span class=normal>629</span>
<span class=normal>630</span>
<span class=normal>631</span>
<span class=normal>632</span>
<span class=normal>633</span>
<span class=normal>634</span>
<span class=normal>635</span>
<span class=normal>636</span>
<span class=normal>637</span>
<span class=normal>638</span>
<span class=normal>639</span>
<span class=normal>640</span>
<span class=normal>641</span>
<span class=normal>642</span>
<span class=normal>643</span>
<span class=normal>644</span>
<span class=normal>645</span>
<span class=normal>646</span>
<span class=normal>647</span>
<span class=normal>648</span>
<span class=normal>649</span>
<span class=normal>650</span>
<span class=normal>651</span>
<span class=normal>652</span>
<span class=normal>653</span>
<span class=normal>654</span>
<span class=normal>655</span>
<span class=normal>656</span>
<span class=normal>657</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>convert_for_ffmpeg</span><span class=p>(</span>
    <span class=n>first_input_path</span><span class=p>,</span>
    <span class=n>output_dir</span><span class=p>,</span>
    <span class=n>input_frame_start</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=n>input_frame_end</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=n>logger</span><span class=o>=</span><span class=kc>None</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Convert source file to format supported in ffmpeg.</span>

<span class=sd>    Currently can convert only exrs.</span>

<span class=sd>    Args:</span>
<span class=sd>        first_input_path (str): Path to first file of a sequence or a single</span>
<span class=sd>            file path for non-sequential input.</span>
<span class=sd>        output_dir (str): Path to directory where output will be rendered.</span>
<span class=sd>            Must not be same as input&#39;s directory.</span>
<span class=sd>        input_frame_start (int): Frame start of input.</span>
<span class=sd>        input_frame_end (int): Frame end of input.</span>
<span class=sd>        logger (logging.Logger): Logger used for logging.</span>

<span class=sd>    Raises:</span>
<span class=sd>        ValueError: If input filepath has extension not supported by function.</span>
<span class=sd>            Currently is supported only &quot;.exr&quot; extension.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>logger</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>

    <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>((</span>
        <span class=s2>&quot;DEPRECATED: &#39;ayon_core.lib.transcoding.convert_for_ffmpeg&#39; is&quot;</span>
        <span class=s2>&quot; deprecated function of conversion for FFMpeg. Please replace usage&quot;</span>
        <span class=s2>&quot; with &#39;ayon_core.lib.transcoding.convert_input_paths_for_ffmpeg&#39;&quot;</span>
    <span class=p>))</span>

    <span class=n>ext</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>splitext</span><span class=p>(</span><span class=n>first_input_path</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
    <span class=k>if</span> <span class=n>ext</span> <span class=o>!=</span> <span class=s2>&quot;.exr&quot;</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>((</span>
            <span class=s2>&quot;Function &#39;convert_for_ffmpeg&#39; currently support only&quot;</span>
            <span class=s2>&quot; </span><span class=se>\&quot;</span><span class=s2>.exr</span><span class=se>\&quot;</span><span class=s2> extension. Got </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>.&quot;</span>
        <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>ext</span><span class=p>))</span>

    <span class=n>is_sequence</span> <span class=o>=</span> <span class=kc>False</span>
    <span class=k>if</span> <span class=n>input_frame_start</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>input_frame_end</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>is_sequence</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>input_frame_end</span><span class=p>)</span> <span class=o>!=</span> <span class=nb>int</span><span class=p>(</span><span class=n>input_frame_start</span><span class=p>)</span>

    <span class=n>input_info</span> <span class=o>=</span> <span class=n>get_oiio_info_for_input</span><span class=p>(</span><span class=n>first_input_path</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>

    <span class=c1># Change compression only if source compression is &quot;dwaa&quot; or &quot;dwab&quot;</span>
    <span class=c1>#   - they&#39;re not supported in ffmpeg</span>
    <span class=n>compression</span> <span class=o>=</span> <span class=n>input_info</span><span class=p>[</span><span class=s2>&quot;attribs&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;compression&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>compression</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&quot;dwaa&quot;</span><span class=p>,</span> <span class=s2>&quot;dwab&quot;</span><span class=p>):</span>
        <span class=n>compression</span> <span class=o>=</span> <span class=s2>&quot;none&quot;</span>

    <span class=c1># Prepare subprocess arguments</span>
    <span class=n>oiio_cmd</span> <span class=o>=</span> <span class=n>get_oiio_tool_args</span><span class=p>(</span>
        <span class=s2>&quot;oiiotool&quot;</span><span class=p>,</span>
        <span class=c1># Don&#39;t add any additional attributes</span>
        <span class=s2>&quot;--nosoftwareattrib&quot;</span><span class=p>,</span>
    <span class=p>)</span>
    <span class=c1># Add input compression if available</span>
    <span class=k>if</span> <span class=n>compression</span><span class=p>:</span>
        <span class=n>oiio_cmd</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s2>&quot;--compression&quot;</span><span class=p>,</span> <span class=n>compression</span><span class=p>])</span>

    <span class=c1># Collect channels to export</span>
    <span class=n>input_arg</span><span class=p>,</span> <span class=n>channels_arg</span> <span class=o>=</span> <span class=n>get_oiio_input_and_channel_args</span><span class=p>(</span><span class=n>input_info</span><span class=p>)</span>

    <span class=n>oiio_cmd</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span>
        <span class=n>input_arg</span><span class=p>,</span> <span class=n>first_input_path</span><span class=p>,</span>
        <span class=c1># Tell oiiotool which channels should be put to top stack (and output)</span>
        <span class=s2>&quot;--ch&quot;</span><span class=p>,</span> <span class=n>channels_arg</span><span class=p>,</span>
        <span class=c1># Use first subimage</span>
        <span class=s2>&quot;--subimage&quot;</span><span class=p>,</span> <span class=s2>&quot;0&quot;</span>
    <span class=p>])</span>

    <span class=c1># Add frame definitions to arguments</span>
    <span class=k>if</span> <span class=n>is_sequence</span><span class=p>:</span>
        <span class=n>oiio_cmd</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span>
            <span class=s2>&quot;--frames&quot;</span><span class=p>,</span> <span class=s2>&quot;</span><span class=si>{}</span><span class=s2>-</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>input_frame_start</span><span class=p>,</span> <span class=n>input_frame_end</span><span class=p>)</span>
        <span class=p>])</span>

    <span class=k>for</span> <span class=n>attr_name</span><span class=p>,</span> <span class=n>attr_value</span> <span class=ow>in</span> <span class=n>input_info</span><span class=p>[</span><span class=s2>&quot;attribs&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>attr_value</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
            <span class=k>continue</span>

        <span class=c1># Remove attributes that have string value longer than allowed length</span>
        <span class=c1>#   for ffmpeg or when contain prohibited symbols</span>
        <span class=n>erase_reason</span> <span class=o>=</span> <span class=s2>&quot;Missing reason&quot;</span>
        <span class=n>erase_attribute</span> <span class=o>=</span> <span class=kc>False</span>
        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>attr_value</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>MAX_FFMPEG_STRING_LEN</span><span class=p>:</span>
            <span class=n>erase_reason</span> <span class=o>=</span> <span class=s2>&quot;has too long value (</span><span class=si>{}</span><span class=s2> chars).&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                <span class=nb>len</span><span class=p>(</span><span class=n>attr_value</span><span class=p>)</span>
            <span class=p>)</span>
            <span class=n>erase_attribute</span> <span class=o>=</span> <span class=kc>True</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>erase_attribute</span><span class=p>:</span>
            <span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>NOT_ALLOWED_FFMPEG_CHARS</span><span class=p>:</span>
                <span class=k>if</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>attr_value</span><span class=p>:</span>
                    <span class=n>erase_attribute</span> <span class=o>=</span> <span class=kc>True</span>
                    <span class=n>erase_reason</span> <span class=o>=</span> <span class=p>(</span>
                        <span class=s2>&quot;contains unsupported character </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>.&quot;</span>
                    <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>char</span><span class=p>)</span>
                    <span class=k>break</span>

        <span class=k>if</span> <span class=n>erase_attribute</span><span class=p>:</span>
            <span class=c1># Set attribute to empty string</span>
            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>((</span>
                <span class=s2>&quot;Removed attribute </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2> from metadata because </span><span class=si>{}</span><span class=s2>.&quot;</span>
            <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>attr_name</span><span class=p>,</span> <span class=n>erase_reason</span><span class=p>))</span>
            <span class=n>oiio_cmd</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s2>&quot;--eraseattrib&quot;</span><span class=p>,</span> <span class=n>attr_name</span><span class=p>])</span>

    <span class=c1># Add last argument - path to output</span>
    <span class=k>if</span> <span class=n>is_sequence</span><span class=p>:</span>
        <span class=n>ext</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>splitext</span><span class=p>(</span><span class=n>first_input_path</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
        <span class=n>base_filename</span> <span class=o>=</span> <span class=s2>&quot;tmp.%</span><span class=si>{:0&gt;2}</span><span class=s2>d</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
            <span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>input_frame_end</span><span class=p>)),</span> <span class=n>ext</span>
        <span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>base_filename</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>first_input_path</span><span class=p>)</span>
    <span class=n>output_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>output_dir</span><span class=p>,</span> <span class=n>base_filename</span><span class=p>)</span>
    <span class=n>oiio_cmd</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span>
        <span class=s2>&quot;-o&quot;</span><span class=p>,</span> <span class=n>output_path</span>
    <span class=p>])</span>

    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&quot;Conversion command: </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s2>&quot; &quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>oiio_cmd</span><span class=p>)))</span>
    <span class=n>run_subprocess</span><span class=p>(</span><span class=n>oiio_cmd</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.convert_input_paths_for_ffmpeg class="doc doc-heading"> <code class="highlight language-python"><span class=n>convert_input_paths_for_ffmpeg</span><span class=p>(</span><span class=n>input_paths</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Convert source file to format supported in ffmpeg.</p> <p>Currently can convert only exrs. The input filepaths should be files with same type. Information about input is loaded only from first found file.</p> <p>Filenames of input files are kept so make sure that output directory is not the same directory as input files have. - This way it can handle gaps and can keep input filenames without handling frame template</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>input_paths</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Paths that should be converted. It is expected that contains single file or image sequence of same type.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>output_dir</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Path to directory where output will be rendered. Must not be same as input's directory.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>logger</code> </td> <td> <code><span title=logging.Logger>Logger</span></code> </td> <td> <div class=doc-md-description> <p>Logger used for logging.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=ValueError>ValueError</span></code> </td> <td> <div class=doc-md-description> <p>If input filepath has extension not supported by function. Currently is supported only ".exr" extension.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>660</span>
<span class=normal>661</span>
<span class=normal>662</span>
<span class=normal>663</span>
<span class=normal>664</span>
<span class=normal>665</span>
<span class=normal>666</span>
<span class=normal>667</span>
<span class=normal>668</span>
<span class=normal>669</span>
<span class=normal>670</span>
<span class=normal>671</span>
<span class=normal>672</span>
<span class=normal>673</span>
<span class=normal>674</span>
<span class=normal>675</span>
<span class=normal>676</span>
<span class=normal>677</span>
<span class=normal>678</span>
<span class=normal>679</span>
<span class=normal>680</span>
<span class=normal>681</span>
<span class=normal>682</span>
<span class=normal>683</span>
<span class=normal>684</span>
<span class=normal>685</span>
<span class=normal>686</span>
<span class=normal>687</span>
<span class=normal>688</span>
<span class=normal>689</span>
<span class=normal>690</span>
<span class=normal>691</span>
<span class=normal>692</span>
<span class=normal>693</span>
<span class=normal>694</span>
<span class=normal>695</span>
<span class=normal>696</span>
<span class=normal>697</span>
<span class=normal>698</span>
<span class=normal>699</span>
<span class=normal>700</span>
<span class=normal>701</span>
<span class=normal>702</span>
<span class=normal>703</span>
<span class=normal>704</span>
<span class=normal>705</span>
<span class=normal>706</span>
<span class=normal>707</span>
<span class=normal>708</span>
<span class=normal>709</span>
<span class=normal>710</span>
<span class=normal>711</span>
<span class=normal>712</span>
<span class=normal>713</span>
<span class=normal>714</span>
<span class=normal>715</span>
<span class=normal>716</span>
<span class=normal>717</span>
<span class=normal>718</span>
<span class=normal>719</span>
<span class=normal>720</span>
<span class=normal>721</span>
<span class=normal>722</span>
<span class=normal>723</span>
<span class=normal>724</span>
<span class=normal>725</span>
<span class=normal>726</span>
<span class=normal>727</span>
<span class=normal>728</span>
<span class=normal>729</span>
<span class=normal>730</span>
<span class=normal>731</span>
<span class=normal>732</span>
<span class=normal>733</span>
<span class=normal>734</span>
<span class=normal>735</span>
<span class=normal>736</span>
<span class=normal>737</span>
<span class=normal>738</span>
<span class=normal>739</span>
<span class=normal>740</span>
<span class=normal>741</span>
<span class=normal>742</span>
<span class=normal>743</span>
<span class=normal>744</span>
<span class=normal>745</span>
<span class=normal>746</span>
<span class=normal>747</span>
<span class=normal>748</span>
<span class=normal>749</span>
<span class=normal>750</span>
<span class=normal>751</span>
<span class=normal>752</span>
<span class=normal>753</span>
<span class=normal>754</span>
<span class=normal>755</span>
<span class=normal>756</span>
<span class=normal>757</span>
<span class=normal>758</span>
<span class=normal>759</span>
<span class=normal>760</span>
<span class=normal>761</span>
<span class=normal>762</span>
<span class=normal>763</span>
<span class=normal>764</span>
<span class=normal>765</span>
<span class=normal>766</span>
<span class=normal>767</span>
<span class=normal>768</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>convert_input_paths_for_ffmpeg</span><span class=p>(</span>
    <span class=n>input_paths</span><span class=p>,</span>
    <span class=n>output_dir</span><span class=p>,</span>
    <span class=n>logger</span><span class=o>=</span><span class=kc>None</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Convert source file to format supported in ffmpeg.</span>

<span class=sd>    Currently can convert only exrs. The input filepaths should be files</span>
<span class=sd>    with same type. Information about input is loaded only from first found</span>
<span class=sd>    file.</span>

<span class=sd>    Filenames of input files are kept so make sure that output directory</span>
<span class=sd>    is not the same directory as input files have.</span>
<span class=sd>    - This way it can handle gaps and can keep input filenames without handling</span>
<span class=sd>        frame template</span>

<span class=sd>    Args:</span>
<span class=sd>        input_paths (str): Paths that should be converted. It is expected that</span>
<span class=sd>            contains single file or image sequence of same type.</span>
<span class=sd>        output_dir (str): Path to directory where output will be rendered.</span>
<span class=sd>            Must not be same as input&#39;s directory.</span>
<span class=sd>        logger (logging.Logger): Logger used for logging.</span>

<span class=sd>    Raises:</span>
<span class=sd>        ValueError: If input filepath has extension not supported by function.</span>
<span class=sd>            Currently is supported only &quot;.exr&quot; extension.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>logger</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>

    <span class=n>first_input_path</span> <span class=o>=</span> <span class=n>input_paths</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
    <span class=n>ext</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>splitext</span><span class=p>(</span><span class=n>first_input_path</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>

    <span class=k>if</span> <span class=n>ext</span> <span class=o>!=</span> <span class=s2>&quot;.exr&quot;</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>((</span>
            <span class=s2>&quot;Function &#39;convert_for_ffmpeg&#39; currently support only&quot;</span>
            <span class=s2>&quot; </span><span class=se>\&quot;</span><span class=s2>.exr</span><span class=se>\&quot;</span><span class=s2> extension. Got </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>.&quot;</span>
        <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>ext</span><span class=p>))</span>

    <span class=n>input_info</span> <span class=o>=</span> <span class=n>get_oiio_info_for_input</span><span class=p>(</span><span class=n>first_input_path</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>

    <span class=c1># Change compression only if source compression is &quot;dwaa&quot; or &quot;dwab&quot;</span>
    <span class=c1>#   - they&#39;re not supported in ffmpeg</span>
    <span class=n>compression</span> <span class=o>=</span> <span class=n>input_info</span><span class=p>[</span><span class=s2>&quot;attribs&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;compression&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>compression</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&quot;dwaa&quot;</span><span class=p>,</span> <span class=s2>&quot;dwab&quot;</span><span class=p>):</span>
        <span class=n>compression</span> <span class=o>=</span> <span class=s2>&quot;none&quot;</span>

    <span class=c1># Collect channels to export</span>
    <span class=n>input_arg</span><span class=p>,</span> <span class=n>channels_arg</span> <span class=o>=</span> <span class=n>get_oiio_input_and_channel_args</span><span class=p>(</span><span class=n>input_info</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>input_path</span> <span class=ow>in</span> <span class=n>input_paths</span><span class=p>:</span>
        <span class=c1># Prepare subprocess arguments</span>
        <span class=n>oiio_cmd</span> <span class=o>=</span> <span class=n>get_oiio_tool_args</span><span class=p>(</span>
            <span class=s2>&quot;oiiotool&quot;</span><span class=p>,</span>
            <span class=c1># Don&#39;t add any additional attributes</span>
            <span class=s2>&quot;--nosoftwareattrib&quot;</span><span class=p>,</span>
        <span class=p>)</span>
        <span class=c1># Add input compression if available</span>
        <span class=k>if</span> <span class=n>compression</span><span class=p>:</span>
            <span class=n>oiio_cmd</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s2>&quot;--compression&quot;</span><span class=p>,</span> <span class=n>compression</span><span class=p>])</span>

        <span class=n>oiio_cmd</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span>
            <span class=n>input_arg</span><span class=p>,</span> <span class=n>input_path</span><span class=p>,</span>
            <span class=c1># Tell oiiotool which channels should be put to top stack</span>
            <span class=c1>#   (and output)</span>
            <span class=s2>&quot;--ch&quot;</span><span class=p>,</span> <span class=n>channels_arg</span><span class=p>,</span>
            <span class=c1># Use first subimage</span>
            <span class=s2>&quot;--subimage&quot;</span><span class=p>,</span> <span class=s2>&quot;0&quot;</span>
        <span class=p>])</span>

        <span class=k>for</span> <span class=n>attr_name</span><span class=p>,</span> <span class=n>attr_value</span> <span class=ow>in</span> <span class=n>input_info</span><span class=p>[</span><span class=s2>&quot;attribs&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>attr_value</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
                <span class=k>continue</span>

            <span class=c1># Remove attributes that have string value longer than allowed</span>
            <span class=c1>#   length for ffmpeg or when containing prohibited symbols</span>
            <span class=n>erase_reason</span> <span class=o>=</span> <span class=s2>&quot;Missing reason&quot;</span>
            <span class=n>erase_attribute</span> <span class=o>=</span> <span class=kc>False</span>
            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>attr_value</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>MAX_FFMPEG_STRING_LEN</span><span class=p>:</span>
                <span class=n>erase_reason</span> <span class=o>=</span> <span class=s2>&quot;has too long value (</span><span class=si>{}</span><span class=s2> chars).&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                    <span class=nb>len</span><span class=p>(</span><span class=n>attr_value</span><span class=p>)</span>
                <span class=p>)</span>
                <span class=n>erase_attribute</span> <span class=o>=</span> <span class=kc>True</span>

            <span class=k>if</span> <span class=ow>not</span> <span class=n>erase_attribute</span><span class=p>:</span>
                <span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>NOT_ALLOWED_FFMPEG_CHARS</span><span class=p>:</span>
                    <span class=k>if</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>attr_value</span><span class=p>:</span>
                        <span class=n>erase_attribute</span> <span class=o>=</span> <span class=kc>True</span>
                        <span class=n>erase_reason</span> <span class=o>=</span> <span class=p>(</span>
                            <span class=s2>&quot;contains unsupported character </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>.&quot;</span>
                        <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>char</span><span class=p>)</span>
                        <span class=k>break</span>

            <span class=k>if</span> <span class=n>erase_attribute</span><span class=p>:</span>
                <span class=c1># Set attribute to empty string</span>
                <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>((</span>
                    <span class=s2>&quot;Removed attribute </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2> from metadata because </span><span class=si>{}</span><span class=s2>.&quot;</span>
                <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>attr_name</span><span class=p>,</span> <span class=n>erase_reason</span><span class=p>))</span>
                <span class=n>oiio_cmd</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s2>&quot;--eraseattrib&quot;</span><span class=p>,</span> <span class=n>attr_name</span><span class=p>])</span>

        <span class=c1># Add last argument - path to output</span>
        <span class=n>base_filename</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>input_path</span><span class=p>)</span>
        <span class=n>output_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>output_dir</span><span class=p>,</span> <span class=n>base_filename</span><span class=p>)</span>
        <span class=n>oiio_cmd</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span>
            <span class=s2>&quot;-o&quot;</span><span class=p>,</span> <span class=n>output_path</span>
        <span class=p>])</span>

        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&quot;Conversion command: </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s2>&quot; &quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>oiio_cmd</span><span class=p>)))</span>
        <span class=n>run_subprocess</span><span class=p>(</span><span class=n>oiio_cmd</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.convert_value_by_type_name class="doc doc-heading"> <code class="highlight language-python"><span class=n>convert_value_by_type_name</span><span class=p>(</span><span class=n>value_type</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Convert value to proper type based on type name.</p> <p>In some cases value types have custom python class.</p> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>167</span>
<span class=normal>168</span>
<span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span>
<span class=normal>172</span>
<span class=normal>173</span>
<span class=normal>174</span>
<span class=normal>175</span>
<span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span>
<span class=normal>200</span>
<span class=normal>201</span>
<span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span>
<span class=normal>242</span>
<span class=normal>243</span>
<span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>convert_value_by_type_name</span><span class=p>(</span><span class=n>value_type</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Convert value to proper type based on type name.</span>

<span class=sd>    In some cases value types have custom python class.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>logger</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>

    <span class=c1># Simple types</span>
    <span class=k>if</span> <span class=n>value_type</span> <span class=o>==</span> <span class=s2>&quot;string&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>value</span>

    <span class=k>if</span> <span class=n>value_type</span> <span class=o>==</span> <span class=s2>&quot;int&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=nb>int</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>value_type</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&quot;float&quot;</span><span class=p>,</span> <span class=s2>&quot;double&quot;</span><span class=p>):</span>
        <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>

    <span class=c1># Vectors will probably have more types</span>
    <span class=k>if</span> <span class=n>value_type</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&quot;vec2f&quot;</span><span class=p>,</span> <span class=s2>&quot;float2&quot;</span><span class=p>,</span> <span class=s2>&quot;float2d&quot;</span><span class=p>):</span>
        <span class=k>return</span> <span class=p>[</span><span class=nb>float</span><span class=p>(</span><span class=n>item</span><span class=p>)</span> <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>value</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;,&quot;</span><span class=p>)]</span>

    <span class=c1># Matrix should be always have square size of element 3x3, 4x4</span>
    <span class=c1># - are returned as list of lists</span>
    <span class=k>if</span> <span class=n>value_type</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&quot;matrix&quot;</span><span class=p>,</span> <span class=s2>&quot;matrixd&quot;</span><span class=p>):</span>
        <span class=n>output</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=n>current_index</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span>
        <span class=n>parts</span> <span class=o>=</span> <span class=n>value</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;,&quot;</span><span class=p>)</span>
        <span class=n>parts_len</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>parts_len</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
            <span class=n>divisor</span> <span class=o>=</span> <span class=mi>1</span>
        <span class=k>elif</span> <span class=n>parts_len</span> <span class=o>==</span> <span class=mi>4</span><span class=p>:</span>
            <span class=n>divisor</span> <span class=o>=</span> <span class=mi>2</span>
        <span class=k>elif</span> <span class=n>parts_len</span> <span class=o>==</span> <span class=mi>9</span><span class=p>:</span>
            <span class=n>divisor</span> <span class=o>=</span> <span class=mi>3</span>
        <span class=k>elif</span> <span class=n>parts_len</span> <span class=o>==</span> <span class=mi>16</span><span class=p>:</span>
            <span class=n>divisor</span> <span class=o>=</span> <span class=mi>4</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Unknown matrix resolution </span><span class=si>{}</span><span class=s2>. Value: </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                <span class=n>parts_len</span><span class=p>,</span> <span class=n>value</span>
            <span class=p>))</span>
            <span class=k>for</span> <span class=n>part</span> <span class=ow>in</span> <span class=n>parts</span><span class=p>:</span>
                <span class=n>output</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>float</span><span class=p>(</span><span class=n>part</span><span class=p>))</span>
            <span class=k>return</span> <span class=n>output</span>

        <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>item</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>parts</span><span class=p>):</span>
            <span class=n>list_index</span> <span class=o>=</span> <span class=n>idx</span> <span class=o>%</span> <span class=n>divisor</span>
            <span class=k>if</span> <span class=n>list_index</span> <span class=o>&gt;</span> <span class=n>current_index</span><span class=p>:</span>
                <span class=n>current_index</span> <span class=o>=</span> <span class=n>list_index</span>
                <span class=n>output</span><span class=o>.</span><span class=n>append</span><span class=p>([])</span>
            <span class=n>output</span><span class=p>[</span><span class=n>list_index</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>float</span><span class=p>(</span><span class=n>item</span><span class=p>))</span>
        <span class=k>return</span> <span class=n>output</span>

    <span class=k>if</span> <span class=n>value_type</span> <span class=o>==</span> <span class=s2>&quot;rational2i&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>RationalToInt</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>value_type</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&quot;vector&quot;</span><span class=p>,</span> <span class=s2>&quot;vectord&quot;</span><span class=p>):</span>
        <span class=n>parts</span> <span class=o>=</span> <span class=p>[</span><span class=n>part</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span> <span class=k>for</span> <span class=n>part</span> <span class=ow>in</span> <span class=n>value</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;,&quot;</span><span class=p>)]</span>
        <span class=n>output</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>for</span> <span class=n>part</span> <span class=ow>in</span> <span class=n>parts</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>part</span> <span class=o>==</span> <span class=s2>&quot;-nan&quot;</span><span class=p>:</span>
                <span class=n>output</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span>
                <span class=k>continue</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=n>part</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>part</span><span class=p>)</span>
            <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
                <span class=k>pass</span>
            <span class=n>output</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>part</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>output</span>

    <span class=k>if</span> <span class=n>value_type</span> <span class=o>==</span> <span class=s2>&quot;timecode&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>value</span>

    <span class=c1># Array of other types is converted to list</span>
    <span class=n>re_result</span> <span class=o>=</span> <span class=n>ARRAY_TYPE_REGEX</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=n>value_type</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>re_result</span><span class=p>:</span>
        <span class=n>array_type</span> <span class=o>=</span> <span class=n>re_result</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
        <span class=n>output</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>value</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;,&quot;</span><span class=p>):</span>
            <span class=n>output</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
                <span class=n>convert_value_by_type_name</span><span class=p>(</span><span class=n>array_type</span><span class=p>,</span> <span class=n>item</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
            <span class=p>)</span>
        <span class=k>return</span> <span class=n>output</span>

    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>((</span>
        <span class=s2>&quot;Dev note (missing implementation):&quot;</span>
        <span class=s2>&quot; Unknown attrib type </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>. Value: </span><span class=si>{}</span><span class=s2>&quot;</span>
    <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>value_type</span><span class=p>,</span> <span class=n>value</span><span class=p>))</span>
    <span class=k>return</span> <span class=n>value</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.get_convert_rgb_channels class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_convert_rgb_channels</span><span class=p>(</span><span class=n>channel_names</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get first available RGB(A) group from channels info.</p> <h4 id=client.ayon_core.lib.transcoding.get_convert_rgb_channels--examples>Examples</h4> <pre><code># Ideal situation
channels_info: [
    &quot;R&quot;, &quot;G&quot;, &quot;B&quot;, &quot;A&quot;
]
</code></pre> <p>Result will be <code>("R", "G", "B", "A")</code></p> <pre><code># Not ideal situation
channels_info: [
    &quot;beauty.red&quot;,
    &quot;beauty.green&quot;,
    &quot;beauty.blue&quot;,
    &quot;depth.Z&quot;
]
</code></pre> <p>Result will be <code>("beauty.red", "beauty.green", "beauty.blue", None)</code></p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>channel_names</code> </td> <td> <code><span title=list>list</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>List of channel names.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>Union[NoneType, tuple[str, str, str, Union[str, None]]]: Tuple of 4 channel names defying channel names for R, G, B, A or None if there is not any layer with RGB combination.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>406</span>
<span class=normal>407</span>
<span class=normal>408</span>
<span class=normal>409</span>
<span class=normal>410</span>
<span class=normal>411</span>
<span class=normal>412</span>
<span class=normal>413</span>
<span class=normal>414</span>
<span class=normal>415</span>
<span class=normal>416</span>
<span class=normal>417</span>
<span class=normal>418</span>
<span class=normal>419</span>
<span class=normal>420</span>
<span class=normal>421</span>
<span class=normal>422</span>
<span class=normal>423</span>
<span class=normal>424</span>
<span class=normal>425</span>
<span class=normal>426</span>
<span class=normal>427</span>
<span class=normal>428</span>
<span class=normal>429</span>
<span class=normal>430</span>
<span class=normal>431</span>
<span class=normal>432</span>
<span class=normal>433</span>
<span class=normal>434</span>
<span class=normal>435</span>
<span class=normal>436</span>
<span class=normal>437</span>
<span class=normal>438</span>
<span class=normal>439</span>
<span class=normal>440</span>
<span class=normal>441</span>
<span class=normal>442</span>
<span class=normal>443</span>
<span class=normal>444</span>
<span class=normal>445</span>
<span class=normal>446</span>
<span class=normal>447</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_convert_rgb_channels</span><span class=p>(</span><span class=n>channel_names</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get first available RGB(A) group from channels info.</span>

<span class=sd>    ## Examples</span>
<span class=sd>    ```</span>
<span class=sd>    # Ideal situation</span>
<span class=sd>    channels_info: [</span>
<span class=sd>        &quot;R&quot;, &quot;G&quot;, &quot;B&quot;, &quot;A&quot;</span>
<span class=sd>    ]</span>
<span class=sd>    ```</span>
<span class=sd>    Result will be `(&quot;R&quot;, &quot;G&quot;, &quot;B&quot;, &quot;A&quot;)`</span>

<span class=sd>    ```</span>
<span class=sd>    # Not ideal situation</span>
<span class=sd>    channels_info: [</span>
<span class=sd>        &quot;beauty.red&quot;,</span>
<span class=sd>        &quot;beauty.green&quot;,</span>
<span class=sd>        &quot;beauty.blue&quot;,</span>
<span class=sd>        &quot;depth.Z&quot;</span>
<span class=sd>    ]</span>
<span class=sd>    ```</span>
<span class=sd>    Result will be `(&quot;beauty.red&quot;, &quot;beauty.green&quot;, &quot;beauty.blue&quot;, None)`</span>

<span class=sd>    Args:</span>
<span class=sd>        channel_names (list[str]): List of channel names.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Union[NoneType, tuple[str, str, str, Union[str, None]]]: Tuple of</span>
<span class=sd>            4 channel names defying channel names for R, G, B, A or None</span>
<span class=sd>            if there is not any layer with RGB combination.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>channels_info</span> <span class=o>=</span> <span class=n>get_review_info_by_layer_name</span><span class=p>(</span><span class=n>channel_names</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>channels_info</span><span class=p>:</span>
        <span class=n>review_channels</span> <span class=o>=</span> <span class=n>item</span><span class=p>[</span><span class=s2>&quot;review_channels&quot;</span><span class=p>]</span>
        <span class=k>return</span> <span class=p>(</span>
            <span class=n>review_channels</span><span class=p>[</span><span class=s2>&quot;R&quot;</span><span class=p>],</span>
            <span class=n>review_channels</span><span class=p>[</span><span class=s2>&quot;G&quot;</span><span class=p>],</span>
            <span class=n>review_channels</span><span class=p>[</span><span class=s2>&quot;B&quot;</span><span class=p>],</span>
            <span class=n>review_channels</span><span class=p>[</span><span class=s2>&quot;A&quot;</span><span class=p>]</span>
        <span class=p>)</span>
    <span class=k>return</span> <span class=kc>None</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.get_ffmpeg_codec_args class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_ffmpeg_codec_args</span><span class=p>(</span><span class=n>ffprobe_data</span><span class=p>,</span> <span class=n>source_ffmpeg_cmd</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Copy codec from input metadata for output.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ffprobe_data(dict)</code> </td> <td> </td> <td> <div class=doc-md-description> <p>Data received from ffprobe.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>source_ffmpeg_cmd(str)</code> </td> <td> </td> <td> <div class=doc-md-description> <p>Command that created input if available.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>861</span>
<span class=normal>862</span>
<span class=normal>863</span>
<span class=normal>864</span>
<span class=normal>865</span>
<span class=normal>866</span>
<span class=normal>867</span>
<span class=normal>868</span>
<span class=normal>869</span>
<span class=normal>870</span>
<span class=normal>871</span>
<span class=normal>872</span>
<span class=normal>873</span>
<span class=normal>874</span>
<span class=normal>875</span>
<span class=normal>876</span>
<span class=normal>877</span>
<span class=normal>878</span>
<span class=normal>879</span>
<span class=normal>880</span>
<span class=normal>881</span>
<span class=normal>882</span>
<span class=normal>883</span>
<span class=normal>884</span>
<span class=normal>885</span>
<span class=normal>886</span>
<span class=normal>887</span>
<span class=normal>888</span>
<span class=normal>889</span>
<span class=normal>890</span>
<span class=normal>891</span>
<span class=normal>892</span>
<span class=normal>893</span>
<span class=normal>894</span>
<span class=normal>895</span>
<span class=normal>896</span>
<span class=normal>897</span>
<span class=normal>898</span>
<span class=normal>899</span>
<span class=normal>900</span>
<span class=normal>901</span>
<span class=normal>902</span>
<span class=normal>903</span>
<span class=normal>904</span>
<span class=normal>905</span>
<span class=normal>906</span>
<span class=normal>907</span>
<span class=normal>908</span>
<span class=normal>909</span>
<span class=normal>910</span>
<span class=normal>911</span>
<span class=normal>912</span>
<span class=normal>913</span>
<span class=normal>914</span>
<span class=normal>915</span>
<span class=normal>916</span>
<span class=normal>917</span>
<span class=normal>918</span>
<span class=normal>919</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_ffmpeg_codec_args</span><span class=p>(</span><span class=n>ffprobe_data</span><span class=p>,</span> <span class=n>source_ffmpeg_cmd</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Copy codec from input metadata for output.</span>

<span class=sd>    Args:</span>
<span class=sd>        ffprobe_data(dict): Data received from ffprobe.</span>
<span class=sd>        source_ffmpeg_cmd(str): Command that created input if available.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>logger</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>

    <span class=n>video_stream</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=n>no_audio_stream</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=k>for</span> <span class=n>stream</span> <span class=ow>in</span> <span class=n>ffprobe_data</span><span class=p>[</span><span class=s2>&quot;streams&quot;</span><span class=p>]:</span>
        <span class=n>codec_type</span> <span class=o>=</span> <span class=n>stream</span><span class=p>[</span><span class=s2>&quot;codec_type&quot;</span><span class=p>]</span>
        <span class=k>if</span> <span class=n>codec_type</span> <span class=o>==</span> <span class=s2>&quot;video&quot;</span><span class=p>:</span>
            <span class=n>video_stream</span> <span class=o>=</span> <span class=n>stream</span>
            <span class=k>break</span>
        <span class=k>elif</span> <span class=n>no_audio_stream</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>codec_type</span> <span class=o>!=</span> <span class=s2>&quot;audio&quot;</span><span class=p>:</span>
            <span class=n>no_audio_stream</span> <span class=o>=</span> <span class=n>stream</span>

    <span class=k>if</span> <span class=n>video_stream</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>no_audio_stream</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                <span class=s2>&quot;Couldn&#39;t find stream that is not an audio file.&quot;</span>
            <span class=p>)</span>
            <span class=k>return</span> <span class=p>[]</span>
        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
            <span class=s2>&quot;Didn&#39;t find video stream. Using first non audio stream.&quot;</span>
        <span class=p>)</span>
        <span class=n>video_stream</span> <span class=o>=</span> <span class=n>no_audio_stream</span>

    <span class=n>codec_name</span> <span class=o>=</span> <span class=n>video_stream</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;codec_name&quot;</span><span class=p>)</span>
    <span class=c1># Codec &quot;prores&quot;</span>
    <span class=k>if</span> <span class=n>codec_name</span> <span class=o>==</span> <span class=s2>&quot;prores&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>_ffmpeg_prores_codec_args</span><span class=p>(</span><span class=n>video_stream</span><span class=p>,</span> <span class=n>source_ffmpeg_cmd</span><span class=p>)</span>

    <span class=c1># Codec &quot;h264&quot;</span>
    <span class=k>if</span> <span class=n>codec_name</span> <span class=o>==</span> <span class=s2>&quot;h264&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>_ffmpeg_h264_codec_args</span><span class=p>(</span><span class=n>video_stream</span><span class=p>,</span> <span class=n>source_ffmpeg_cmd</span><span class=p>)</span>

    <span class=c1># Coded DNxHD</span>
    <span class=k>if</span> <span class=n>codec_name</span> <span class=o>==</span> <span class=s2>&quot;dnxhd&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>_ffmpeg_dnxhd_codec_args</span><span class=p>(</span><span class=n>video_stream</span><span class=p>,</span> <span class=n>source_ffmpeg_cmd</span><span class=p>)</span>

    <span class=n>output</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>if</span> <span class=n>codec_name</span><span class=p>:</span>
        <span class=n>output</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s2>&quot;-codec:v&quot;</span><span class=p>,</span> <span class=n>codec_name</span><span class=p>])</span>

    <span class=n>bit_rate</span> <span class=o>=</span> <span class=n>video_stream</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;bit_rate&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>bit_rate</span><span class=p>:</span>
        <span class=n>output</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s2>&quot;-b:v&quot;</span><span class=p>,</span> <span class=n>bit_rate</span><span class=p>])</span>

    <span class=n>pix_fmt</span> <span class=o>=</span> <span class=n>video_stream</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;pix_fmt&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>pix_fmt</span><span class=p>:</span>
        <span class=n>output</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s2>&quot;-pix_fmt&quot;</span><span class=p>,</span> <span class=n>pix_fmt</span><span class=p>])</span>

    <span class=n>output</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s2>&quot;-g&quot;</span><span class=p>,</span> <span class=s2>&quot;1&quot;</span><span class=p>])</span>

    <span class=k>return</span> <span class=n>output</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.get_ffmpeg_format_args class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_ffmpeg_format_args</span><span class=p>(</span><span class=n>ffprobe_data</span><span class=p>,</span> <span class=n>source_ffmpeg_cmd</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Copy format from input metadata for output.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ffprobe_data(dict)</code> </td> <td> </td> <td> <div class=doc-md-description> <p>Data received from ffprobe.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>source_ffmpeg_cmd(str)</code> </td> <td> </td> <td> <div class=doc-md-description> <p>Command that created input if available.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>838</span>
<span class=normal>839</span>
<span class=normal>840</span>
<span class=normal>841</span>
<span class=normal>842</span>
<span class=normal>843</span>
<span class=normal>844</span>
<span class=normal>845</span>
<span class=normal>846</span>
<span class=normal>847</span>
<span class=normal>848</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_ffmpeg_format_args</span><span class=p>(</span><span class=n>ffprobe_data</span><span class=p>,</span> <span class=n>source_ffmpeg_cmd</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Copy format from input metadata for output.</span>

<span class=sd>    Args:</span>
<span class=sd>        ffprobe_data(dict): Data received from ffprobe.</span>
<span class=sd>        source_ffmpeg_cmd(str): Command that created input if available.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>input_format</span> <span class=o>=</span> <span class=n>ffprobe_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;format&quot;</span><span class=p>)</span> <span class=ow>or</span> <span class=p>{}</span>
    <span class=k>if</span> <span class=n>input_format</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;format_name&quot;</span><span class=p>)</span> <span class=o>==</span> <span class=s2>&quot;mxf&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>_ffmpeg_mxf_format_args</span><span class=p>(</span><span class=n>ffprobe_data</span><span class=p>,</span> <span class=n>source_ffmpeg_cmd</span><span class=p>)</span>
    <span class=k>return</span> <span class=p>[]</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.get_ffprobe_data class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_ffprobe_data</span><span class=p>(</span><span class=n>path_to_file</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Load data about entered filepath via ffprobe.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>path_to_file</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>absolute path</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>logger</code> </td> <td> <code><span title=logging.Logger>Logger</span></code> </td> <td> <div class=doc-md-description> <p>injected logger, if empty new is created</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>772</span>
<span class=normal>773</span>
<span class=normal>774</span>
<span class=normal>775</span>
<span class=normal>776</span>
<span class=normal>777</span>
<span class=normal>778</span>
<span class=normal>779</span>
<span class=normal>780</span>
<span class=normal>781</span>
<span class=normal>782</span>
<span class=normal>783</span>
<span class=normal>784</span>
<span class=normal>785</span>
<span class=normal>786</span>
<span class=normal>787</span>
<span class=normal>788</span>
<span class=normal>789</span>
<span class=normal>790</span>
<span class=normal>791</span>
<span class=normal>792</span>
<span class=normal>793</span>
<span class=normal>794</span>
<span class=normal>795</span>
<span class=normal>796</span>
<span class=normal>797</span>
<span class=normal>798</span>
<span class=normal>799</span>
<span class=normal>800</span>
<span class=normal>801</span>
<span class=normal>802</span>
<span class=normal>803</span>
<span class=normal>804</span>
<span class=normal>805</span>
<span class=normal>806</span>
<span class=normal>807</span>
<span class=normal>808</span>
<span class=normal>809</span>
<span class=normal>810</span>
<span class=normal>811</span>
<span class=normal>812</span>
<span class=normal>813</span>
<span class=normal>814</span>
<span class=normal>815</span>
<span class=normal>816</span>
<span class=normal>817</span>
<span class=normal>818</span>
<span class=normal>819</span>
<span class=normal>820</span>
<span class=normal>821</span>
<span class=normal>822</span>
<span class=normal>823</span>
<span class=normal>824</span>
<span class=normal>825</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_ffprobe_data</span><span class=p>(</span><span class=n>path_to_file</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Load data about entered filepath via ffprobe.</span>

<span class=sd>    Args:</span>
<span class=sd>        path_to_file (str): absolute path</span>
<span class=sd>        logger (logging.Logger): injected logger, if empty new is created</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>logger</span><span class=p>:</span>
        <span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
        <span class=s2>&quot;Getting information about input </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>.&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>path_to_file</span><span class=p>)</span>
    <span class=p>)</span>
    <span class=n>ffprobe_args</span> <span class=o>=</span> <span class=n>get_ffmpeg_tool_args</span><span class=p>(</span><span class=s2>&quot;ffprobe&quot;</span><span class=p>)</span>
    <span class=n>args</span> <span class=o>=</span> <span class=n>ffprobe_args</span> <span class=o>+</span> <span class=p>[</span>
        <span class=s2>&quot;-hide_banner&quot;</span><span class=p>,</span>
        <span class=s2>&quot;-loglevel&quot;</span><span class=p>,</span> <span class=s2>&quot;fatal&quot;</span><span class=p>,</span>
        <span class=s2>&quot;-show_error&quot;</span><span class=p>,</span>
        <span class=s2>&quot;-show_format&quot;</span><span class=p>,</span>
        <span class=s2>&quot;-show_streams&quot;</span><span class=p>,</span>
        <span class=s2>&quot;-show_programs&quot;</span><span class=p>,</span>
        <span class=s2>&quot;-show_chapters&quot;</span><span class=p>,</span>
        <span class=s2>&quot;-show_private_data&quot;</span><span class=p>,</span>
        <span class=s2>&quot;-print_format&quot;</span><span class=p>,</span> <span class=s2>&quot;json&quot;</span><span class=p>,</span>
        <span class=n>path_to_file</span>
    <span class=p>]</span>

    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&quot;FFprobe command: </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
        <span class=n>subprocess</span><span class=o>.</span><span class=n>list2cmdline</span><span class=p>(</span><span class=n>args</span><span class=p>)</span>
    <span class=p>))</span>
    <span class=n>kwargs</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;stdout&quot;</span><span class=p>:</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span>
        <span class=s2>&quot;stderr&quot;</span><span class=p>:</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span>
    <span class=p>}</span>
    <span class=k>if</span> <span class=n>platform</span><span class=o>.</span><span class=n>system</span><span class=p>()</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&quot;windows&quot;</span><span class=p>:</span>
        <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;creationflags&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
            <span class=n>subprocess</span><span class=o>.</span><span class=n>CREATE_NEW_PROCESS_GROUP</span>
            <span class=o>|</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>subprocess</span><span class=p>,</span> <span class=s2>&quot;DETACHED_PROCESS&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
            <span class=o>|</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>subprocess</span><span class=p>,</span> <span class=s2>&quot;CREATE_NO_WINDOW&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
        <span class=p>)</span>

    <span class=n>popen</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>Popen</span><span class=p>(</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>

    <span class=n>popen_stdout</span><span class=p>,</span> <span class=n>popen_stderr</span> <span class=o>=</span> <span class=n>popen</span><span class=o>.</span><span class=n>communicate</span><span class=p>()</span>
    <span class=k>if</span> <span class=n>popen_stdout</span><span class=p>:</span>
        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&quot;FFprobe stdout:</span><span class=se>\n</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
            <span class=n>popen_stdout</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&quot;utf-8&quot;</span><span class=p>)</span>
        <span class=p>))</span>

    <span class=k>if</span> <span class=n>popen_stderr</span><span class=p>:</span>
        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;FFprobe stderr:</span><span class=se>\n</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
            <span class=n>popen_stderr</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&quot;utf-8&quot;</span><span class=p>)</span>
        <span class=p>))</span>

    <span class=k>return</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>popen_stdout</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.get_ffprobe_streams class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_ffprobe_streams</span><span class=p>(</span><span class=n>path_to_file</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Load streams from entered filepath via ffprobe.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>path_to_file</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>absolute path</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>logger</code> </td> <td> <code><span title=logging.Logger>Logger</span></code> </td> <td> <div class=doc-md-description> <p>injected logger, if empty new is created</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>828</span>
<span class=normal>829</span>
<span class=normal>830</span>
<span class=normal>831</span>
<span class=normal>832</span>
<span class=normal>833</span>
<span class=normal>834</span>
<span class=normal>835</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_ffprobe_streams</span><span class=p>(</span><span class=n>path_to_file</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Load streams from entered filepath via ffprobe.</span>

<span class=sd>    Args:</span>
<span class=sd>        path_to_file (str): absolute path</span>
<span class=sd>        logger (logging.Logger): injected logger, if empty new is created</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>get_ffprobe_data</span><span class=p>(</span><span class=n>path_to_file</span><span class=p>,</span> <span class=n>logger</span><span class=p>)[</span><span class=s2>&quot;streams&quot;</span><span class=p>]</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.get_media_mime_type class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_media_mime_type</span><span class=p>(</span><span class=n>filepath</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Determine Mime-Type of a file.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>filepath</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Path to file.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Optional>Optional</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Optional[str]: Mime type or None if is unknown mime type.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1475</span>
<span class=normal>1476</span>
<span class=normal>1477</span>
<span class=normal>1478</span>
<span class=normal>1479</span>
<span class=normal>1480</span>
<span class=normal>1481</span>
<span class=normal>1482</span>
<span class=normal>1483</span>
<span class=normal>1484</span>
<span class=normal>1485</span>
<span class=normal>1486</span>
<span class=normal>1487</span>
<span class=normal>1488</span>
<span class=normal>1489</span>
<span class=normal>1490</span>
<span class=normal>1491</span>
<span class=normal>1492</span>
<span class=normal>1493</span>
<span class=normal>1494</span>
<span class=normal>1495</span>
<span class=normal>1496</span>
<span class=normal>1497</span>
<span class=normal>1498</span>
<span class=normal>1499</span>
<span class=normal>1500</span>
<span class=normal>1501</span>
<span class=normal>1502</span>
<span class=normal>1503</span>
<span class=normal>1504</span>
<span class=normal>1505</span>
<span class=normal>1506</span>
<span class=normal>1507</span>
<span class=normal>1508</span>
<span class=normal>1509</span>
<span class=normal>1510</span>
<span class=normal>1511</span>
<span class=normal>1512</span>
<span class=normal>1513</span>
<span class=normal>1514</span>
<span class=normal>1515</span>
<span class=normal>1516</span>
<span class=normal>1517</span>
<span class=normal>1518</span>
<span class=normal>1519</span>
<span class=normal>1520</span>
<span class=normal>1521</span>
<span class=normal>1522</span>
<span class=normal>1523</span>
<span class=normal>1524</span>
<span class=normal>1525</span>
<span class=normal>1526</span>
<span class=normal>1527</span>
<span class=normal>1528</span>
<span class=normal>1529</span>
<span class=normal>1530</span>
<span class=normal>1531</span>
<span class=normal>1532</span>
<span class=normal>1533</span>
<span class=normal>1534</span>
<span class=normal>1535</span>
<span class=normal>1536</span>
<span class=normal>1537</span>
<span class=normal>1538</span>
<span class=normal>1539</span>
<span class=normal>1540</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_media_mime_type</span><span class=p>(</span><span class=n>filepath</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Determine Mime-Type of a file.</span>

<span class=sd>    Args:</span>
<span class=sd>        filepath (str): Path to file.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Optional[str]: Mime type or None if is unknown mime type.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>filepath</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>filepath</span><span class=p>):</span>
        <span class=k>return</span> <span class=kc>None</span>

    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>filepath</span><span class=p>,</span> <span class=s2>&quot;rb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>stream</span><span class=p>:</span>
        <span class=n>content</span> <span class=o>=</span> <span class=n>stream</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>

    <span class=n>content_len</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
    <span class=c1># Pre-validation (largest definition check)</span>
    <span class=c1># - hopefully there cannot be media defined in less than 12 bytes</span>
    <span class=k>if</span> <span class=n>content_len</span> <span class=o>&lt;</span> <span class=mi>12</span><span class=p>:</span>
        <span class=k>return</span> <span class=kc>None</span>

    <span class=c1># FTYP</span>
    <span class=k>if</span> <span class=n>content</span><span class=p>[</span><span class=mi>4</span><span class=p>:</span><span class=mi>8</span><span class=p>]</span> <span class=o>==</span> <span class=sa>b</span><span class=s2>&quot;ftyp&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>_get_media_mime_type_from_ftyp</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>

    <span class=c1># BMP</span>
    <span class=k>if</span> <span class=n>content</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=sa>b</span><span class=s2>&quot;BM&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=s2>&quot;image/bmp&quot;</span>

    <span class=c1># Tiff</span>
    <span class=k>if</span> <span class=n>content</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=ow>in</span> <span class=p>(</span><span class=sa>b</span><span class=s2>&quot;MM&quot;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&quot;II&quot;</span><span class=p>):</span>
        <span class=k>return</span> <span class=s2>&quot;tiff&quot;</span>

    <span class=c1># PNG</span>
    <span class=k>if</span> <span class=n>content</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=o>==</span> <span class=sa>b</span><span class=s2>&quot;</span><span class=se>\211</span><span class=s2>PNG&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=s2>&quot;image/png&quot;</span>

    <span class=c1># SVG</span>
    <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39;xmlns=&quot;http://www.w3.org/2000/svg&quot;&#39;</span> <span class=ow>in</span> <span class=n>content</span><span class=p>:</span>
        <span class=k>return</span> <span class=s2>&quot;image/svg+xml&quot;</span>

    <span class=c1># JPEG, JFIF or Exif</span>
    <span class=k>if</span> <span class=p>(</span>
        <span class=n>content</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=o>==</span> <span class=sa>b</span><span class=s2>&quot;</span><span class=se>\xff\xd8\xff\xdb</span><span class=s2>&quot;</span>
        <span class=ow>or</span> <span class=n>content</span><span class=p>[</span><span class=mi>6</span><span class=p>:</span><span class=mi>10</span><span class=p>]</span> <span class=ow>in</span> <span class=p>(</span><span class=sa>b</span><span class=s2>&quot;JFIF&quot;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&quot;Exif&quot;</span><span class=p>)</span>
    <span class=p>):</span>
        <span class=k>return</span> <span class=s2>&quot;image/jpeg&quot;</span>

    <span class=c1># Webp</span>
    <span class=k>if</span> <span class=n>content</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=o>==</span> <span class=sa>b</span><span class=s2>&quot;RIFF&quot;</span> <span class=ow>and</span> <span class=n>content</span><span class=p>[</span><span class=mi>8</span><span class=p>:</span><span class=mi>12</span><span class=p>]</span> <span class=o>==</span> <span class=sa>b</span><span class=s2>&quot;WEBP&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=s2>&quot;image/webp&quot;</span>

    <span class=c1># Gif</span>
    <span class=k>if</span> <span class=n>content</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>6</span><span class=p>]</span> <span class=ow>in</span> <span class=p>(</span><span class=sa>b</span><span class=s2>&quot;GIF87a&quot;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&quot;GIF89a&quot;</span><span class=p>):</span>
        <span class=k>return</span> <span class=s2>&quot;gif&quot;</span>

    <span class=c1># Adobe PhotoShop file (8B &gt; Adobe, PS &gt; PhotoShop)</span>
    <span class=k>if</span> <span class=n>content</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=o>==</span> <span class=sa>b</span><span class=s2>&quot;8BPS&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=s2>&quot;image/vnd.adobe.photoshop&quot;</span>

    <span class=c1># Windows ICO &gt; this might be wild guess as multiple files can start</span>
    <span class=c1>#   with this header</span>
    <span class=k>if</span> <span class=n>content</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=o>==</span> <span class=sa>b</span><span class=s2>&quot;</span><span class=se>\x00\x00\x01\x00</span><span class=s2>&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=s2>&quot;image/x-icon&quot;</span>
    <span class=k>return</span> <span class=kc>None</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.get_oiio_info_for_input class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_oiio_info_for_input</span><span class=p>(</span><span class=n>filepath</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>subimages</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Call oiiotool to get information about input and return stdout.</p> <p>Stdout should contain xml format string.</p> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_oiio_info_for_input</span><span class=p>(</span><span class=n>filepath</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>subimages</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Call oiiotool to get information about input and return stdout.</span>

<span class=sd>    Stdout should contain xml format string.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>args</span> <span class=o>=</span> <span class=n>get_oiio_tool_args</span><span class=p>(</span>
        <span class=s2>&quot;oiiotool&quot;</span><span class=p>,</span>
        <span class=s2>&quot;--info&quot;</span><span class=p>,</span>
        <span class=s2>&quot;-v&quot;</span>
    <span class=p>)</span>
    <span class=k>if</span> <span class=n>subimages</span><span class=p>:</span>
        <span class=n>args</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;-a&quot;</span><span class=p>)</span>

    <span class=n>args</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s2>&quot;-i:infoformat=xml&quot;</span><span class=p>,</span> <span class=n>filepath</span><span class=p>])</span>

    <span class=n>output</span> <span class=o>=</span> <span class=n>run_subprocess</span><span class=p>(</span><span class=n>args</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
    <span class=n>output</span> <span class=o>=</span> <span class=n>output</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\r\n</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=n>xml_started</span> <span class=o>=</span> <span class=kc>False</span>
    <span class=n>subimages_lines</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>lines</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>output</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>):</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>xml_started</span><span class=p>:</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>line</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&quot;&lt;&quot;</span><span class=p>):</span>
                <span class=k>continue</span>
            <span class=n>xml_started</span> <span class=o>=</span> <span class=kc>True</span>

        <span class=k>if</span> <span class=n>xml_started</span><span class=p>:</span>
            <span class=n>lines</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>line</span> <span class=o>==</span> <span class=s2>&quot;&lt;/ImageSpec&gt;&quot;</span><span class=p>:</span>
                <span class=n>subimages_lines</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>lines</span><span class=p>)</span>
                <span class=n>lines</span> <span class=o>=</span> <span class=p>[]</span>
                <span class=n>xml_started</span> <span class=o>=</span> <span class=kc>False</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>subimages_lines</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
            <span class=s2>&quot;Failed to read input file </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>.</span><span class=se>\n</span><span class=s2>Output:</span><span class=se>\n</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                <span class=n>filepath</span><span class=p>,</span> <span class=n>output</span>
            <span class=p>)</span>
        <span class=p>)</span>

    <span class=n>output</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>subimage_lines</span> <span class=ow>in</span> <span class=n>subimages_lines</span><span class=p>:</span>
        <span class=n>xml_text</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>subimage_lines</span><span class=p>)</span>
        <span class=n>output</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>parse_oiio_xml_output</span><span class=p>(</span><span class=n>xml_text</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>))</span>

    <span class=k>if</span> <span class=n>subimages</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>output</span>
    <span class=k>return</span> <span class=n>output</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.get_oiio_input_and_channel_args class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_oiio_input_and_channel_args</span><span class=p>(</span><span class=n>oiio_input_info</span><span class=p>,</span> <span class=n>alpha_default</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get input and channel arguments for oiiotool. Args: oiio_input_info (dict): Information about input from oiio tool. Should be output of function <code>get_oiio_info_for_input</code>. alpha_default (float, optional): Default value for alpha channel. Returns: tuple[str, str]: Tuple of input and channel arguments.</p> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1417</span>
<span class=normal>1418</span>
<span class=normal>1419</span>
<span class=normal>1420</span>
<span class=normal>1421</span>
<span class=normal>1422</span>
<span class=normal>1423</span>
<span class=normal>1424</span>
<span class=normal>1425</span>
<span class=normal>1426</span>
<span class=normal>1427</span>
<span class=normal>1428</span>
<span class=normal>1429</span>
<span class=normal>1430</span>
<span class=normal>1431</span>
<span class=normal>1432</span>
<span class=normal>1433</span>
<span class=normal>1434</span>
<span class=normal>1435</span>
<span class=normal>1436</span>
<span class=normal>1437</span>
<span class=normal>1438</span>
<span class=normal>1439</span>
<span class=normal>1440</span>
<span class=normal>1441</span>
<span class=normal>1442</span>
<span class=normal>1443</span>
<span class=normal>1444</span>
<span class=normal>1445</span>
<span class=normal>1446</span>
<span class=normal>1447</span>
<span class=normal>1448</span>
<span class=normal>1449</span>
<span class=normal>1450</span>
<span class=normal>1451</span>
<span class=normal>1452</span>
<span class=normal>1453</span>
<span class=normal>1454</span>
<span class=normal>1455</span>
<span class=normal>1456</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_oiio_input_and_channel_args</span><span class=p>(</span><span class=n>oiio_input_info</span><span class=p>,</span> <span class=n>alpha_default</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get input and channel arguments for oiiotool.</span>
<span class=sd>    Args:</span>
<span class=sd>        oiio_input_info (dict): Information about input from oiio tool.</span>
<span class=sd>            Should be output of function `get_oiio_info_for_input`.</span>
<span class=sd>        alpha_default (float, optional): Default value for alpha channel.</span>
<span class=sd>    Returns:</span>
<span class=sd>        tuple[str, str]: Tuple of input and channel arguments.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>channel_names</span> <span class=o>=</span> <span class=n>oiio_input_info</span><span class=p>[</span><span class=s2>&quot;channelnames&quot;</span><span class=p>]</span>
    <span class=n>review_channels</span> <span class=o>=</span> <span class=n>get_convert_rgb_channels</span><span class=p>(</span><span class=n>channel_names</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>review_channels</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
            <span class=s2>&quot;Couldn&#39;t find channels that can be used for conversion.&quot;</span>
        <span class=p>)</span>

    <span class=n>red</span><span class=p>,</span> <span class=n>green</span><span class=p>,</span> <span class=n>blue</span><span class=p>,</span> <span class=n>alpha</span> <span class=o>=</span> <span class=n>review_channels</span>
    <span class=n>input_channels</span> <span class=o>=</span> <span class=p>[</span><span class=n>red</span><span class=p>,</span> <span class=n>green</span><span class=p>,</span> <span class=n>blue</span><span class=p>]</span>

    <span class=n>channels_arg</span> <span class=o>=</span> <span class=s2>&quot;R=</span><span class=si>{0}</span><span class=s2>,G=</span><span class=si>{1}</span><span class=s2>,B=</span><span class=si>{2}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>red</span><span class=p>,</span> <span class=n>green</span><span class=p>,</span> <span class=n>blue</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>alpha</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>channels_arg</span> <span class=o>+=</span> <span class=s2>&quot;,A=</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>alpha</span><span class=p>)</span>
        <span class=n>input_channels</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>alpha</span><span class=p>)</span>
    <span class=k>elif</span> <span class=n>alpha_default</span><span class=p>:</span>
        <span class=n>channels_arg</span> <span class=o>+=</span> <span class=s2>&quot;,A=</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=nb>float</span><span class=p>(</span><span class=n>alpha_default</span><span class=p>))</span>
        <span class=n>input_channels</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;A&quot;</span><span class=p>)</span>

    <span class=n>input_channels_str</span> <span class=o>=</span> <span class=s2>&quot;,&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>input_channels</span><span class=p>)</span>

    <span class=n>subimages</span> <span class=o>=</span> <span class=n>oiio_input_info</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;subimages&quot;</span><span class=p>)</span>
    <span class=n>input_arg</span> <span class=o>=</span> <span class=s2>&quot;-i&quot;</span>
    <span class=k>if</span> <span class=n>subimages</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>subimages</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
        <span class=c1># Tell oiiotool which channels should be loaded</span>
        <span class=c1># - other channels are not loaded to memory so helps to avoid memory</span>
        <span class=c1>#       leak issues</span>
        <span class=c1># - this option is crashing if used on multipart exrs</span>
        <span class=n>input_arg</span> <span class=o>+=</span> <span class=s2>&quot;:ch=</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>input_channels_str</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>input_arg</span><span class=p>,</span> <span class=n>channels_arg</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.get_rescaled_command_arguments class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_rescaled_command_arguments</span><span class=p>(</span><span class=n>application</span><span class=p>,</span> <span class=n>input_path</span><span class=p>,</span> <span class=n>target_width</span><span class=p>,</span> <span class=n>target_height</span><span class=p>,</span> <span class=n>target_par</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>bg_color</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>log</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get command arguments for rescaling input to target size.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>application</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Application for which command should be created. Currently supported are "ffmpeg" and "oiiotool".</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>input_path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Path to input file.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>target_width</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Width of target.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>target_height</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Height of target.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>target_par</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=float>float</span>]</code> </td> <td> <div class=doc-md-description> <p>Pixel aspect ratio of target.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>bg_color</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=list>list</span>[<span title=int>int</span>]]</code> </td> <td> <div class=doc-md-description> <p>List of 8bit int values for background color. Should be in range 0 - 255.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=logging.Logger>Logger</span>]</code> </td> <td> <div class=doc-md-description> <p>Logger used for logging.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>list[str]: List of command arguments.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1200</span>
<span class=normal>1201</span>
<span class=normal>1202</span>
<span class=normal>1203</span>
<span class=normal>1204</span>
<span class=normal>1205</span>
<span class=normal>1206</span>
<span class=normal>1207</span>
<span class=normal>1208</span>
<span class=normal>1209</span>
<span class=normal>1210</span>
<span class=normal>1211</span>
<span class=normal>1212</span>
<span class=normal>1213</span>
<span class=normal>1214</span>
<span class=normal>1215</span>
<span class=normal>1216</span>
<span class=normal>1217</span>
<span class=normal>1218</span>
<span class=normal>1219</span>
<span class=normal>1220</span>
<span class=normal>1221</span>
<span class=normal>1222</span>
<span class=normal>1223</span>
<span class=normal>1224</span>
<span class=normal>1225</span>
<span class=normal>1226</span>
<span class=normal>1227</span>
<span class=normal>1228</span>
<span class=normal>1229</span>
<span class=normal>1230</span>
<span class=normal>1231</span>
<span class=normal>1232</span>
<span class=normal>1233</span>
<span class=normal>1234</span>
<span class=normal>1235</span>
<span class=normal>1236</span>
<span class=normal>1237</span>
<span class=normal>1238</span>
<span class=normal>1239</span>
<span class=normal>1240</span>
<span class=normal>1241</span>
<span class=normal>1242</span>
<span class=normal>1243</span>
<span class=normal>1244</span>
<span class=normal>1245</span>
<span class=normal>1246</span>
<span class=normal>1247</span>
<span class=normal>1248</span>
<span class=normal>1249</span>
<span class=normal>1250</span>
<span class=normal>1251</span>
<span class=normal>1252</span>
<span class=normal>1253</span>
<span class=normal>1254</span>
<span class=normal>1255</span>
<span class=normal>1256</span>
<span class=normal>1257</span>
<span class=normal>1258</span>
<span class=normal>1259</span>
<span class=normal>1260</span>
<span class=normal>1261</span>
<span class=normal>1262</span>
<span class=normal>1263</span>
<span class=normal>1264</span>
<span class=normal>1265</span>
<span class=normal>1266</span>
<span class=normal>1267</span>
<span class=normal>1268</span>
<span class=normal>1269</span>
<span class=normal>1270</span>
<span class=normal>1271</span>
<span class=normal>1272</span>
<span class=normal>1273</span>
<span class=normal>1274</span>
<span class=normal>1275</span>
<span class=normal>1276</span>
<span class=normal>1277</span>
<span class=normal>1278</span>
<span class=normal>1279</span>
<span class=normal>1280</span>
<span class=normal>1281</span>
<span class=normal>1282</span>
<span class=normal>1283</span>
<span class=normal>1284</span>
<span class=normal>1285</span>
<span class=normal>1286</span>
<span class=normal>1287</span>
<span class=normal>1288</span>
<span class=normal>1289</span>
<span class=normal>1290</span>
<span class=normal>1291</span>
<span class=normal>1292</span>
<span class=normal>1293</span>
<span class=normal>1294</span>
<span class=normal>1295</span>
<span class=normal>1296</span>
<span class=normal>1297</span>
<span class=normal>1298</span>
<span class=normal>1299</span>
<span class=normal>1300</span>
<span class=normal>1301</span>
<span class=normal>1302</span>
<span class=normal>1303</span>
<span class=normal>1304</span>
<span class=normal>1305</span>
<span class=normal>1306</span>
<span class=normal>1307</span>
<span class=normal>1308</span>
<span class=normal>1309</span>
<span class=normal>1310</span>
<span class=normal>1311</span>
<span class=normal>1312</span>
<span class=normal>1313</span>
<span class=normal>1314</span>
<span class=normal>1315</span>
<span class=normal>1316</span>
<span class=normal>1317</span>
<span class=normal>1318</span>
<span class=normal>1319</span>
<span class=normal>1320</span>
<span class=normal>1321</span>
<span class=normal>1322</span>
<span class=normal>1323</span>
<span class=normal>1324</span>
<span class=normal>1325</span>
<span class=normal>1326</span>
<span class=normal>1327</span>
<span class=normal>1328</span>
<span class=normal>1329</span>
<span class=normal>1330</span>
<span class=normal>1331</span>
<span class=normal>1332</span>
<span class=normal>1333</span>
<span class=normal>1334</span>
<span class=normal>1335</span>
<span class=normal>1336</span>
<span class=normal>1337</span>
<span class=normal>1338</span>
<span class=normal>1339</span>
<span class=normal>1340</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_rescaled_command_arguments</span><span class=p>(</span>
        <span class=n>application</span><span class=p>,</span>
        <span class=n>input_path</span><span class=p>,</span>
        <span class=n>target_width</span><span class=p>,</span>
        <span class=n>target_height</span><span class=p>,</span>
        <span class=n>target_par</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>bg_color</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>log</span><span class=o>=</span><span class=kc>None</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get command arguments for rescaling input to target size.</span>

<span class=sd>    Args:</span>
<span class=sd>        application (str): Application for which command should be created.</span>
<span class=sd>            Currently supported are &quot;ffmpeg&quot; and &quot;oiiotool&quot;.</span>
<span class=sd>        input_path (str): Path to input file.</span>
<span class=sd>        target_width (int): Width of target.</span>
<span class=sd>        target_height (int): Height of target.</span>
<span class=sd>        target_par (Optional[float]): Pixel aspect ratio of target.</span>
<span class=sd>        bg_color (Optional[list[int]]): List of 8bit int values for</span>
<span class=sd>            background color. Should be in range 0 - 255.</span>
<span class=sd>        log (Optional[logging.Logger]): Logger used for logging.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list[str]: List of command arguments.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>command_args</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>target_par</span> <span class=o>=</span> <span class=n>target_par</span> <span class=ow>or</span> <span class=mf>1.0</span>
    <span class=n>input_par</span> <span class=o>=</span> <span class=mf>1.0</span>

    <span class=n>input_height</span><span class=p>,</span> <span class=n>input_width</span><span class=p>,</span> <span class=n>stream_input_par</span> <span class=o>=</span> <span class=n>_get_image_dimensions</span><span class=p>(</span>
        <span class=n>application</span><span class=p>,</span> <span class=n>input_path</span><span class=p>,</span> <span class=n>log</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>stream_input_par</span><span class=p>:</span>
        <span class=n>input_par</span> <span class=o>=</span> <span class=p>(</span>
            <span class=nb>float</span><span class=p>(</span><span class=n>stream_input_par</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>)[</span><span class=mi>0</span><span class=p>])</span>
            <span class=o>/</span> <span class=nb>float</span><span class=p>(</span><span class=n>stream_input_par</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>)[</span><span class=mi>1</span><span class=p>])</span>
        <span class=p>)</span>
    <span class=c1># recalculating input and target width</span>
    <span class=n>input_width</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>input_width</span> <span class=o>*</span> <span class=n>input_par</span><span class=p>)</span>
    <span class=n>target_width</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>target_width</span> <span class=o>*</span> <span class=n>target_par</span><span class=p>)</span>

    <span class=c1># calculate aspect ratios</span>
    <span class=n>target_aspect</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>target_width</span><span class=p>)</span> <span class=o>/</span> <span class=n>target_height</span>
    <span class=n>input_aspect</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>input_width</span><span class=p>)</span> <span class=o>/</span> <span class=n>input_height</span>

    <span class=c1># calculate scale size</span>
    <span class=n>scale_size</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>input_width</span><span class=p>)</span> <span class=o>/</span> <span class=n>target_width</span>
    <span class=k>if</span> <span class=n>input_aspect</span> <span class=o>&lt;</span> <span class=n>target_aspect</span><span class=p>:</span>
        <span class=n>scale_size</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>input_height</span><span class=p>)</span> <span class=o>/</span> <span class=n>target_height</span>

    <span class=c1># calculate rescaled width and height</span>
    <span class=n>rescaled_width</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>input_width</span> <span class=o>/</span> <span class=n>scale_size</span><span class=p>)</span>
    <span class=n>rescaled_height</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>input_height</span> <span class=o>/</span> <span class=n>scale_size</span><span class=p>)</span>

    <span class=c1># calculate width and height shift</span>
    <span class=n>rescaled_width_shift</span> <span class=o>=</span> <span class=nb>int</span><span class=p>((</span><span class=n>target_width</span> <span class=o>-</span> <span class=n>rescaled_width</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>
    <span class=n>rescaled_height_shift</span> <span class=o>=</span> <span class=nb>int</span><span class=p>((</span><span class=n>target_height</span> <span class=o>-</span> <span class=n>rescaled_height</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>application</span> <span class=o>==</span> <span class=s2>&quot;ffmpeg&quot;</span><span class=p>:</span>
        <span class=c1># create scale command</span>
        <span class=n>scale</span> <span class=o>=</span> <span class=s2>&quot;scale=</span><span class=si>{0}</span><span class=s2>:</span><span class=si>{1}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>input_width</span><span class=p>,</span> <span class=n>input_height</span><span class=p>)</span>
        <span class=n>pad</span> <span class=o>=</span> <span class=s2>&quot;pad=</span><span class=si>{0}</span><span class=s2>:</span><span class=si>{1}</span><span class=s2>:(</span><span class=si>{2}</span><span class=s2>-iw)/2:(</span><span class=si>{3}</span><span class=s2>-ih)/2&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
            <span class=n>target_width</span><span class=p>,</span>
            <span class=n>target_height</span><span class=p>,</span>
            <span class=n>target_width</span><span class=p>,</span>
            <span class=n>target_height</span>
        <span class=p>)</span>
        <span class=k>if</span> <span class=n>input_width</span> <span class=o>&gt;</span> <span class=n>target_width</span> <span class=ow>or</span> <span class=n>input_height</span> <span class=o>&gt;</span> <span class=n>target_height</span><span class=p>:</span>
            <span class=n>scale</span> <span class=o>=</span> <span class=s2>&quot;scale=</span><span class=si>{0}</span><span class=s2>:</span><span class=si>{1}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>rescaled_width</span><span class=p>,</span> <span class=n>rescaled_height</span><span class=p>)</span>
            <span class=n>pad</span> <span class=o>=</span> <span class=s2>&quot;pad=</span><span class=si>{0}</span><span class=s2>:</span><span class=si>{1}</span><span class=s2>:</span><span class=si>{2}</span><span class=s2>:</span><span class=si>{3}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                <span class=n>target_width</span><span class=p>,</span>
                <span class=n>target_height</span><span class=p>,</span>
                <span class=n>rescaled_width_shift</span><span class=p>,</span>
                <span class=n>rescaled_height_shift</span>
            <span class=p>)</span>

        <span class=k>if</span> <span class=n>bg_color</span><span class=p>:</span>
            <span class=n>color</span> <span class=o>=</span> <span class=n>convert_color_values</span><span class=p>(</span><span class=n>application</span><span class=p>,</span> <span class=n>bg_color</span><span class=p>)</span>
            <span class=n>pad</span> <span class=o>+=</span> <span class=s2>&quot;:</span><span class=si>{0}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>color</span><span class=p>)</span>
        <span class=n>command_args</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s2>&quot;-vf&quot;</span><span class=p>,</span> <span class=s2>&quot;</span><span class=si>{0}</span><span class=s2>,</span><span class=si>{1}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>scale</span><span class=p>,</span> <span class=n>pad</span><span class=p>)])</span>

    <span class=k>elif</span> <span class=n>application</span> <span class=o>==</span> <span class=s2>&quot;oiiotool&quot;</span><span class=p>:</span>
        <span class=n>input_info</span> <span class=o>=</span> <span class=n>get_oiio_info_for_input</span><span class=p>(</span><span class=n>input_path</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>log</span><span class=p>)</span>
        <span class=c1># Collect channels to export</span>
        <span class=n>_</span><span class=p>,</span> <span class=n>channels_arg</span> <span class=o>=</span> <span class=n>get_oiio_input_and_channel_args</span><span class=p>(</span>
            <span class=n>input_info</span><span class=p>,</span> <span class=n>alpha_default</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span>

        <span class=n>command_args</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span>
            <span class=c1># Tell oiiotool which channels should be put to top stack</span>
            <span class=c1>#   (and output)</span>
            <span class=s2>&quot;--ch&quot;</span><span class=p>,</span> <span class=n>channels_arg</span><span class=p>,</span>
            <span class=c1># Use first subimage</span>
            <span class=s2>&quot;--subimage&quot;</span><span class=p>,</span> <span class=s2>&quot;0&quot;</span>
        <span class=p>])</span>

        <span class=k>if</span> <span class=n>input_par</span> <span class=o>!=</span> <span class=mf>1.0</span><span class=p>:</span>
            <span class=n>command_args</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s2>&quot;--pixelaspect&quot;</span><span class=p>,</span> <span class=s2>&quot;1&quot;</span><span class=p>])</span>

        <span class=n>width_shift</span> <span class=o>=</span> <span class=nb>int</span><span class=p>((</span><span class=n>target_width</span> <span class=o>-</span> <span class=n>input_width</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>
        <span class=n>height_shift</span> <span class=o>=</span> <span class=nb>int</span><span class=p>((</span><span class=n>target_height</span> <span class=o>-</span> <span class=n>input_height</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>

        <span class=c1># default resample is not scaling source image</span>
        <span class=n>resample</span> <span class=o>=</span> <span class=p>[</span>
            <span class=s2>&quot;--resize&quot;</span><span class=p>,</span>
            <span class=s2>&quot;</span><span class=si>{0}</span><span class=s2>x</span><span class=si>{1}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>input_width</span><span class=p>,</span> <span class=n>input_height</span><span class=p>),</span>
            <span class=s2>&quot;--origin&quot;</span><span class=p>,</span>
            <span class=s2>&quot;+</span><span class=si>{0}</span><span class=s2>+</span><span class=si>{1}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>width_shift</span><span class=p>,</span> <span class=n>height_shift</span><span class=p>),</span>
        <span class=p>]</span>
        <span class=c1># scaled source image to target size</span>
        <span class=k>if</span> <span class=n>input_width</span> <span class=o>&gt;</span> <span class=n>target_width</span> <span class=ow>or</span> <span class=n>input_height</span> <span class=o>&gt;</span> <span class=n>target_height</span><span class=p>:</span>
            <span class=c1># form resample command</span>
            <span class=n>resample</span> <span class=o>=</span> <span class=p>[</span>
                <span class=s2>&quot;--resize:filter=lanczos3&quot;</span><span class=p>,</span>
                <span class=s2>&quot;</span><span class=si>{0}</span><span class=s2>x</span><span class=si>{1}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>rescaled_width</span><span class=p>,</span> <span class=n>rescaled_height</span><span class=p>),</span>
                <span class=s2>&quot;--origin&quot;</span><span class=p>,</span>
                <span class=s2>&quot;+</span><span class=si>{0}</span><span class=s2>+</span><span class=si>{1}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>rescaled_width_shift</span><span class=p>,</span> <span class=n>rescaled_height_shift</span><span class=p>),</span>
            <span class=p>]</span>
        <span class=n>command_args</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>resample</span><span class=p>)</span>

        <span class=n>fullsize</span> <span class=o>=</span> <span class=p>[</span>
            <span class=s2>&quot;--fullsize&quot;</span><span class=p>,</span>
            <span class=s2>&quot;</span><span class=si>{0}</span><span class=s2>x</span><span class=si>{1}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>target_width</span><span class=p>,</span> <span class=n>target_height</span><span class=p>)</span>
        <span class=p>]</span>
        <span class=k>if</span> <span class=n>bg_color</span><span class=p>:</span>
            <span class=n>color</span> <span class=o>=</span> <span class=n>convert_color_values</span><span class=p>(</span><span class=n>application</span><span class=p>,</span> <span class=n>bg_color</span><span class=p>)</span>

            <span class=n>fullsize</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span>
                <span class=s2>&quot;--pattern&quot;</span><span class=p>,</span>
                <span class=s2>&quot;constant:color=</span><span class=si>{0}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>color</span><span class=p>),</span>
                <span class=s2>&quot;</span><span class=si>{0}</span><span class=s2>x</span><span class=si>{1}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>target_width</span><span class=p>,</span> <span class=n>target_height</span><span class=p>),</span>
                <span class=s2>&quot;4&quot;</span><span class=p>,</span>  <span class=c1># 4 channels</span>
                <span class=s2>&quot;--over&quot;</span>
            <span class=p>])</span>
        <span class=n>command_args</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>fullsize</span><span class=p>)</span>

    <span class=k>else</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
            <span class=s2>&quot;</span><span class=se>\&quot;</span><span class=s2>application</span><span class=se>\&quot;</span><span class=s2> input argument should &quot;</span>
            <span class=s2>&quot;be either </span><span class=se>\&quot;</span><span class=s2>ffmpeg</span><span class=se>\&quot;</span><span class=s2> or </span><span class=se>\&quot;</span><span class=s2>oiiotool</span><span class=se>\&quot;</span><span class=s2>&quot;</span>
        <span class=p>)</span>

    <span class=k>return</span> <span class=n>command_args</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.get_review_info_by_layer_name class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_review_info_by_layer_name</span><span class=p>(</span><span class=n>channel_names</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get channels info grouped by layer name.</p> <p>Finds all layers in channel names and returns list of dictionaries with information about channels in layer. Example output (not real world example): [ { "name": "Main", "review_channels": { "R": "Main.red", "G": "Main.green", "B": "Main.blue", "A": None, } }, { "name": "Composed", "review_channels": { "R": "Composed.R", "G": "Composed.G", "B": "Composed.B", "A": "Composed.A", } }, ... ]</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>channel_names</code> </td> <td> <code><span title=list>list</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>List of channel names.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>list[dict]: List of channels information.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span>
<span class=normal>366</span>
<span class=normal>367</span>
<span class=normal>368</span>
<span class=normal>369</span>
<span class=normal>370</span>
<span class=normal>371</span>
<span class=normal>372</span>
<span class=normal>373</span>
<span class=normal>374</span>
<span class=normal>375</span>
<span class=normal>376</span>
<span class=normal>377</span>
<span class=normal>378</span>
<span class=normal>379</span>
<span class=normal>380</span>
<span class=normal>381</span>
<span class=normal>382</span>
<span class=normal>383</span>
<span class=normal>384</span>
<span class=normal>385</span>
<span class=normal>386</span>
<span class=normal>387</span>
<span class=normal>388</span>
<span class=normal>389</span>
<span class=normal>390</span>
<span class=normal>391</span>
<span class=normal>392</span>
<span class=normal>393</span>
<span class=normal>394</span>
<span class=normal>395</span>
<span class=normal>396</span>
<span class=normal>397</span>
<span class=normal>398</span>
<span class=normal>399</span>
<span class=normal>400</span>
<span class=normal>401</span>
<span class=normal>402</span>
<span class=normal>403</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_review_info_by_layer_name</span><span class=p>(</span><span class=n>channel_names</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get channels info grouped by layer name.</span>

<span class=sd>    Finds all layers in channel names and returns list of dictionaries with</span>
<span class=sd>    information about channels in layer.</span>
<span class=sd>    Example output (not real world example):</span>
<span class=sd>        [</span>
<span class=sd>            {</span>
<span class=sd>                &quot;name&quot;: &quot;Main&quot;,</span>
<span class=sd>                &quot;review_channels&quot;: {</span>
<span class=sd>                    &quot;R&quot;: &quot;Main.red&quot;,</span>
<span class=sd>                    &quot;G&quot;: &quot;Main.green&quot;,</span>
<span class=sd>                    &quot;B&quot;: &quot;Main.blue&quot;,</span>
<span class=sd>                    &quot;A&quot;: None,</span>
<span class=sd>                }</span>
<span class=sd>            },</span>
<span class=sd>            {</span>
<span class=sd>                &quot;name&quot;: &quot;Composed&quot;,</span>
<span class=sd>                &quot;review_channels&quot;: {</span>
<span class=sd>                    &quot;R&quot;: &quot;Composed.R&quot;,</span>
<span class=sd>                    &quot;G&quot;: &quot;Composed.G&quot;,</span>
<span class=sd>                    &quot;B&quot;: &quot;Composed.B&quot;,</span>
<span class=sd>                    &quot;A&quot;: &quot;Composed.A&quot;,</span>
<span class=sd>                }</span>
<span class=sd>            },</span>
<span class=sd>            ...</span>
<span class=sd>        ]</span>

<span class=sd>    Args:</span>
<span class=sd>        channel_names (list[str]): List of channel names.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list[dict]: List of channels information.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>layer_names_order</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>rgba_by_layer_name</span> <span class=o>=</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>
    <span class=n>channels_by_layer_name</span> <span class=o>=</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>channel_name</span> <span class=ow>in</span> <span class=n>channel_names</span><span class=p>:</span>
        <span class=n>layer_name</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span>
        <span class=n>last_part</span> <span class=o>=</span> <span class=n>channel_name</span>
        <span class=k>if</span> <span class=s2>&quot;.&quot;</span> <span class=ow>in</span> <span class=n>channel_name</span><span class=p>:</span>
            <span class=n>layer_name</span><span class=p>,</span> <span class=n>last_part</span> <span class=o>=</span> <span class=n>channel_name</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;.&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>

        <span class=n>channels_by_layer_name</span><span class=p>[</span><span class=n>layer_name</span><span class=p>][</span><span class=n>channel_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>last_part</span>
        <span class=k>if</span> <span class=n>last_part</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>{</span>
            <span class=s2>&quot;r&quot;</span><span class=p>,</span> <span class=s2>&quot;red&quot;</span><span class=p>,</span>
            <span class=s2>&quot;g&quot;</span><span class=p>,</span> <span class=s2>&quot;green&quot;</span><span class=p>,</span>
            <span class=s2>&quot;b&quot;</span><span class=p>,</span> <span class=s2>&quot;blue&quot;</span><span class=p>,</span>
            <span class=s2>&quot;a&quot;</span><span class=p>,</span> <span class=s2>&quot;alpha&quot;</span>
        <span class=p>}:</span>
            <span class=k>continue</span>

        <span class=k>if</span> <span class=n>layer_name</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>layer_names_order</span><span class=p>:</span>
            <span class=n>layer_names_order</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>layer_name</span><span class=p>)</span>
        <span class=c1># R, G, B or A</span>
        <span class=n>channel</span> <span class=o>=</span> <span class=n>last_part</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span>
        <span class=n>rgba_by_layer_name</span><span class=p>[</span><span class=n>layer_name</span><span class=p>][</span><span class=n>channel</span><span class=p>]</span> <span class=o>=</span> <span class=n>channel_name</span>

    <span class=c1># Put empty layer to the beginning of the list</span>
    <span class=c1># - if input has R, G, B, A channels they should be used for review</span>
    <span class=k>if</span> <span class=s2>&quot;&quot;</span> <span class=ow>in</span> <span class=n>layer_names_order</span><span class=p>:</span>
        <span class=n>layer_names_order</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=s2>&quot;&quot;</span><span class=p>)</span>
        <span class=n>layer_names_order</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>

    <span class=n>output</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>layer_name</span> <span class=ow>in</span> <span class=n>layer_names_order</span><span class=p>:</span>
        <span class=n>rgba_layer_info</span> <span class=o>=</span> <span class=n>rgba_by_layer_name</span><span class=p>[</span><span class=n>layer_name</span><span class=p>]</span>
        <span class=n>red</span> <span class=o>=</span> <span class=n>rgba_layer_info</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;R&quot;</span><span class=p>)</span>
        <span class=n>green</span> <span class=o>=</span> <span class=n>rgba_layer_info</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;G&quot;</span><span class=p>)</span>
        <span class=n>blue</span> <span class=o>=</span> <span class=n>rgba_layer_info</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;B&quot;</span><span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>red</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>green</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>blue</span><span class=p>:</span>
            <span class=k>continue</span>
        <span class=n>output</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
            <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>layer_name</span><span class=p>,</span>
            <span class=s2>&quot;review_channels&quot;</span><span class=p>:</span> <span class=p>{</span>
                <span class=s2>&quot;R&quot;</span><span class=p>:</span> <span class=n>red</span><span class=p>,</span>
                <span class=s2>&quot;G&quot;</span><span class=p>:</span> <span class=n>green</span><span class=p>,</span>
                <span class=s2>&quot;B&quot;</span><span class=p>:</span> <span class=n>blue</span><span class=p>,</span>
                <span class=s2>&quot;A&quot;</span><span class=p>:</span> <span class=n>rgba_layer_info</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;A&quot;</span><span class=p>),</span>
            <span class=p>}</span>
        <span class=p>})</span>
    <span class=k>return</span> <span class=n>output</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.get_review_layer_name class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_review_layer_name</span><span class=p>(</span><span class=n>src_filepath</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Find layer name that could be used for review.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>src_filepath</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Path to input file.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>Union[str, None]: Layer name of None.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>450</span>
<span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span>
<span class=normal>464</span>
<span class=normal>465</span>
<span class=normal>466</span>
<span class=normal>467</span>
<span class=normal>468</span>
<span class=normal>469</span>
<span class=normal>470</span>
<span class=normal>471</span>
<span class=normal>472</span>
<span class=normal>473</span>
<span class=normal>474</span>
<span class=normal>475</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_review_layer_name</span><span class=p>(</span><span class=n>src_filepath</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Find layer name that could be used for review.</span>

<span class=sd>    Args:</span>
<span class=sd>        src_filepath (str): Path to input file.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Union[str, None]: Layer name of None.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>ext</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>splitext</span><span class=p>(</span><span class=n>src_filepath</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
    <span class=k>if</span> <span class=n>ext</span> <span class=o>!=</span> <span class=s2>&quot;.exr&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=kc>None</span>

    <span class=c1># Load info about file from oiio tool</span>
    <span class=n>input_info</span> <span class=o>=</span> <span class=n>get_oiio_info_for_input</span><span class=p>(</span><span class=n>src_filepath</span><span class=p>)</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>input_info</span><span class=p>:</span>
        <span class=k>return</span> <span class=kc>None</span>

    <span class=n>channel_names</span> <span class=o>=</span> <span class=n>input_info</span><span class=p>[</span><span class=s2>&quot;channelnames&quot;</span><span class=p>]</span>
    <span class=n>channels_info</span> <span class=o>=</span> <span class=n>get_review_info_by_layer_name</span><span class=p>(</span><span class=n>channel_names</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>channels_info</span><span class=p>:</span>
        <span class=c1># Layer name can be &#39;&#39;, when review channels are &#39;R&#39;, &#39;G&#39;, &#39;B&#39;</span>
        <span class=c1>#   without layer</span>
        <span class=k>return</span> <span class=n>item</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]</span> <span class=ow>or</span> <span class=kc>None</span>
    <span class=k>return</span> <span class=kc>None</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.get_transcode_temp_directory class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_transcode_temp_directory</span><span class=p>()</span></code> </h2> <div class="doc doc-contents "> <p>Creates temporary folder for transcoding.</p> <p>Its local, in case of farm it is 'local' to the farm machine.</p> <p>Should be much faster, needs to be cleaned up later.</p> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>70</span>
<span class=normal>71</span>
<span class=normal>72</span>
<span class=normal>73</span>
<span class=normal>74</span>
<span class=normal>75</span>
<span class=normal>76</span>
<span class=normal>77</span>
<span class=normal>78</span>
<span class=normal>79</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_transcode_temp_directory</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Creates temporary folder for transcoding.</span>

<span class=sd>    Its local, in case of farm it is &#39;local&#39; to the farm machine.</span>

<span class=sd>    Should be much faster, needs to be cleaned up later.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>normpath</span><span class=p>(</span>
        <span class=n>tempfile</span><span class=o>.</span><span class=n>mkdtemp</span><span class=p>(</span><span class=n>prefix</span><span class=o>=</span><span class=s2>&quot;op_transcoding_&quot;</span><span class=p>)</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.parse_oiio_xml_output class="doc doc-heading"> <code class="highlight language-python"><span class=n>parse_oiio_xml_output</span><span class=p>(</span><span class=n>xml_string</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Parse xml output from OIIO info command.</p> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span>
<span class=normal>288</span>
<span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span>
<span class=normal>295</span>
<span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>parse_oiio_xml_output</span><span class=p>(</span><span class=n>xml_string</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Parse xml output from OIIO info command.&quot;&quot;&quot;</span>
    <span class=n>output</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>xml_string</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>output</span>

    <span class=c1># Fix values with ampresand (lazy fix)</span>
    <span class=c1># - oiiotool exports invalid xml which ElementTree can&#39;t handle</span>
    <span class=c1>#   e.g. &quot;&amp;#01;&quot;</span>
    <span class=c1># WARNING: this will affect even valid character entities. If you need</span>
    <span class=c1>#   those values correctly, this must take care of valid character ranges.</span>
    <span class=c1>#   See https://github.com/pypeclub/OpenPype/pull/2729</span>
    <span class=n>matches</span> <span class=o>=</span> <span class=n>XML_CHAR_REF_REGEX_HEX</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=n>xml_string</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>match</span> <span class=ow>in</span> <span class=n>matches</span><span class=p>:</span>
        <span class=n>new_value</span> <span class=o>=</span> <span class=n>match</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;&amp;&quot;</span><span class=p>,</span> <span class=s2>&quot;&amp;amp;&quot;</span><span class=p>)</span>
        <span class=n>xml_string</span> <span class=o>=</span> <span class=n>xml_string</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>match</span><span class=p>,</span> <span class=n>new_value</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>logger</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s2>&quot;OIIO-xml-parse&quot;</span><span class=p>)</span>

    <span class=n>tree</span> <span class=o>=</span> <span class=n>xml</span><span class=o>.</span><span class=n>etree</span><span class=o>.</span><span class=n>ElementTree</span><span class=o>.</span><span class=n>fromstring</span><span class=p>(</span><span class=n>xml_string</span><span class=p>)</span>
    <span class=n>attribs</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=n>output</span><span class=p>[</span><span class=s2>&quot;attribs&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>attribs</span>
    <span class=k>for</span> <span class=n>child</span> <span class=ow>in</span> <span class=n>tree</span><span class=p>:</span>
        <span class=n>tag_name</span> <span class=o>=</span> <span class=n>child</span><span class=o>.</span><span class=n>tag</span>
        <span class=k>if</span> <span class=n>tag_name</span> <span class=o>==</span> <span class=s2>&quot;attrib&quot;</span><span class=p>:</span>
            <span class=n>attrib_def</span> <span class=o>=</span> <span class=n>child</span><span class=o>.</span><span class=n>attrib</span>
            <span class=n>value</span> <span class=o>=</span> <span class=n>convert_value_by_type_name</span><span class=p>(</span>
                <span class=n>attrib_def</span><span class=p>[</span><span class=s2>&quot;type&quot;</span><span class=p>],</span> <span class=n>child</span><span class=o>.</span><span class=n>text</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span>
            <span class=p>)</span>

            <span class=n>attribs</span><span class=p>[</span><span class=n>attrib_def</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]]</span> <span class=o>=</span> <span class=n>value</span>
            <span class=k>continue</span>

        <span class=c1># Channels are stored as tex on each child</span>
        <span class=k>if</span> <span class=n>tag_name</span> <span class=o>==</span> <span class=s2>&quot;channelnames&quot;</span><span class=p>:</span>
            <span class=n>value</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=k>for</span> <span class=n>channel</span> <span class=ow>in</span> <span class=n>child</span><span class=p>:</span>
                <span class=n>value</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>channel</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>

        <span class=c1># Convert known integer type tags to int</span>
        <span class=k>elif</span> <span class=n>tag_name</span> <span class=ow>in</span> <span class=n>INT_TAGS</span><span class=p>:</span>
            <span class=n>value</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>child</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>

        <span class=c1># Keep value of known string tags</span>
        <span class=k>elif</span> <span class=n>tag_name</span> <span class=ow>in</span> <span class=n>STRING_TAGS</span><span class=p>:</span>
            <span class=n>value</span> <span class=o>=</span> <span class=n>child</span><span class=o>.</span><span class=n>text</span>

        <span class=c1># Keep value as text for unknown tags</span>
        <span class=c1># - feel free to add more tags</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>value</span> <span class=o>=</span> <span class=n>child</span><span class=o>.</span><span class=n>text</span>
            <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>((</span>
                <span class=s2>&quot;Dev note (missing implementation):&quot;</span>
                <span class=s2>&quot; Unknown tag </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>. Value </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>&quot;</span>
            <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>tag_name</span><span class=p>,</span> <span class=n>value</span><span class=p>))</span>

        <span class=n>output</span><span class=p>[</span><span class=n>child</span><span class=o>.</span><span class=n>tag</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>

    <span class=k>return</span> <span class=n>output</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.should_convert_for_ffmpeg class="doc doc-heading"> <code class="highlight language-python"><span class=n>should_convert_for_ffmpeg</span><span class=p>(</span><span class=n>src_filepath</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Find out if input should be converted for ffmpeg.</p> <p>Currently cares only about exr inputs and is based on OpenImageIO.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>bool/NoneType: True if should be converted, False if should not and None if can't determine.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>478</span>
<span class=normal>479</span>
<span class=normal>480</span>
<span class=normal>481</span>
<span class=normal>482</span>
<span class=normal>483</span>
<span class=normal>484</span>
<span class=normal>485</span>
<span class=normal>486</span>
<span class=normal>487</span>
<span class=normal>488</span>
<span class=normal>489</span>
<span class=normal>490</span>
<span class=normal>491</span>
<span class=normal>492</span>
<span class=normal>493</span>
<span class=normal>494</span>
<span class=normal>495</span>
<span class=normal>496</span>
<span class=normal>497</span>
<span class=normal>498</span>
<span class=normal>499</span>
<span class=normal>500</span>
<span class=normal>501</span>
<span class=normal>502</span>
<span class=normal>503</span>
<span class=normal>504</span>
<span class=normal>505</span>
<span class=normal>506</span>
<span class=normal>507</span>
<span class=normal>508</span>
<span class=normal>509</span>
<span class=normal>510</span>
<span class=normal>511</span>
<span class=normal>512</span>
<span class=normal>513</span>
<span class=normal>514</span>
<span class=normal>515</span>
<span class=normal>516</span>
<span class=normal>517</span>
<span class=normal>518</span>
<span class=normal>519</span>
<span class=normal>520</span>
<span class=normal>521</span>
<span class=normal>522</span>
<span class=normal>523</span>
<span class=normal>524</span>
<span class=normal>525</span>
<span class=normal>526</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>should_convert_for_ffmpeg</span><span class=p>(</span><span class=n>src_filepath</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Find out if input should be converted for ffmpeg.</span>

<span class=sd>    Currently cares only about exr inputs and is based on OpenImageIO.</span>

<span class=sd>    Returns:</span>
<span class=sd>        bool/NoneType: True if should be converted, False if should not and</span>
<span class=sd>            None if can&#39;t determine.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># Care only about exr at this moment</span>
    <span class=n>ext</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>splitext</span><span class=p>(</span><span class=n>src_filepath</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
    <span class=k>if</span> <span class=n>ext</span> <span class=o>!=</span> <span class=s2>&quot;.exr&quot;</span><span class=p>:</span>
        <span class=k>return</span> <span class=kc>False</span>

    <span class=c1># Can&#39;t determine if should convert or not without oiio_tool</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>is_oiio_supported</span><span class=p>():</span>
        <span class=k>return</span> <span class=kc>None</span>

    <span class=c1># Load info about file from oiio tool</span>
    <span class=n>input_info</span> <span class=o>=</span> <span class=n>get_oiio_info_for_input</span><span class=p>(</span><span class=n>src_filepath</span><span class=p>)</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>input_info</span><span class=p>:</span>
        <span class=k>return</span> <span class=kc>None</span>

    <span class=n>subimages</span> <span class=o>=</span> <span class=n>input_info</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;subimages&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>subimages</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>subimages</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
        <span class=k>return</span> <span class=kc>True</span>

    <span class=c1># Check compression</span>
    <span class=n>compression</span> <span class=o>=</span> <span class=n>input_info</span><span class=p>[</span><span class=s2>&quot;attribs&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;compression&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>compression</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&quot;dwaa&quot;</span><span class=p>,</span> <span class=s2>&quot;dwab&quot;</span><span class=p>):</span>
        <span class=k>return</span> <span class=kc>True</span>

    <span class=c1># Check channels</span>
    <span class=n>channel_names</span> <span class=o>=</span> <span class=n>input_info</span><span class=p>[</span><span class=s2>&quot;channelnames&quot;</span><span class=p>]</span>
    <span class=n>review_channels</span> <span class=o>=</span> <span class=n>get_convert_rgb_channels</span><span class=p>(</span><span class=n>channel_names</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>review_channels</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>return</span> <span class=kc>None</span>

    <span class=k>for</span> <span class=n>attr_value</span> <span class=ow>in</span> <span class=n>input_info</span><span class=p>[</span><span class=s2>&quot;attribs&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>attr_value</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
            <span class=k>continue</span>

        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>attr_value</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>MAX_FFMPEG_STRING_LEN</span><span class=p>:</span>
            <span class=k>return</span> <span class=kc>True</span>

        <span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>NOT_ALLOWED_FFMPEG_CHARS</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>attr_value</span><span class=p>:</span>
                <span class=k>return</span> <span class=kc>True</span>
    <span class=k>return</span> <span class=kc>False</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.lib.transcoding.split_cmd_args class="doc doc-heading"> <code class="highlight language-python"><span class=n>split_cmd_args</span><span class=p>(</span><span class=n>in_args</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Makes sure all entered arguments are separated in individual items.</p> <p>Split each argument string with " -" to identify if string contains one or more arguments. Args: in_args (list): of arguments ['-n', '-d uint10'] Returns (list): ['-n', '-d', 'unint10']</p> <details class=quote> <summary>Source code in <code>client/ayon_core/lib/transcoding.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1182</span>
<span class=normal>1183</span>
<span class=normal>1184</span>
<span class=normal>1185</span>
<span class=normal>1186</span>
<span class=normal>1187</span>
<span class=normal>1188</span>
<span class=normal>1189</span>
<span class=normal>1190</span>
<span class=normal>1191</span>
<span class=normal>1192</span>
<span class=normal>1193</span>
<span class=normal>1194</span>
<span class=normal>1195</span>
<span class=normal>1196</span>
<span class=normal>1197</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>split_cmd_args</span><span class=p>(</span><span class=n>in_args</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Makes sure all entered arguments are separated in individual items.</span>

<span class=sd>    Split each argument string with &quot; -&quot; to identify if string contains</span>
<span class=sd>    one or more arguments.</span>
<span class=sd>    Args:</span>
<span class=sd>        in_args (list): of arguments [&#39;-n&#39;, &#39;-d uint10&#39;]</span>
<span class=sd>    Returns</span>
<span class=sd>        (list): [&#39;-n&#39;, &#39;-d&#39;, &#39;unint10&#39;]</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>splitted_args</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>arg</span> <span class=ow>in</span> <span class=n>in_args</span><span class=p>:</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>arg</span><span class=o>.</span><span class=n>strip</span><span class=p>():</span>
            <span class=k>continue</span>
        <span class=n>splitted_args</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>arg</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot; &quot;</span><span class=p>))</span>
    <span class=k>return</span> <span class=n>splitted_args</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["navigation.sections", "navigation.path", "navigation.prune"], "search": "../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../../assets/javascripts/bundle.c8b220af.min.js></script> </body> </html>