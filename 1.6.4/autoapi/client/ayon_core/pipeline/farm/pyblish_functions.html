<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=prev href=patterning.html><link rel=next href=tools.html><link rel=icon href=../../../../../img/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.21"><title>pyblish_functions - ayon-core</title><link rel=stylesheet href=../../../../../assets/stylesheets/main.2a3383ac.min.css><link rel=stylesheet href=../../../../../assets/stylesheets/palette.06af60db.min.css><script src=https://unpkg.com/iframe-worker/shim></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../../../css/custom.css><script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#client.ayon_core.pipeline.farm.pyblish_functions class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../../../index.html title=ayon-core class="md-header__button md-logo" aria-label=ayon-core data-md-component=logo> <img src=../../../../../img/ay-symbol-blackw-full.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ayon-core </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> pyblish_functions </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ynput/ayon-core title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../../../index.html title=ayon-core class="md-nav__button md-logo" aria-label=ayon-core data-md-component=logo> <img src=../../../../../img/ay-symbol-blackw-full.png alt=logo> </a> ayon-core </label> <div class=md-nav__source> <a href=https://github.com/ynput/ayon-core title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../index.html class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../../../license.html class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1 checked> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class=md-ellipsis> client </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> client </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1 checked> <label class=md-nav__link for=__nav_3_1_1 id=__nav_3_1_1_label tabindex=0> <span class=md-ellipsis> ayon_core </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_1_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1> <span class="md-nav__icon md-icon"></span> ayon_core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../__main__.html class=md-nav__link> <span class=md-ellipsis> __main__ </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../addon/base.html class=md-nav__link> <span class=md-ellipsis> addon </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../cli.html class=md-nav__link> <span class=md-ellipsis> cli </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../hooks/pre_add_last_workfile_arg.html class=md-nav__link> <span class=md-ellipsis> hooks </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../host/abstract.html class=md-nav__link> <span class=md-ellipsis> host </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../lib/attribute_definitions.html class=md-nav__link> <span class=md-ellipsis> lib </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1_7 checked> <label class=md-nav__link for=__nav_3_1_1_7 id=__nav_3_1_1_7_label tabindex=0> <span class=md-ellipsis> pipeline </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_1_1_7_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1_7> <span class="md-nav__icon md-icon"></span> pipeline </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../actions.html class=md-nav__link> <span class=md-ellipsis> actions </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../anatomy/anatomy.html class=md-nav__link> <span class=md-ellipsis> anatomy </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../colorspace.html class=md-nav__link> <span class=md-ellipsis> colorspace </span> </a> </li> <li class=md-nav__item> <a href=../compatibility.html class=md-nav__link> <span class=md-ellipsis> compatibility </span> </a> </li> <li class=md-nav__item> <a href=../constants.html class=md-nav__link> <span class=md-ellipsis> constants </span> </a> </li> <li class=md-nav__item> <a href=../context_tools.html class=md-nav__link> <span class=md-ellipsis> context_tools </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../create/changes.html class=md-nav__link> <span class=md-ellipsis> create </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../delivery.html class=md-nav__link> <span class=md-ellipsis> delivery </span> </a> </li> <li class=md-nav__item> <a href=../editorial.html class=md-nav__link> <span class=md-ellipsis> editorial </span> </a> </li> <li class=md-nav__item> <a href=../entity_uri.html class=md-nav__link> <span class=md-ellipsis> entity_uri </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1_7_11 checked> <label class=md-nav__link for=__nav_3_1_1_7_11 id=__nav_3_1_1_7_11_label tabindex=0> <span class=md-ellipsis> farm </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_3_1_1_7_11_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1_7_11> <span class="md-nav__icon md-icon"></span> farm </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=patterning.html class=md-nav__link> <span class=md-ellipsis> patterning </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> pyblish_functions </span> <span class="md-nav__icon md-icon"></span> </label> <a href=pyblish_functions.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> pyblish_functions </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions class=md-nav__link> <span class=md-ellipsis> pyblish_functions </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.TimeData class=md-nav__link> <span class=md-ellipsis> TimeData </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.attach_instances_to_product class=md-nav__link> <span class=md-ellipsis> attach_instances_to_product </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.convert_frames_str_to_list class=md-nav__link> <span class=md-ellipsis> convert_frames_str_to_list </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.copy_extend_frames class=md-nav__link> <span class=md-ellipsis> copy_extend_frames </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.create_instances_for_aov class=md-nav__link> <span class=md-ellipsis> create_instances_for_aov </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.create_instances_for_cache class=md-nav__link> <span class=md-ellipsis> create_instances_for_cache </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.create_skeleton_instance class=md-nav__link> <span class=md-ellipsis> create_skeleton_instance </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.create_skeleton_instance_cache class=md-nav__link> <span class=md-ellipsis> create_skeleton_instance_cache </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.extend_frames class=md-nav__link> <span class=md-ellipsis> extend_frames </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.get_product_name_and_group_from_template class=md-nav__link> <span class=md-ellipsis> get_product_name_and_group_from_template </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.get_resources class=md-nav__link> <span class=md-ellipsis> get_resources </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.get_time_data_from_instance_or_context class=md-nav__link> <span class=md-ellipsis> get_time_data_from_instance_or_context </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.get_transferable_representations class=md-nav__link> <span class=md-ellipsis> get_transferable_representations </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.prepare_cache_representations class=md-nav__link> <span class=md-ellipsis> prepare_cache_representations </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.prepare_representations class=md-nav__link> <span class=md-ellipsis> prepare_representations </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.remap_source class=md-nav__link> <span class=md-ellipsis> remap_source </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=tools.html class=md-nav__link> <span class=md-ellipsis> tools </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../load/plugins.html class=md-nav__link> <span class=md-ellipsis> load </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../plugin_discover.html class=md-nav__link> <span class=md-ellipsis> plugin_discover </span> </a> </li> <li class=md-nav__item> <a href=../project_folders.html class=md-nav__link> <span class=md-ellipsis> project_folders </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../publish/abstract_collect_render.html class=md-nav__link> <span class=md-ellipsis> publish </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../schema/index.html class=md-nav__link> <span class=md-ellipsis> schema </span> </a> </li> <li class=md-nav__item> <a href=../staging_dir.html class=md-nav__link> <span class=md-ellipsis> staging_dir </span> </a> </li> <li class=md-nav__item> <a href=../tempdir.html class=md-nav__link> <span class=md-ellipsis> tempdir </span> </a> </li> <li class=md-nav__item> <a href=../template_data.html class=md-nav__link> <span class=md-ellipsis> template_data </span> </a> </li> <li class=md-nav__item> <a href=../thumbnails.html class=md-nav__link> <span class=md-ellipsis> thumbnails </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../traits/color.html class=md-nav__link> <span class=md-ellipsis> traits </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../usdlib.html class=md-nav__link> <span class=md-ellipsis> usdlib </span> </a> </li> <li class=md-nav__item> <a href=../version_start.html class=md-nav__link> <span class=md-ellipsis> version_start </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../workfile/build_workfile.html class=md-nav__link> <span class=md-ellipsis> workfile </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../plugins/actions/open_file_explorer.html class=md-nav__link> <span class=md-ellipsis> plugins </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../resources/index.html class=md-nav__link> <span class=md-ellipsis> resources </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../scripts/ocio_wrapper.html class=md-nav__link> <span class=md-ellipsis> scripts </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../settings/lib.html class=md-nav__link> <span class=md-ellipsis> settings </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../style/color_defs.html class=md-nav__link> <span class=md-ellipsis> style </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../tests/conftest.html class=md-nav__link> <span class=md-ellipsis> tests </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../tools/attribute_defs/_constants.html class=md-nav__link> <span class=md-ellipsis> tools </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../vendor/python/qargparse.html class=md-nav__link> <span class=md-ellipsis> vendor </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../version.html class=md-nav__link> <span class=md-ellipsis> version </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../server/settings/conversion.html class=md-nav__link> <span class=md-ellipsis> server </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions class=md-nav__link> <span class=md-ellipsis> pyblish_functions </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.TimeData class=md-nav__link> <span class=md-ellipsis> TimeData </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.attach_instances_to_product class=md-nav__link> <span class=md-ellipsis> attach_instances_to_product </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.convert_frames_str_to_list class=md-nav__link> <span class=md-ellipsis> convert_frames_str_to_list </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.copy_extend_frames class=md-nav__link> <span class=md-ellipsis> copy_extend_frames </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.create_instances_for_aov class=md-nav__link> <span class=md-ellipsis> create_instances_for_aov </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.create_instances_for_cache class=md-nav__link> <span class=md-ellipsis> create_instances_for_cache </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.create_skeleton_instance class=md-nav__link> <span class=md-ellipsis> create_skeleton_instance </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.create_skeleton_instance_cache class=md-nav__link> <span class=md-ellipsis> create_skeleton_instance_cache </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.extend_frames class=md-nav__link> <span class=md-ellipsis> extend_frames </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.get_product_name_and_group_from_template class=md-nav__link> <span class=md-ellipsis> get_product_name_and_group_from_template </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.get_resources class=md-nav__link> <span class=md-ellipsis> get_resources </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.get_time_data_from_instance_or_context class=md-nav__link> <span class=md-ellipsis> get_time_data_from_instance_or_context </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.get_transferable_representations class=md-nav__link> <span class=md-ellipsis> get_transferable_representations </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.prepare_cache_representations class=md-nav__link> <span class=md-ellipsis> prepare_cache_representations </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.prepare_representations class=md-nav__link> <span class=md-ellipsis> prepare_representations </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.pipeline.farm.pyblish_functions.remap_source class=md-nav__link> <span class=md-ellipsis> remap_source </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>pyblish_functions</h1> <div class="doc doc-object doc-module"> <a id=client.ayon_core.pipeline.farm.pyblish_functions></a> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.TimeData class="doc doc-heading"> <code>TimeData</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=object>object</span></code></p> <p>Structure used to handle time related data.</p> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@attr</span><span class=o>.</span><span class=n>s</span>
<span class=k>class</span><span class=w> </span><span class=nc>TimeData</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Structure used to handle time related data.&quot;&quot;&quot;</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>attr</span><span class=o>.</span><span class=n>ib</span><span class=p>(</span><span class=nb>type</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
    <span class=n>end</span> <span class=o>=</span> <span class=n>attr</span><span class=o>.</span><span class=n>ib</span><span class=p>(</span><span class=nb>type</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
    <span class=n>fps</span> <span class=o>=</span> <span class=n>attr</span><span class=o>.</span><span class=n>ib</span><span class=p>()</span>
    <span class=n>step</span> <span class=o>=</span> <span class=n>attr</span><span class=o>.</span><span class=n>ib</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
    <span class=n>handle_start</span> <span class=o>=</span> <span class=n>attr</span><span class=o>.</span><span class=n>ib</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
    <span class=n>handle_end</span> <span class=o>=</span> <span class=n>attr</span><span class=o>.</span><span class=n>ib</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.attach_instances_to_product class="doc doc-heading"> <code class="highlight language-python"><span class=n>attach_instances_to_product</span><span class=p>(</span><span class=n>attach_to</span><span class=p>,</span> <span class=n>instances</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Attach instance to product.</p> <p>If we are attaching to other products, create copy of existing instances, change data to match its product and replace existing instances with modified data.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>attach_to</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>List of instances to attach to.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>instances</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>List of instances to attach.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>list</code></td> <td> </td> <td> <div class=doc-md-description> <p>List of attached instances.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1378</span>
<span class=normal>1379</span>
<span class=normal>1380</span>
<span class=normal>1381</span>
<span class=normal>1382</span>
<span class=normal>1383</span>
<span class=normal>1384</span>
<span class=normal>1385</span>
<span class=normal>1386</span>
<span class=normal>1387</span>
<span class=normal>1388</span>
<span class=normal>1389</span>
<span class=normal>1390</span>
<span class=normal>1391</span>
<span class=normal>1392</span>
<span class=normal>1393</span>
<span class=normal>1394</span>
<span class=normal>1395</span>
<span class=normal>1396</span>
<span class=normal>1397</span>
<span class=normal>1398</span>
<span class=normal>1399</span>
<span class=normal>1400</span>
<span class=normal>1401</span>
<span class=normal>1402</span>
<span class=normal>1403</span>
<span class=normal>1404</span>
<span class=normal>1405</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>attach_instances_to_product</span><span class=p>(</span><span class=n>attach_to</span><span class=p>,</span> <span class=n>instances</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Attach instance to product.</span>

<span class=sd>    If we are attaching to other products, create copy of existing</span>
<span class=sd>    instances, change data to match its product and replace</span>
<span class=sd>    existing instances with modified data.</span>

<span class=sd>    Args:</span>
<span class=sd>        attach_to (list): List of instances to attach to.</span>
<span class=sd>        instances (list): List of instances to attach.</span>

<span class=sd>    Returns:</span>
<span class=sd>          list: List of attached instances.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>new_instances</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>attach_instance</span> <span class=ow>in</span> <span class=n>attach_to</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>instances</span><span class=p>:</span>
            <span class=n>new_inst</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
            <span class=n>new_inst</span><span class=p>[</span><span class=s2>&quot;version&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>attach_instance</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;version&quot;</span><span class=p>)</span>
            <span class=n>new_inst</span><span class=p>[</span><span class=s2>&quot;productName&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>attach_instance</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;productName&quot;</span><span class=p>)</span>
            <span class=n>new_inst</span><span class=p>[</span><span class=s2>&quot;productType&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>attach_instance</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;productType&quot;</span><span class=p>)</span>
            <span class=n>new_inst</span><span class=p>[</span><span class=s2>&quot;family&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>attach_instance</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;family&quot;</span><span class=p>)</span>
            <span class=n>new_inst</span><span class=p>[</span><span class=s2>&quot;append&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span>
            <span class=c1># don&#39;t set productGroup if we are attaching</span>
            <span class=n>new_inst</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;productGroup&quot;</span><span class=p>)</span>
            <span class=n>new_instances</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>new_inst</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>new_instances</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.convert_frames_str_to_list class="doc doc-heading"> <code class="highlight language-python"><span class=n>convert_frames_str_to_list</span><span class=p>(</span><span class=n>frames</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Convert frames definition string to frames.</p> <details class=handles-formats-as open> <summary>Handles formats as</summary> <blockquote> <blockquote> <blockquote> <p>convert_frames_str_to_list('1001') [1001] convert_frames_str_to_list('1002,1004') [1002, 1004] convert_frames_str_to_list('1003-1005') [1003, 1004, 1005] convert_frames_str_to_list('1001-1021x5') [1001, 1006, 1011, 1016, 1021]</p> </blockquote> </blockquote> </blockquote> </details> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>frames</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>String with frames definition.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=int>int</span>]</code> </td> <td> <div class=doc-md-description> <p>list[int]: List of frames.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>484</span>
<span class=normal>485</span>
<span class=normal>486</span>
<span class=normal>487</span>
<span class=normal>488</span>
<span class=normal>489</span>
<span class=normal>490</span>
<span class=normal>491</span>
<span class=normal>492</span>
<span class=normal>493</span>
<span class=normal>494</span>
<span class=normal>495</span>
<span class=normal>496</span>
<span class=normal>497</span>
<span class=normal>498</span>
<span class=normal>499</span>
<span class=normal>500</span>
<span class=normal>501</span>
<span class=normal>502</span>
<span class=normal>503</span>
<span class=normal>504</span>
<span class=normal>505</span>
<span class=normal>506</span>
<span class=normal>507</span>
<span class=normal>508</span>
<span class=normal>509</span>
<span class=normal>510</span>
<span class=normal>511</span>
<span class=normal>512</span>
<span class=normal>513</span>
<span class=normal>514</span>
<span class=normal>515</span>
<span class=normal>516</span>
<span class=normal>517</span>
<span class=normal>518</span>
<span class=normal>519</span>
<span class=normal>520</span>
<span class=normal>521</span>
<span class=normal>522</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>convert_frames_str_to_list</span><span class=p>(</span><span class=n>frames</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=nb>int</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Convert frames definition string to frames.</span>

<span class=sd>    Handles formats as:</span>
<span class=sd>        &gt;&gt;&gt; convert_frames_str_to_list(&#39;1001&#39;)</span>
<span class=sd>        [1001]</span>
<span class=sd>        &gt;&gt;&gt; convert_frames_str_to_list(&#39;1002,1004&#39;)</span>
<span class=sd>        [1002, 1004]</span>
<span class=sd>        &gt;&gt;&gt; convert_frames_str_to_list(&#39;1003-1005&#39;)</span>
<span class=sd>        [1003, 1004, 1005]</span>
<span class=sd>        &gt;&gt;&gt; convert_frames_str_to_list(&#39;1001-1021x5&#39;)</span>
<span class=sd>        [1001, 1006, 1011, 1016, 1021]</span>

<span class=sd>    Args:</span>
<span class=sd>        frames (str): String with frames definition.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list[int]: List of frames.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>step_pattern</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s2>&quot;(?:step|by|every|x|:)(\d+)$&quot;</span><span class=p>)</span>

    <span class=n>output</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>step</span> <span class=o>=</span> <span class=mi>1</span>
    <span class=k>for</span> <span class=n>frame</span> <span class=ow>in</span> <span class=n>frames</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;,&quot;</span><span class=p>):</span>
        <span class=k>if</span> <span class=s2>&quot;-&quot;</span> <span class=ow>in</span> <span class=n>frame</span><span class=p>:</span>
            <span class=n>frame_start</span><span class=p>,</span> <span class=n>frame_end</span> <span class=o>=</span> <span class=n>frame</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;-&quot;</span><span class=p>)</span>
            <span class=n>match</span> <span class=o>=</span> <span class=n>step_pattern</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=n>frame_end</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>match</span><span class=p>:</span>
                <span class=n>step</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>match</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
                <span class=n>frame_end</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=n>step_pattern</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=n>frame_end</span><span class=p>)</span>

            <span class=n>output</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span>
                <span class=nb>range</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>frame_start</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>frame_end</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>step</span><span class=p>)</span>
            <span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>output</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>frame</span><span class=p>))</span>
    <span class=n>output</span><span class=o>.</span><span class=n>sort</span><span class=p>()</span>
    <span class=k>return</span> <span class=n>output</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.copy_extend_frames class="doc doc-heading"> <code class="highlight language-python"><span class=n>copy_extend_frames</span><span class=p>(</span><span class=n>instance</span><span class=p>,</span> <span class=n>representation</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Copy existing frames from latest version.</p> <p>This will copy all existing frames from product's latest version back to render directory and rename them to what renderer is expecting.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>instance</code> </td> <td> <code><span title=pyblish.plugin.Instance>Instance</span></code> </td> <td> <div class=doc-md-description> <p>instance to get required data from</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>representation</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>presentation to operate on</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1291</span>
<span class=normal>1292</span>
<span class=normal>1293</span>
<span class=normal>1294</span>
<span class=normal>1295</span>
<span class=normal>1296</span>
<span class=normal>1297</span>
<span class=normal>1298</span>
<span class=normal>1299</span>
<span class=normal>1300</span>
<span class=normal>1301</span>
<span class=normal>1302</span>
<span class=normal>1303</span>
<span class=normal>1304</span>
<span class=normal>1305</span>
<span class=normal>1306</span>
<span class=normal>1307</span>
<span class=normal>1308</span>
<span class=normal>1309</span>
<span class=normal>1310</span>
<span class=normal>1311</span>
<span class=normal>1312</span>
<span class=normal>1313</span>
<span class=normal>1314</span>
<span class=normal>1315</span>
<span class=normal>1316</span>
<span class=normal>1317</span>
<span class=normal>1318</span>
<span class=normal>1319</span>
<span class=normal>1320</span>
<span class=normal>1321</span>
<span class=normal>1322</span>
<span class=normal>1323</span>
<span class=normal>1324</span>
<span class=normal>1325</span>
<span class=normal>1326</span>
<span class=normal>1327</span>
<span class=normal>1328</span>
<span class=normal>1329</span>
<span class=normal>1330</span>
<span class=normal>1331</span>
<span class=normal>1332</span>
<span class=normal>1333</span>
<span class=normal>1334</span>
<span class=normal>1335</span>
<span class=normal>1336</span>
<span class=normal>1337</span>
<span class=normal>1338</span>
<span class=normal>1339</span>
<span class=normal>1340</span>
<span class=normal>1341</span>
<span class=normal>1342</span>
<span class=normal>1343</span>
<span class=normal>1344</span>
<span class=normal>1345</span>
<span class=normal>1346</span>
<span class=normal>1347</span>
<span class=normal>1348</span>
<span class=normal>1349</span>
<span class=normal>1350</span>
<span class=normal>1351</span>
<span class=normal>1352</span>
<span class=normal>1353</span>
<span class=normal>1354</span>
<span class=normal>1355</span>
<span class=normal>1356</span>
<span class=normal>1357</span>
<span class=normal>1358</span>
<span class=normal>1359</span>
<span class=normal>1360</span>
<span class=normal>1361</span>
<span class=normal>1362</span>
<span class=normal>1363</span>
<span class=normal>1364</span>
<span class=normal>1365</span>
<span class=normal>1366</span>
<span class=normal>1367</span>
<span class=normal>1368</span>
<span class=normal>1369</span>
<span class=normal>1370</span>
<span class=normal>1371</span>
<span class=normal>1372</span>
<span class=normal>1373</span>
<span class=normal>1374</span>
<span class=normal>1375</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>copy_extend_frames</span><span class=p>(</span><span class=n>instance</span><span class=p>,</span> <span class=n>representation</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Copy existing frames from latest version.</span>

<span class=sd>    This will copy all existing frames from product&#39;s latest version back</span>
<span class=sd>    to render directory and rename them to what renderer is expecting.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        instance (pyblish.plugin.Instance): instance to get required</span>
<span class=sd>            data from</span>
<span class=sd>        representation (dict): presentation to operate on</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=kn>import</span><span class=w> </span><span class=nn>speedcopy</span>

    <span class=n>R_FRAME_NUMBER</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span>
        <span class=sa>r</span><span class=s2>&quot;.+\.(?P&lt;frame&gt;[0-9]+)\..+&quot;</span><span class=p>)</span>

    <span class=n>log</span> <span class=o>=</span> <span class=n>Logger</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=s2>&quot;farm_publishing&quot;</span><span class=p>)</span>
    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Preparing to copy ...&quot;</span><span class=p>)</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;frameStart&quot;</span><span class=p>)</span>
    <span class=n>end</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;frameEnd&quot;</span><span class=p>)</span>
    <span class=n>project_name</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>context</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;project&quot;</span><span class=p>]</span>
    <span class=n>anatomy</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>context</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;anatomy&quot;</span><span class=p>]</span>

    <span class=n>folder_entity</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_folder_by_path</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;folderPath&quot;</span><span class=p>)</span>
    <span class=p>)</span>

    <span class=c1># get latest version of product</span>
    <span class=c1># this will stop if product wasn&#39;t published yet</span>

    <span class=n>version_entity</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_last_version_by_product_name</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;productName&quot;</span><span class=p>),</span>
        <span class=n>folder_entity</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span>
    <span class=p>)</span>

    <span class=c1># get its files based on extension</span>
    <span class=n>product_resources</span> <span class=o>=</span> <span class=n>get_resources</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span> <span class=n>version_entity</span><span class=p>,</span> <span class=n>representation</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;ext&quot;</span><span class=p>)</span>
    <span class=p>)</span>
    <span class=n>r_col</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>clique</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>product_resources</span><span class=p>)</span>

    <span class=c1># if override remove all frames we are expecting to be rendered,</span>
    <span class=c1># so we&#39;ll copy only those missing from current render</span>
    <span class=k>if</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;overrideExistingFrame&quot;</span><span class=p>):</span>
        <span class=k>for</span> <span class=n>frame</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>start</span><span class=p>,</span> <span class=n>end</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
            <span class=k>if</span> <span class=n>frame</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>r_col</span><span class=o>.</span><span class=n>indexes</span><span class=p>:</span>
                <span class=k>continue</span>
            <span class=n>r_col</span><span class=o>.</span><span class=n>indexes</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>frame</span><span class=p>)</span>

    <span class=c1># now we need to translate published names from representation</span>
    <span class=c1># back. This is tricky, right now we&#39;ll just use same naming</span>
    <span class=c1># and only switch frame numbers</span>
    <span class=n>resource_files</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>r_filename</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span>
        <span class=n>representation</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;files&quot;</span><span class=p>)[</span><span class=mi>0</span><span class=p>])</span>  <span class=c1># first file</span>
    <span class=n>op</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>R_FRAME_NUMBER</span><span class=p>,</span> <span class=n>r_filename</span><span class=p>)</span>
    <span class=n>pre</span> <span class=o>=</span> <span class=n>r_filename</span><span class=p>[:</span><span class=n>op</span><span class=o>.</span><span class=n>start</span><span class=p>(</span><span class=s2>&quot;frame&quot;</span><span class=p>)]</span>
    <span class=n>post</span> <span class=o>=</span> <span class=n>r_filename</span><span class=p>[</span><span class=n>op</span><span class=o>.</span><span class=n>end</span><span class=p>(</span><span class=s2>&quot;frame&quot;</span><span class=p>):]</span>
    <span class=k>assert</span> <span class=n>op</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>,</span> <span class=s2>&quot;padding string wasn&#39;t found&quot;</span>
    <span class=k>for</span> <span class=n>frame</span> <span class=ow>in</span> <span class=nb>list</span><span class=p>(</span><span class=n>r_col</span><span class=p>):</span>
        <span class=n>fn</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>R_FRAME_NUMBER</span><span class=p>,</span> <span class=n>frame</span><span class=p>)</span>
        <span class=c1># silencing linter as we need to compare to True, not to</span>
        <span class=c1># type</span>
        <span class=k>assert</span> <span class=n>fn</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>,</span> <span class=s2>&quot;padding string wasn&#39;t found&quot;</span>
        <span class=c1># list of tuples (source, destination)</span>
        <span class=n>staging</span> <span class=o>=</span> <span class=n>representation</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;stagingDir&quot;</span><span class=p>)</span>
        <span class=n>staging</span> <span class=o>=</span> <span class=n>anatomy</span><span class=o>.</span><span class=n>fill_root</span><span class=p>(</span><span class=n>staging</span><span class=p>)</span>
        <span class=n>resource_files</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
            <span class=p>(</span><span class=n>frame</span><span class=p>,</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
                <span class=n>staging</span><span class=p>,</span> <span class=s2>&quot;</span><span class=si>{}{}{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>pre</span><span class=p>,</span> <span class=n>fn</span><span class=p>[</span><span class=s2>&quot;frame&quot;</span><span class=p>],</span> <span class=n>post</span><span class=p>)))</span>
        <span class=p>)</span>

    <span class=c1># test if destination dir exists and create it if not</span>
    <span class=n>output_dir</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>representation</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;files&quot;</span><span class=p>)[</span><span class=mi>0</span><span class=p>])</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isdir</span><span class=p>(</span><span class=n>output_dir</span><span class=p>):</span>
        <span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>output_dir</span><span class=p>)</span>

    <span class=c1># copy files</span>
    <span class=k>for</span> <span class=n>source</span> <span class=ow>in</span> <span class=n>resource_files</span><span class=p>:</span>
        <span class=n>speedcopy</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>source</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>source</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
        <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;  &gt; </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>source</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>

    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Finished copying </span><span class=si>%i</span><span class=s2> files&quot;</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>resource_files</span><span class=p>))</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.create_instances_for_aov class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_instances_for_aov</span><span class=p>(</span><span class=n>instance</span><span class=p>,</span> <span class=n>skeleton</span><span class=p>,</span> <span class=n>aov_filter</span><span class=p>,</span> <span class=n>skip_integration_repre_list</span><span class=p>,</span> <span class=n>do_not_add_review</span><span class=p>,</span> <span class=n>frames_to_render</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Create instances from AOVs.</p> <p>This will create new pyblish.api.Instances by going over expected files defined on original instance.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>instance</code> </td> <td> <code><span title=pyblish.api.Instance>Instance</span></code> </td> <td> <div class=doc-md-description> <p>Original instance.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>skeleton</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Skeleton instance data.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>aov_filter</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>AOV filter.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>skip_integration_repre_list</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>skip</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>do_not_add_review</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Explicitly disable reviews</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>frames_to_render</code> </td> <td> <code><span title=str>str</span> | None</code> </td> <td> <div class=doc-md-description> <p>Frames to render.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>list of pyblish.api.Instance: Instances created from expected files.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>563</span>
<span class=normal>564</span>
<span class=normal>565</span>
<span class=normal>566</span>
<span class=normal>567</span>
<span class=normal>568</span>
<span class=normal>569</span>
<span class=normal>570</span>
<span class=normal>571</span>
<span class=normal>572</span>
<span class=normal>573</span>
<span class=normal>574</span>
<span class=normal>575</span>
<span class=normal>576</span>
<span class=normal>577</span>
<span class=normal>578</span>
<span class=normal>579</span>
<span class=normal>580</span>
<span class=normal>581</span>
<span class=normal>582</span>
<span class=normal>583</span>
<span class=normal>584</span>
<span class=normal>585</span>
<span class=normal>586</span>
<span class=normal>587</span>
<span class=normal>588</span>
<span class=normal>589</span>
<span class=normal>590</span>
<span class=normal>591</span>
<span class=normal>592</span>
<span class=normal>593</span>
<span class=normal>594</span>
<span class=normal>595</span>
<span class=normal>596</span>
<span class=normal>597</span>
<span class=normal>598</span>
<span class=normal>599</span>
<span class=normal>600</span>
<span class=normal>601</span>
<span class=normal>602</span>
<span class=normal>603</span>
<span class=normal>604</span>
<span class=normal>605</span>
<span class=normal>606</span>
<span class=normal>607</span>
<span class=normal>608</span>
<span class=normal>609</span>
<span class=normal>610</span>
<span class=normal>611</span>
<span class=normal>612</span>
<span class=normal>613</span>
<span class=normal>614</span>
<span class=normal>615</span>
<span class=normal>616</span>
<span class=normal>617</span>
<span class=normal>618</span>
<span class=normal>619</span>
<span class=normal>620</span>
<span class=normal>621</span>
<span class=normal>622</span>
<span class=normal>623</span>
<span class=normal>624</span>
<span class=normal>625</span>
<span class=normal>626</span>
<span class=normal>627</span>
<span class=normal>628</span>
<span class=normal>629</span>
<span class=normal>630</span>
<span class=normal>631</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>create_instances_for_aov</span><span class=p>(</span>
    <span class=n>instance</span><span class=p>,</span>
    <span class=n>skeleton</span><span class=p>,</span>
    <span class=n>aov_filter</span><span class=p>,</span>
    <span class=n>skip_integration_repre_list</span><span class=p>,</span>
    <span class=n>do_not_add_review</span><span class=p>,</span>
    <span class=n>frames_to_render</span><span class=o>=</span><span class=kc>None</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Create instances from AOVs.</span>

<span class=sd>    This will create new pyblish.api.Instances by going over expected</span>
<span class=sd>    files defined on original instance.</span>

<span class=sd>    Args:</span>
<span class=sd>        instance (pyblish.api.Instance): Original instance.</span>
<span class=sd>        skeleton (dict): Skeleton instance data.</span>
<span class=sd>        aov_filter (dict): AOV filter.</span>
<span class=sd>        skip_integration_repre_list (list): skip</span>
<span class=sd>        do_not_add_review (bool): Explicitly disable reviews</span>
<span class=sd>        frames_to_render (str | None): Frames to render.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list of pyblish.api.Instance: Instances created from</span>
<span class=sd>            expected files.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># we cannot attach AOVs to other products as we consider every</span>
    <span class=c1># AOV product of its own.</span>

    <span class=n>log</span> <span class=o>=</span> <span class=n>Logger</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=s2>&quot;farm_publishing&quot;</span><span class=p>)</span>
    <span class=n>additional_color_data</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;renderProducts&quot;</span><span class=p>:</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;renderProducts&quot;</span><span class=p>],</span>
        <span class=s2>&quot;colorspaceConfig&quot;</span><span class=p>:</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;colorspaceConfig&quot;</span><span class=p>],</span>
        <span class=s2>&quot;display&quot;</span><span class=p>:</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;colorspaceDisplay&quot;</span><span class=p>],</span>
        <span class=s2>&quot;view&quot;</span><span class=p>:</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;colorspaceView&quot;</span><span class=p>]</span>
    <span class=p>}</span>

    <span class=c1># Get templated path from absolute config path.</span>
    <span class=n>anatomy</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>context</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;anatomy&quot;</span><span class=p>]</span>
    <span class=n>colorspace_template</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;colorspaceConfig&quot;</span><span class=p>]</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>additional_color_data</span><span class=p>[</span><span class=s2>&quot;colorspaceTemplate&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>remap_source</span><span class=p>(</span>
            <span class=n>colorspace_template</span><span class=p>,</span> <span class=n>anatomy</span><span class=p>)</span>
    <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
        <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
        <span class=n>additional_color_data</span><span class=p>[</span><span class=s2>&quot;colorspaceTemplate&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>colorspace_template</span>

    <span class=c1># if there are product to attach to and more than one AOV,</span>
    <span class=c1># we cannot proceed.</span>
    <span class=k>if</span> <span class=p>(</span>
        <span class=nb>len</span><span class=p>(</span><span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;attachTo&quot;</span><span class=p>,</span> <span class=p>[]))</span> <span class=o>&gt;</span> <span class=mi>0</span>
        <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;expectedFiles&quot;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span> <span class=o>!=</span> <span class=mi>1</span>
    <span class=p>):</span>
        <span class=k>raise</span> <span class=n>KnownPublishError</span><span class=p>(</span>
            <span class=s2>&quot;attaching multiple AOVs or renderable cameras to &quot;</span>
            <span class=s2>&quot;product is not supported yet.&quot;</span><span class=p>)</span>

    <span class=c1># create instances for every AOV we found in expected files.</span>
    <span class=c1># NOTE: this is done for every AOV and every render camera (if</span>
    <span class=c1>#       there are multiple renderable cameras in scene)</span>
    <span class=k>return</span> <span class=n>_create_instances_for_aov</span><span class=p>(</span>
        <span class=n>instance</span><span class=p>,</span>
        <span class=n>skeleton</span><span class=p>,</span>
        <span class=n>aov_filter</span><span class=p>,</span>
        <span class=n>additional_color_data</span><span class=p>,</span>
        <span class=n>skip_integration_repre_list</span><span class=p>,</span>
        <span class=n>do_not_add_review</span><span class=p>,</span>
        <span class=n>frames_to_render</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.create_instances_for_cache class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_instances_for_cache</span><span class=p>(</span><span class=n>instance</span><span class=p>,</span> <span class=n>skeleton</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Create instance for cache.</p> <p>This will create new instance for every AOV it can detect in expected files list.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>instance</code> </td> <td> <code><span title=pyblish.api.Instance>Instance</span></code> </td> <td> <div class=doc-md-description> <p>Original instance.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>skeleton</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Skeleton data for instance (those needed) later by collector.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>list of instances</p> </div> </td> </tr> </tbody> </table> <details class=throws open> <summary>Throws</summary> <p>ValueError:</p> </details> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1200</span>
<span class=normal>1201</span>
<span class=normal>1202</span>
<span class=normal>1203</span>
<span class=normal>1204</span>
<span class=normal>1205</span>
<span class=normal>1206</span>
<span class=normal>1207</span>
<span class=normal>1208</span>
<span class=normal>1209</span>
<span class=normal>1210</span>
<span class=normal>1211</span>
<span class=normal>1212</span>
<span class=normal>1213</span>
<span class=normal>1214</span>
<span class=normal>1215</span>
<span class=normal>1216</span>
<span class=normal>1217</span>
<span class=normal>1218</span>
<span class=normal>1219</span>
<span class=normal>1220</span>
<span class=normal>1221</span>
<span class=normal>1222</span>
<span class=normal>1223</span>
<span class=normal>1224</span>
<span class=normal>1225</span>
<span class=normal>1226</span>
<span class=normal>1227</span>
<span class=normal>1228</span>
<span class=normal>1229</span>
<span class=normal>1230</span>
<span class=normal>1231</span>
<span class=normal>1232</span>
<span class=normal>1233</span>
<span class=normal>1234</span>
<span class=normal>1235</span>
<span class=normal>1236</span>
<span class=normal>1237</span>
<span class=normal>1238</span>
<span class=normal>1239</span>
<span class=normal>1240</span>
<span class=normal>1241</span>
<span class=normal>1242</span>
<span class=normal>1243</span>
<span class=normal>1244</span>
<span class=normal>1245</span>
<span class=normal>1246</span>
<span class=normal>1247</span>
<span class=normal>1248</span>
<span class=normal>1249</span>
<span class=normal>1250</span>
<span class=normal>1251</span>
<span class=normal>1252</span>
<span class=normal>1253</span>
<span class=normal>1254</span>
<span class=normal>1255</span>
<span class=normal>1256</span>
<span class=normal>1257</span>
<span class=normal>1258</span>
<span class=normal>1259</span>
<span class=normal>1260</span>
<span class=normal>1261</span>
<span class=normal>1262</span>
<span class=normal>1263</span>
<span class=normal>1264</span>
<span class=normal>1265</span>
<span class=normal>1266</span>
<span class=normal>1267</span>
<span class=normal>1268</span>
<span class=normal>1269</span>
<span class=normal>1270</span>
<span class=normal>1271</span>
<span class=normal>1272</span>
<span class=normal>1273</span>
<span class=normal>1274</span>
<span class=normal>1275</span>
<span class=normal>1276</span>
<span class=normal>1277</span>
<span class=normal>1278</span>
<span class=normal>1279</span>
<span class=normal>1280</span>
<span class=normal>1281</span>
<span class=normal>1282</span>
<span class=normal>1283</span>
<span class=normal>1284</span>
<span class=normal>1285</span>
<span class=normal>1286</span>
<span class=normal>1287</span>
<span class=normal>1288</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>create_instances_for_cache</span><span class=p>(</span><span class=n>instance</span><span class=p>,</span> <span class=n>skeleton</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Create instance for cache.</span>

<span class=sd>    This will create new instance for every AOV it can detect in expected</span>
<span class=sd>    files list.</span>

<span class=sd>    Args:</span>
<span class=sd>        instance (pyblish.api.Instance): Original instance.</span>
<span class=sd>        skeleton (dict): Skeleton data for instance (those needed) later</span>
<span class=sd>            by collector.</span>


<span class=sd>    Returns:</span>
<span class=sd>        list of instances</span>

<span class=sd>    Throws:</span>
<span class=sd>        ValueError:</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>anatomy</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>context</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;anatomy&quot;</span><span class=p>]</span>
    <span class=n>product_name</span> <span class=o>=</span> <span class=n>skeleton</span><span class=p>[</span><span class=s2>&quot;productName&quot;</span><span class=p>]</span>
    <span class=n>product_type</span> <span class=o>=</span> <span class=n>skeleton</span><span class=p>[</span><span class=s2>&quot;productType&quot;</span><span class=p>]</span>
    <span class=n>exp_files</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;expectedFiles&quot;</span><span class=p>]</span>
    <span class=n>log</span> <span class=o>=</span> <span class=n>Logger</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=s2>&quot;farm_publishing&quot;</span><span class=p>)</span>

    <span class=n>instances</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=c1># go through AOVs in expected files</span>
    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>files</span> <span class=ow>in</span> <span class=n>exp_files</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>cols</span><span class=p>,</span> <span class=n>rem</span> <span class=o>=</span> <span class=n>clique</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>files</span><span class=p>)</span>
        <span class=c1># we shouldn&#39;t have any reminders. And if we do, it should</span>
        <span class=c1># be just one item for single frame renders.</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>cols</span> <span class=ow>and</span> <span class=n>rem</span><span class=p>:</span>
            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>rem</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Found multiple non related files &quot;</span>
                                 <span class=s2>&quot;to render, don&#39;t know what to do &quot;</span>
                                 <span class=s2>&quot;with them.&quot;</span><span class=p>)</span>
            <span class=n>col</span> <span class=o>=</span> <span class=n>rem</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
            <span class=n>ext</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>splitext</span><span class=p>(</span><span class=n>col</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>lstrip</span><span class=p>(</span><span class=s2>&quot;.&quot;</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=c1># but we really expect only one collection.</span>
            <span class=c1># Nothing else make sense.</span>
            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>cols</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Only one image sequence type is expected.&quot;</span><span class=p>)</span>  <span class=c1># noqa: E501</span>
            <span class=n>ext</span> <span class=o>=</span> <span class=n>cols</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>tail</span><span class=o>.</span><span class=n>lstrip</span><span class=p>(</span><span class=s2>&quot;.&quot;</span><span class=p>)</span>
            <span class=n>col</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>cols</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>

        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>col</span><span class=p>,</span> <span class=p>(</span><span class=nb>list</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>)):</span>
            <span class=n>staging</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>col</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>staging</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>col</span><span class=p>)</span>

        <span class=k>try</span><span class=p>:</span>
            <span class=n>staging</span> <span class=o>=</span> <span class=n>remap_source</span><span class=p>(</span><span class=n>staging</span><span class=p>,</span> <span class=n>anatomy</span><span class=p>)</span>
        <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>

        <span class=n>new_instance</span> <span class=o>=</span> <span class=n>deepcopy</span><span class=p>(</span><span class=n>skeleton</span><span class=p>)</span>

        <span class=n>new_instance</span><span class=p>[</span><span class=s2>&quot;productName&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>product_name</span>
        <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Creating data for: </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>product_name</span><span class=p>))</span>
        <span class=n>new_instance</span><span class=p>[</span><span class=s2>&quot;productType&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>product_type</span>
        <span class=n>new_instance</span><span class=p>[</span><span class=s2>&quot;families&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>skeleton</span><span class=p>[</span><span class=s2>&quot;families&quot;</span><span class=p>]</span>
        <span class=c1># create representation</span>
        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>col</span><span class=p>,</span> <span class=p>(</span><span class=nb>list</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>)):</span>
            <span class=n>files</span> <span class=o>=</span> <span class=p>[</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>f</span><span class=p>)</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>col</span><span class=p>]</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>files</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>col</span><span class=p>)</span>

        <span class=n>rep</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>ext</span><span class=p>,</span>
            <span class=s2>&quot;ext&quot;</span><span class=p>:</span> <span class=n>ext</span><span class=p>,</span>
            <span class=s2>&quot;files&quot;</span><span class=p>:</span> <span class=n>files</span><span class=p>,</span>
            <span class=s2>&quot;frameStart&quot;</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>skeleton</span><span class=p>[</span><span class=s2>&quot;frameStartHandle&quot;</span><span class=p>]),</span>
            <span class=s2>&quot;frameEnd&quot;</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>skeleton</span><span class=p>[</span><span class=s2>&quot;frameEndHandle&quot;</span><span class=p>]),</span>
            <span class=c1># If expectedFile are absolute, we need only filenames</span>
            <span class=s2>&quot;stagingDir&quot;</span><span class=p>:</span> <span class=n>staging</span><span class=p>,</span>
            <span class=s2>&quot;fps&quot;</span><span class=p>:</span> <span class=n>new_instance</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;fps&quot;</span><span class=p>),</span>
            <span class=s2>&quot;tags&quot;</span><span class=p>:</span> <span class=p>[],</span>
        <span class=p>}</span>

        <span class=n>new_instance</span><span class=p>[</span><span class=s2>&quot;representations&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>rep</span><span class=p>]</span>

        <span class=c1># if extending frames from existing version, copy files from there</span>
        <span class=c1># into our destination directory</span>
        <span class=k>if</span> <span class=n>new_instance</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;extendFrames&quot;</span><span class=p>,</span> <span class=kc>False</span><span class=p>):</span>
            <span class=n>copy_extend_frames</span><span class=p>(</span><span class=n>new_instance</span><span class=p>,</span> <span class=n>rep</span><span class=p>)</span>
        <span class=n>instances</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>new_instance</span><span class=p>)</span>
        <span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&quot;instances:</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>instances</span><span class=p>))</span>
    <span class=k>return</span> <span class=n>instances</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.create_skeleton_instance class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_skeleton_instance</span><span class=p>(</span><span class=n>instance</span><span class=p>,</span> <span class=n>families_transfer</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>instance_transfer</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Create skeleton instance from original instance data.</p> <p>This will create dictionary containing skeleton - common - data used for publishing rendered instances. This skeleton instance is then extended with additional data and serialized to be processed by farm job.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>instance</code> </td> <td> <code><span title=pyblish.api.Instance>Instance</span></code> </td> <td> <div class=doc-md-description> <p>Original instance to be used as a source of data.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>families_transfer</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>List of family names to transfer from the original instance to the skeleton.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>instance_transfer</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Dict with keys as families and values as a list of property names to transfer to the new skeleton.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> </td> <td> <div class=doc-md-description> <p>Dictionary with skeleton instance data.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>166</span>
<span class=normal>167</span>
<span class=normal>168</span>
<span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span>
<span class=normal>172</span>
<span class=normal>173</span>
<span class=normal>174</span>
<span class=normal>175</span>
<span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span>
<span class=normal>200</span>
<span class=normal>201</span>
<span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span>
<span class=normal>242</span>
<span class=normal>243</span>
<span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>create_skeleton_instance</span><span class=p>(</span>
        <span class=n>instance</span><span class=p>,</span> <span class=n>families_transfer</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>instance_transfer</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Create skeleton instance from original instance data.</span>

<span class=sd>    This will create dictionary containing skeleton</span>
<span class=sd>    - common - data used for publishing rendered instances.</span>
<span class=sd>    This skeleton instance is then extended with additional data</span>
<span class=sd>    and serialized to be processed by farm job.</span>

<span class=sd>    Args:</span>
<span class=sd>        instance (pyblish.api.Instance): Original instance to</span>
<span class=sd>            be used as a source of data.</span>
<span class=sd>        families_transfer (list): List of family names to transfer</span>
<span class=sd>            from the original instance to the skeleton.</span>
<span class=sd>        instance_transfer (dict): Dict with keys as families and</span>
<span class=sd>            values as a list of property names to transfer to the</span>
<span class=sd>            new skeleton.</span>

<span class=sd>    Returns:</span>
<span class=sd>        dict: Dictionary with skeleton instance data.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># list of family names to transfer to new family if present</span>

    <span class=n>context</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>context</span>
    <span class=n>data</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>anatomy</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>context</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;anatomy&quot;</span><span class=p>]</span>

    <span class=c1># get time related data from instance (or context)</span>
    <span class=n>time_data</span> <span class=o>=</span> <span class=n>get_time_data_from_instance_or_context</span><span class=p>(</span><span class=n>instance</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;extendFrames&quot;</span><span class=p>,</span> <span class=kc>False</span><span class=p>):</span>
        <span class=n>time_data</span><span class=o>.</span><span class=n>start</span><span class=p>,</span> <span class=n>time_data</span><span class=o>.</span><span class=n>end</span> <span class=o>=</span> <span class=n>extend_frames</span><span class=p>(</span>
            <span class=n>data</span><span class=p>[</span><span class=s2>&quot;folderPath&quot;</span><span class=p>],</span>
            <span class=n>data</span><span class=p>[</span><span class=s2>&quot;productName&quot;</span><span class=p>],</span>
            <span class=n>time_data</span><span class=o>.</span><span class=n>start</span><span class=p>,</span>
            <span class=n>time_data</span><span class=o>.</span><span class=n>end</span><span class=p>,</span>
        <span class=p>)</span>

    <span class=n>source</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;source&quot;</span><span class=p>)</span> <span class=ow>or</span> <span class=n>context</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;currentFile&quot;</span><span class=p>)</span>
    <span class=n>success</span><span class=p>,</span> <span class=n>rootless_path</span> <span class=o>=</span> <span class=p>(</span>
        <span class=n>anatomy</span><span class=o>.</span><span class=n>find_root_template_from_path</span><span class=p>(</span><span class=n>source</span><span class=p>)</span>
    <span class=p>)</span>
    <span class=k>if</span> <span class=n>success</span><span class=p>:</span>
        <span class=n>source</span> <span class=o>=</span> <span class=n>rootless_path</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=c1># `rootless_path` is not set to `source` if none of roots match</span>
        <span class=n>log</span> <span class=o>=</span> <span class=n>Logger</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=s2>&quot;farm_publishing&quot;</span><span class=p>)</span>
        <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>((</span><span class=s2>&quot;Could not find root path for remapping </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>. &quot;</span>
                     <span class=s2>&quot;This may cause issues.&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>source</span><span class=p>))</span>

    <span class=n>product_type</span> <span class=o>=</span> <span class=p>(</span><span class=s2>&quot;render&quot;</span>
              <span class=k>if</span> <span class=s2>&quot;prerender.farm&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;families&quot;</span><span class=p>]</span>
              <span class=k>else</span> <span class=s2>&quot;prerender&quot;</span><span class=p>)</span>
    <span class=n>families</span> <span class=o>=</span> <span class=p>[</span><span class=n>product_type</span><span class=p>]</span>

    <span class=c1># pass review to families if marked as review</span>
    <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;review&quot;</span><span class=p>):</span>
        <span class=n>families</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;review&quot;</span><span class=p>)</span>

    <span class=n>instance_skeleton_data</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;productType&quot;</span><span class=p>:</span> <span class=n>product_type</span><span class=p>,</span>
        <span class=s2>&quot;productName&quot;</span><span class=p>:</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;productName&quot;</span><span class=p>],</span>
        <span class=s2>&quot;task&quot;</span><span class=p>:</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;task&quot;</span><span class=p>],</span>
        <span class=s2>&quot;families&quot;</span><span class=p>:</span> <span class=n>families</span><span class=p>,</span>
        <span class=s2>&quot;folderPath&quot;</span><span class=p>:</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;folderPath&quot;</span><span class=p>],</span>
        <span class=s2>&quot;frameStart&quot;</span><span class=p>:</span> <span class=n>time_data</span><span class=o>.</span><span class=n>start</span><span class=p>,</span>
        <span class=s2>&quot;frameEnd&quot;</span><span class=p>:</span> <span class=n>time_data</span><span class=o>.</span><span class=n>end</span><span class=p>,</span>
        <span class=s2>&quot;handleStart&quot;</span><span class=p>:</span> <span class=n>time_data</span><span class=o>.</span><span class=n>handle_start</span><span class=p>,</span>
        <span class=s2>&quot;handleEnd&quot;</span><span class=p>:</span> <span class=n>time_data</span><span class=o>.</span><span class=n>handle_end</span><span class=p>,</span>
        <span class=s2>&quot;frameStartHandle&quot;</span><span class=p>:</span> <span class=n>time_data</span><span class=o>.</span><span class=n>start</span> <span class=o>-</span> <span class=n>time_data</span><span class=o>.</span><span class=n>handle_start</span><span class=p>,</span>
        <span class=s2>&quot;frameEndHandle&quot;</span><span class=p>:</span> <span class=n>time_data</span><span class=o>.</span><span class=n>end</span> <span class=o>+</span> <span class=n>time_data</span><span class=o>.</span><span class=n>handle_end</span><span class=p>,</span>
        <span class=s2>&quot;comment&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;comment&quot;</span><span class=p>),</span>
        <span class=s2>&quot;fps&quot;</span><span class=p>:</span> <span class=n>time_data</span><span class=o>.</span><span class=n>fps</span><span class=p>,</span>
        <span class=s2>&quot;source&quot;</span><span class=p>:</span> <span class=n>source</span><span class=p>,</span>
        <span class=s2>&quot;extendFrames&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;extendFrames&quot;</span><span class=p>),</span>
        <span class=s2>&quot;overrideExistingFrame&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;overrideExistingFrame&quot;</span><span class=p>),</span>
        <span class=s2>&quot;pixelAspect&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;pixelAspect&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span>
        <span class=s2>&quot;resolutionWidth&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;resolutionWidth&quot;</span><span class=p>,</span> <span class=mi>1920</span><span class=p>),</span>
        <span class=s2>&quot;resolutionHeight&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;resolutionHeight&quot;</span><span class=p>,</span> <span class=mi>1080</span><span class=p>),</span>
        <span class=s2>&quot;multipartExr&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;multipartExr&quot;</span><span class=p>,</span> <span class=kc>False</span><span class=p>),</span>
        <span class=s2>&quot;jobBatchName&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;jobBatchName&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>),</span>
        <span class=s2>&quot;useSequenceForReview&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;useSequenceForReview&quot;</span><span class=p>,</span> <span class=kc>True</span><span class=p>),</span>
        <span class=c1># map inputVersions `ObjectId` -&gt; `str` so json supports it</span>
        <span class=s2>&quot;inputVersions&quot;</span><span class=p>:</span> <span class=nb>list</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;inputVersions&quot;</span><span class=p>,</span> <span class=p>[]))),</span>
        <span class=s2>&quot;colorspace&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;colorspace&quot;</span><span class=p>),</span>
        <span class=s2>&quot;hasExplicitFrames&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;hasExplicitFrames&quot;</span><span class=p>)</span>
    <span class=p>}</span>

    <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;renderlayer&quot;</span><span class=p>):</span>
        <span class=n>instance_skeleton_data</span><span class=p>[</span><span class=s2>&quot;renderlayer&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;renderlayer&quot;</span><span class=p>]</span>

    <span class=c1># skip locking version if we are creating v01</span>
    <span class=n>instance_version</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;version&quot;</span><span class=p>)</span>  <span class=c1># take this if exists</span>
    <span class=k>if</span> <span class=n>instance_version</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>instance_skeleton_data</span><span class=p>[</span><span class=s2>&quot;version&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>instance_version</span>

    <span class=c1># transfer specific families from original instance to new render</span>
    <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>families_transfer</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;families&quot;</span><span class=p>,</span> <span class=p>[]):</span>
            <span class=n>instance_skeleton_data</span><span class=p>[</span><span class=s2>&quot;families&quot;</span><span class=p>]</span> <span class=o>+=</span> <span class=p>[</span><span class=n>item</span><span class=p>]</span>

    <span class=c1># transfer specific properties from original instance based on</span>
    <span class=c1># mapping dictionary `instance_transfer`</span>
    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>values</span> <span class=ow>in</span> <span class=n>instance_transfer</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=k>if</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;families&quot;</span><span class=p>,</span> <span class=p>[]):</span>
            <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>values</span><span class=p>:</span>
                <span class=n>instance_skeleton_data</span><span class=p>[</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>v</span><span class=p>)</span>

    <span class=n>representations</span> <span class=o>=</span> <span class=n>get_transferable_representations</span><span class=p>(</span><span class=n>instance</span><span class=p>)</span>
    <span class=n>instance_skeleton_data</span><span class=p>[</span><span class=s2>&quot;representations&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>representations</span>

    <span class=n>persistent</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;stagingDir_persistent&quot;</span><span class=p>)</span> <span class=ow>is</span> <span class=kc>True</span>
    <span class=n>instance_skeleton_data</span><span class=p>[</span><span class=s2>&quot;stagingDir_persistent&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>persistent</span>

    <span class=k>return</span> <span class=n>instance_skeleton_data</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.create_skeleton_instance_cache class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_skeleton_instance_cache</span><span class=p>(</span><span class=n>instance</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Create skeleton instance from original instance data.</p> <p>This will create dictionary containing skeleton - common - data used for publishing rendered instances. This skeleton instance is then extended with additional data and serialized to be processed by farm job.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>instance</code> </td> <td> <code><span title=pyblish.api.Instance>Instance</span></code> </td> <td> <div class=doc-md-description> <p>Original instance to be used as a source of data.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> </td> <td> <div class=doc-md-description> <p>Dictionary with skeleton instance data.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1059</span>
<span class=normal>1060</span>
<span class=normal>1061</span>
<span class=normal>1062</span>
<span class=normal>1063</span>
<span class=normal>1064</span>
<span class=normal>1065</span>
<span class=normal>1066</span>
<span class=normal>1067</span>
<span class=normal>1068</span>
<span class=normal>1069</span>
<span class=normal>1070</span>
<span class=normal>1071</span>
<span class=normal>1072</span>
<span class=normal>1073</span>
<span class=normal>1074</span>
<span class=normal>1075</span>
<span class=normal>1076</span>
<span class=normal>1077</span>
<span class=normal>1078</span>
<span class=normal>1079</span>
<span class=normal>1080</span>
<span class=normal>1081</span>
<span class=normal>1082</span>
<span class=normal>1083</span>
<span class=normal>1084</span>
<span class=normal>1085</span>
<span class=normal>1086</span>
<span class=normal>1087</span>
<span class=normal>1088</span>
<span class=normal>1089</span>
<span class=normal>1090</span>
<span class=normal>1091</span>
<span class=normal>1092</span>
<span class=normal>1093</span>
<span class=normal>1094</span>
<span class=normal>1095</span>
<span class=normal>1096</span>
<span class=normal>1097</span>
<span class=normal>1098</span>
<span class=normal>1099</span>
<span class=normal>1100</span>
<span class=normal>1101</span>
<span class=normal>1102</span>
<span class=normal>1103</span>
<span class=normal>1104</span>
<span class=normal>1105</span>
<span class=normal>1106</span>
<span class=normal>1107</span>
<span class=normal>1108</span>
<span class=normal>1109</span>
<span class=normal>1110</span>
<span class=normal>1111</span>
<span class=normal>1112</span>
<span class=normal>1113</span>
<span class=normal>1114</span>
<span class=normal>1115</span>
<span class=normal>1116</span>
<span class=normal>1117</span>
<span class=normal>1118</span>
<span class=normal>1119</span>
<span class=normal>1120</span>
<span class=normal>1121</span>
<span class=normal>1122</span>
<span class=normal>1123</span>
<span class=normal>1124</span>
<span class=normal>1125</span>
<span class=normal>1126</span>
<span class=normal>1127</span>
<span class=normal>1128</span>
<span class=normal>1129</span>
<span class=normal>1130</span>
<span class=normal>1131</span>
<span class=normal>1132</span>
<span class=normal>1133</span>
<span class=normal>1134</span>
<span class=normal>1135</span>
<span class=normal>1136</span>
<span class=normal>1137</span>
<span class=normal>1138</span>
<span class=normal>1139</span>
<span class=normal>1140</span>
<span class=normal>1141</span>
<span class=normal>1142</span>
<span class=normal>1143</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>create_skeleton_instance_cache</span><span class=p>(</span><span class=n>instance</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Create skeleton instance from original instance data.</span>

<span class=sd>    This will create dictionary containing skeleton</span>
<span class=sd>    - common - data used for publishing rendered instances.</span>
<span class=sd>    This skeleton instance is then extended with additional data</span>
<span class=sd>    and serialized to be processed by farm job.</span>

<span class=sd>    Args:</span>
<span class=sd>        instance (pyblish.api.Instance): Original instance to</span>
<span class=sd>            be used as a source of data.</span>

<span class=sd>    Returns:</span>
<span class=sd>        dict: Dictionary with skeleton instance data.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># list of family names to transfer to new family if present</span>

    <span class=n>context</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>context</span>
    <span class=n>data</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>anatomy</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>context</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;anatomy&quot;</span><span class=p>]</span>

    <span class=c1># get time related data from instance (or context)</span>
    <span class=n>time_data</span> <span class=o>=</span> <span class=n>get_time_data_from_instance_or_context</span><span class=p>(</span><span class=n>instance</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;extendFrames&quot;</span><span class=p>,</span> <span class=kc>False</span><span class=p>):</span>
        <span class=n>time_data</span><span class=o>.</span><span class=n>start</span><span class=p>,</span> <span class=n>time_data</span><span class=o>.</span><span class=n>end</span> <span class=o>=</span> <span class=n>extend_frames</span><span class=p>(</span>
            <span class=n>data</span><span class=p>[</span><span class=s2>&quot;folderPath&quot;</span><span class=p>],</span>
            <span class=n>data</span><span class=p>[</span><span class=s2>&quot;productName&quot;</span><span class=p>],</span>
            <span class=n>time_data</span><span class=o>.</span><span class=n>start</span><span class=p>,</span>
            <span class=n>time_data</span><span class=o>.</span><span class=n>end</span><span class=p>,</span>
        <span class=p>)</span>

    <span class=n>source</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;source&quot;</span><span class=p>)</span> <span class=ow>or</span> <span class=n>context</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;currentFile&quot;</span><span class=p>)</span>
    <span class=n>success</span><span class=p>,</span> <span class=n>rootless_path</span> <span class=o>=</span> <span class=p>(</span>
        <span class=n>anatomy</span><span class=o>.</span><span class=n>find_root_template_from_path</span><span class=p>(</span><span class=n>source</span><span class=p>)</span>
    <span class=p>)</span>
    <span class=k>if</span> <span class=n>success</span><span class=p>:</span>
        <span class=n>source</span> <span class=o>=</span> <span class=n>rootless_path</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=c1># `rootless_path` is not set to `source` if none of roots match</span>
        <span class=n>log</span> <span class=o>=</span> <span class=n>Logger</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=s2>&quot;farm_publishing&quot;</span><span class=p>)</span>
        <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>((</span><span class=s2>&quot;Could not find root path for remapping </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>. &quot;</span>
                     <span class=s2>&quot;This may cause issues.&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>source</span><span class=p>))</span>

    <span class=n>product_type</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;productType&quot;</span><span class=p>]</span>
    <span class=c1># Make sure &quot;render&quot; is in the families to go through</span>
    <span class=c1># validating expected and rendered files</span>
    <span class=c1># during publishing job.</span>
    <span class=n>families</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;render&quot;</span><span class=p>,</span> <span class=n>product_type</span><span class=p>]</span>

    <span class=n>instance_skeleton_data</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;productName&quot;</span><span class=p>:</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;productName&quot;</span><span class=p>],</span>
        <span class=s2>&quot;productType&quot;</span><span class=p>:</span> <span class=n>product_type</span><span class=p>,</span>
        <span class=s2>&quot;family&quot;</span><span class=p>:</span> <span class=n>product_type</span><span class=p>,</span>
        <span class=s2>&quot;families&quot;</span><span class=p>:</span> <span class=n>families</span><span class=p>,</span>
        <span class=s2>&quot;folderPath&quot;</span><span class=p>:</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;folderPath&quot;</span><span class=p>],</span>
        <span class=s2>&quot;frameStart&quot;</span><span class=p>:</span> <span class=n>time_data</span><span class=o>.</span><span class=n>start</span><span class=p>,</span>
        <span class=s2>&quot;frameEnd&quot;</span><span class=p>:</span> <span class=n>time_data</span><span class=o>.</span><span class=n>end</span><span class=p>,</span>
        <span class=s2>&quot;handleStart&quot;</span><span class=p>:</span> <span class=n>time_data</span><span class=o>.</span><span class=n>handle_start</span><span class=p>,</span>
        <span class=s2>&quot;handleEnd&quot;</span><span class=p>:</span> <span class=n>time_data</span><span class=o>.</span><span class=n>handle_end</span><span class=p>,</span>
        <span class=s2>&quot;frameStartHandle&quot;</span><span class=p>:</span> <span class=n>time_data</span><span class=o>.</span><span class=n>start</span> <span class=o>-</span> <span class=n>time_data</span><span class=o>.</span><span class=n>handle_start</span><span class=p>,</span>
        <span class=s2>&quot;frameEndHandle&quot;</span><span class=p>:</span> <span class=n>time_data</span><span class=o>.</span><span class=n>end</span> <span class=o>+</span> <span class=n>time_data</span><span class=o>.</span><span class=n>handle_end</span><span class=p>,</span>
        <span class=s2>&quot;comment&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;comment&quot;</span><span class=p>),</span>
        <span class=s2>&quot;fps&quot;</span><span class=p>:</span> <span class=n>time_data</span><span class=o>.</span><span class=n>fps</span><span class=p>,</span>
        <span class=s2>&quot;source&quot;</span><span class=p>:</span> <span class=n>source</span><span class=p>,</span>
        <span class=s2>&quot;extendFrames&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;extendFrames&quot;</span><span class=p>),</span>
        <span class=s2>&quot;overrideExistingFrame&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;overrideExistingFrame&quot;</span><span class=p>),</span>
        <span class=s2>&quot;jobBatchName&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;jobBatchName&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>),</span>
        <span class=c1># map inputVersions `ObjectId` -&gt; `str` so json supports it</span>
        <span class=s2>&quot;inputVersions&quot;</span><span class=p>:</span> <span class=nb>list</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;inputVersions&quot;</span><span class=p>,</span> <span class=p>[]))),</span>
    <span class=p>}</span>

    <span class=c1># skip locking version if we are creating v01</span>
    <span class=n>instance_version</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;version&quot;</span><span class=p>)</span>  <span class=c1># take this if exists</span>
    <span class=k>if</span> <span class=n>instance_version</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>instance_skeleton_data</span><span class=p>[</span><span class=s2>&quot;version&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>instance_version</span>

    <span class=n>representations</span> <span class=o>=</span> <span class=n>get_transferable_representations</span><span class=p>(</span><span class=n>instance</span><span class=p>)</span>
    <span class=n>instance_skeleton_data</span><span class=p>[</span><span class=s2>&quot;representations&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>representations</span>

    <span class=n>persistent</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;stagingDir_persistent&quot;</span><span class=p>)</span> <span class=ow>is</span> <span class=kc>True</span>
    <span class=n>instance_skeleton_data</span><span class=p>[</span><span class=s2>&quot;stagingDir_persistent&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>persistent</span>

    <span class=k>return</span> <span class=n>instance_skeleton_data</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.extend_frames class="doc doc-heading"> <code class="highlight language-python"><span class=n>extend_frames</span><span class=p>(</span><span class=n>folder_path</span><span class=p>,</span> <span class=n>product_name</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>end</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get latest version of asset nad update frame range.</p> <p>Based on minimum and maximum values.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>folder_path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Folder path.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>product_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Product name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>start</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Start frame.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>end</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>End frame.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>(<span title=int>int</span>, <span title=int>int</span>)</code> </td> <td> <div class=doc-md-description> <p>update frame start/end</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span>
<span class=normal>63</span>
<span class=normal>64</span>
<span class=normal>65</span>
<span class=normal>66</span>
<span class=normal>67</span>
<span class=normal>68</span>
<span class=normal>69</span>
<span class=normal>70</span>
<span class=normal>71</span>
<span class=normal>72</span>
<span class=normal>73</span>
<span class=normal>74</span>
<span class=normal>75</span>
<span class=normal>76</span>
<span class=normal>77</span>
<span class=normal>78</span>
<span class=normal>79</span>
<span class=normal>80</span>
<span class=normal>81</span>
<span class=normal>82</span>
<span class=normal>83</span>
<span class=normal>84</span>
<span class=normal>85</span>
<span class=normal>86</span>
<span class=normal>87</span>
<span class=normal>88</span>
<span class=normal>89</span>
<span class=normal>90</span>
<span class=normal>91</span>
<span class=normal>92</span>
<span class=normal>93</span>
<span class=normal>94</span>
<span class=normal>95</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>extend_frames</span><span class=p>(</span><span class=n>folder_path</span><span class=p>,</span> <span class=n>product_name</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>end</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get latest version of asset nad update frame range.</span>

<span class=sd>    Based on minimum and maximum values.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        folder_path (str): Folder path.</span>
<span class=sd>        product_name (str): Product name.</span>
<span class=sd>        start (int): Start frame.</span>
<span class=sd>        end (int): End frame.</span>

<span class=sd>    Returns:</span>
<span class=sd>        (int, int): update frame start/end</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># Frame comparison</span>
    <span class=n>prev_start</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=n>prev_end</span> <span class=o>=</span> <span class=kc>None</span>

    <span class=n>project_name</span> <span class=o>=</span> <span class=n>get_current_project_name</span><span class=p>()</span>
    <span class=n>folder_entity</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_folder_by_path</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span> <span class=n>folder_path</span><span class=p>,</span> <span class=n>fields</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;id&quot;</span><span class=p>}</span>
    <span class=p>)</span>
    <span class=n>version_entity</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_last_version_by_product_name</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>product_name</span><span class=p>,</span>
        <span class=n>folder_entity</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span>
    <span class=p>)</span>

    <span class=c1># Set prev start / end frames for comparison</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>prev_start</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>prev_end</span><span class=p>:</span>
        <span class=n>prev_start</span> <span class=o>=</span> <span class=n>version_entity</span><span class=p>[</span><span class=s2>&quot;attrib&quot;</span><span class=p>][</span><span class=s2>&quot;frameStart&quot;</span><span class=p>]</span>
        <span class=n>prev_end</span> <span class=o>=</span> <span class=n>version_entity</span><span class=p>[</span><span class=s2>&quot;attrib&quot;</span><span class=p>][</span><span class=s2>&quot;frameEnd&quot;</span><span class=p>]</span>

    <span class=n>updated_start</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=n>start</span><span class=p>,</span> <span class=n>prev_start</span><span class=p>)</span>
    <span class=n>updated_end</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>end</span><span class=p>,</span> <span class=n>prev_end</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>updated_start</span><span class=p>,</span> <span class=n>updated_end</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.get_product_name_and_group_from_template class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_product_name_and_group_from_template</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>task_entity</span><span class=p>,</span> <span class=n>product_type</span><span class=p>,</span> <span class=n>variant</span><span class=p>,</span> <span class=n>host_name</span><span class=p>,</span> <span class=n>dynamic_data</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get product name and group name from template.</p> <p>This will get product name and group name from template based on data provided. It is doing similar work as <code>func::_get_legacy_product_name_and_group</code> but using templates.</p> <p>To get group name, template is called without any dynamic data, so (depending on the template itself) it should be product name without aov.</p> <details class=todo open> <summary>Todo</summary> <p>Maybe we should introduce templates for the groups themselves.</p> </details> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>task_entity</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Task entity.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Project name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>host_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Host name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>product_type</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Product type.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>variant</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Variant.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>dynamic_data</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Dynamic data (aov, renderlayer, camera, ...).</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>tuple</code></td> <td> </td> <td> <div class=doc-md-description> <p>product name and group name.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>693</span>
<span class=normal>694</span>
<span class=normal>695</span>
<span class=normal>696</span>
<span class=normal>697</span>
<span class=normal>698</span>
<span class=normal>699</span>
<span class=normal>700</span>
<span class=normal>701</span>
<span class=normal>702</span>
<span class=normal>703</span>
<span class=normal>704</span>
<span class=normal>705</span>
<span class=normal>706</span>
<span class=normal>707</span>
<span class=normal>708</span>
<span class=normal>709</span>
<span class=normal>710</span>
<span class=normal>711</span>
<span class=normal>712</span>
<span class=normal>713</span>
<span class=normal>714</span>
<span class=normal>715</span>
<span class=normal>716</span>
<span class=normal>717</span>
<span class=normal>718</span>
<span class=normal>719</span>
<span class=normal>720</span>
<span class=normal>721</span>
<span class=normal>722</span>
<span class=normal>723</span>
<span class=normal>724</span>
<span class=normal>725</span>
<span class=normal>726</span>
<span class=normal>727</span>
<span class=normal>728</span>
<span class=normal>729</span>
<span class=normal>730</span>
<span class=normal>731</span>
<span class=normal>732</span>
<span class=normal>733</span>
<span class=normal>734</span>
<span class=normal>735</span>
<span class=normal>736</span>
<span class=normal>737</span>
<span class=normal>738</span>
<span class=normal>739</span>
<span class=normal>740</span>
<span class=normal>741</span>
<span class=normal>742</span>
<span class=normal>743</span>
<span class=normal>744</span>
<span class=normal>745</span>
<span class=normal>746</span>
<span class=normal>747</span>
<span class=normal>748</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_product_name_and_group_from_template</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>task_entity</span><span class=p>,</span>
        <span class=n>product_type</span><span class=p>,</span>
        <span class=n>variant</span><span class=p>,</span>
        <span class=n>host_name</span><span class=p>,</span>
        <span class=n>dynamic_data</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get product name and group name from template.</span>

<span class=sd>    This will get product name and group name from template based on</span>
<span class=sd>    data provided. It is doing similar work as</span>
<span class=sd>    `func::_get_legacy_product_name_and_group` but using templates.</span>

<span class=sd>    To get group name, template is called without any dynamic data, so</span>
<span class=sd>    (depending on the template itself) it should be product name without</span>
<span class=sd>    aov.</span>

<span class=sd>    Todo:</span>
<span class=sd>        Maybe we should introduce templates for the groups themselves.</span>

<span class=sd>    Args:</span>
<span class=sd>        task_entity (dict): Task entity.</span>
<span class=sd>        project_name (str): Project name.</span>
<span class=sd>        host_name (str): Host name.</span>
<span class=sd>        product_type (str): Product type.</span>
<span class=sd>        variant (str): Variant.</span>
<span class=sd>        dynamic_data (dict): Dynamic data (aov, renderlayer, camera, ...).</span>

<span class=sd>    Returns:</span>
<span class=sd>        tuple: product name and group name.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># remove &#39;aov&#39; from data used to format group. See todo comment above</span>
    <span class=c1># for possible solution.</span>
    <span class=n>_dynamic_data</span> <span class=o>=</span> <span class=n>deepcopy</span><span class=p>(</span><span class=n>dynamic_data</span><span class=p>)</span> <span class=ow>or</span> <span class=p>{}</span>
    <span class=n>_dynamic_data</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;aov&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=n>resulting_group_name</span> <span class=o>=</span> <span class=n>get_product_name</span><span class=p>(</span>
        <span class=n>project_name</span><span class=o>=</span><span class=n>project_name</span><span class=p>,</span>
        <span class=n>task_name</span><span class=o>=</span><span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>],</span>
        <span class=n>task_type</span><span class=o>=</span><span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;taskType&quot;</span><span class=p>],</span>
        <span class=n>host_name</span><span class=o>=</span><span class=n>host_name</span><span class=p>,</span>
        <span class=n>product_type</span><span class=o>=</span><span class=n>product_type</span><span class=p>,</span>
        <span class=n>dynamic_data</span><span class=o>=</span><span class=n>_dynamic_data</span><span class=p>,</span>
        <span class=n>variant</span><span class=o>=</span><span class=n>variant</span><span class=p>,</span>
    <span class=p>)</span>

    <span class=n>resulting_product_name</span> <span class=o>=</span> <span class=n>get_product_name</span><span class=p>(</span>
        <span class=n>project_name</span><span class=o>=</span><span class=n>project_name</span><span class=p>,</span>
        <span class=n>task_name</span><span class=o>=</span><span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>],</span>
        <span class=n>task_type</span><span class=o>=</span><span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;taskType&quot;</span><span class=p>],</span>
        <span class=n>host_name</span><span class=o>=</span><span class=n>host_name</span><span class=p>,</span>
        <span class=n>product_type</span><span class=o>=</span><span class=n>product_type</span><span class=p>,</span>
        <span class=n>dynamic_data</span><span class=o>=</span><span class=n>dynamic_data</span><span class=p>,</span>
        <span class=n>variant</span><span class=o>=</span><span class=n>variant</span><span class=p>,</span>
    <span class=p>)</span>
    <span class=k>return</span> <span class=n>resulting_product_name</span><span class=p>,</span> <span class=n>resulting_group_name</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.get_resources class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_resources</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>version_entity</span><span class=p>,</span> <span class=n>extension</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get the files from the specific version.</p> <p>This will return all get all files from representation.</p> <details class=todo open> <summary>Todo</summary> <p>This is really weird function, and it's use is highly controversial. First, it will not probably work ar all in final release of AYON, second, the logic isn't sound. It should try to find representation matching the current one - because it is used to pull out files from previous version to be included in this one.</p> </details> <p>.. deprecated:: 3.15.5 This won't work in AYON and even the logic must be refactored.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Name of the project.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>version_entity</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Version entity.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>extension</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>extension used to filter representations.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>list</code></td> <td> </td> <td> <div class=doc-md-description> <p>of files</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1002</span>
<span class=normal>1003</span>
<span class=normal>1004</span>
<span class=normal>1005</span>
<span class=normal>1006</span>
<span class=normal>1007</span>
<span class=normal>1008</span>
<span class=normal>1009</span>
<span class=normal>1010</span>
<span class=normal>1011</span>
<span class=normal>1012</span>
<span class=normal>1013</span>
<span class=normal>1014</span>
<span class=normal>1015</span>
<span class=normal>1016</span>
<span class=normal>1017</span>
<span class=normal>1018</span>
<span class=normal>1019</span>
<span class=normal>1020</span>
<span class=normal>1021</span>
<span class=normal>1022</span>
<span class=normal>1023</span>
<span class=normal>1024</span>
<span class=normal>1025</span>
<span class=normal>1026</span>
<span class=normal>1027</span>
<span class=normal>1028</span>
<span class=normal>1029</span>
<span class=normal>1030</span>
<span class=normal>1031</span>
<span class=normal>1032</span>
<span class=normal>1033</span>
<span class=normal>1034</span>
<span class=normal>1035</span>
<span class=normal>1036</span>
<span class=normal>1037</span>
<span class=normal>1038</span>
<span class=normal>1039</span>
<span class=normal>1040</span>
<span class=normal>1041</span>
<span class=normal>1042</span>
<span class=normal>1043</span>
<span class=normal>1044</span>
<span class=normal>1045</span>
<span class=normal>1046</span>
<span class=normal>1047</span>
<span class=normal>1048</span>
<span class=normal>1049</span>
<span class=normal>1050</span>
<span class=normal>1051</span>
<span class=normal>1052</span>
<span class=normal>1053</span>
<span class=normal>1054</span>
<span class=normal>1055</span>
<span class=normal>1056</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_resources</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>version_entity</span><span class=p>,</span> <span class=n>extension</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get the files from the specific version.</span>

<span class=sd>    This will return all get all files from representation.</span>

<span class=sd>    Todo:</span>
<span class=sd>        This is really weird function, and it&#39;s use is</span>
<span class=sd>        highly controversial. First, it will not probably work</span>
<span class=sd>        ar all in final release of AYON, second, the logic isn&#39;t sound.</span>
<span class=sd>        It should try to find representation matching the current one -</span>
<span class=sd>        because it is used to pull out files from previous version to</span>
<span class=sd>        be included in this one.</span>

<span class=sd>    .. deprecated:: 3.15.5</span>
<span class=sd>       This won&#39;t work in AYON and even the logic must be refactored.</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (str): Name of the project.</span>
<span class=sd>        version_entity (dict): Version entity.</span>
<span class=sd>        extension (str): extension used to filter</span>
<span class=sd>            representations.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list: of files</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>warnings</span><span class=o>.</span><span class=n>warn</span><span class=p>((</span>
        <span class=s2>&quot;This won&#39;t work in AYON and even &quot;</span>
        <span class=s2>&quot;the logic must be refactored.&quot;</span><span class=p>),</span> <span class=ne>DeprecationWarning</span><span class=p>)</span>
    <span class=n>extensions</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>if</span> <span class=n>extension</span><span class=p>:</span>
        <span class=n>extensions</span> <span class=o>=</span> <span class=p>[</span><span class=n>extension</span><span class=p>]</span>

    <span class=c1># there is a `context_filter` argument that won&#39;t probably work in</span>
    <span class=c1># final release of AYON. SO we&#39;ll rather not use it</span>
    <span class=n>repre_entities</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>ayon_api</span><span class=o>.</span><span class=n>get_representations</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=o>=</span><span class=p>{</span><span class=n>version_entity</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]}</span>
    <span class=p>))</span>

    <span class=n>filtered</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>repre_entity</span> <span class=ow>in</span> <span class=n>repre_entities</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>repre_entity</span><span class=p>[</span><span class=s2>&quot;context&quot;</span><span class=p>][</span><span class=s2>&quot;ext&quot;</span><span class=p>]</span> <span class=ow>in</span> <span class=n>extensions</span><span class=p>:</span>
            <span class=n>filtered</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>repre_entity</span><span class=p>)</span>

    <span class=n>representation</span> <span class=o>=</span> <span class=n>filtered</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
    <span class=n>directory</span> <span class=o>=</span> <span class=n>get_representation_path</span><span class=p>(</span><span class=n>representation</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Source: &quot;</span><span class=p>,</span> <span class=n>directory</span><span class=p>)</span>
    <span class=n>resources</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span>
        <span class=p>[</span>
            <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>normpath</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>directory</span><span class=p>,</span> <span class=n>file_name</span><span class=p>))</span>
            <span class=k>for</span> <span class=n>file_name</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=n>directory</span><span class=p>)</span>
        <span class=p>]</span>
    <span class=p>)</span>

    <span class=k>return</span> <span class=n>resources</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.get_time_data_from_instance_or_context class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_time_data_from_instance_or_context</span><span class=p>(</span><span class=n>instance</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get time data from instance (or context).</p> <p>If time data is not found on instance, data from context will be used.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>instance</code> </td> <td> <code><span title=pyblish.api.Instance>Instance</span></code> </td> <td> <div class=doc-md-description> <p>Source instance.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>TimeData</code></td> <td> </td> <td> <div class=doc-md-description> <p>dataclass holding time information.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_time_data_from_instance_or_context</span><span class=p>(</span><span class=n>instance</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get time data from instance (or context).</span>

<span class=sd>    If time data is not found on instance, data from context will be used.</span>

<span class=sd>    Args:</span>
<span class=sd>        instance (pyblish.api.Instance): Source instance.</span>

<span class=sd>    Returns:</span>
<span class=sd>        TimeData: dataclass holding time information.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>context</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>context</span>
    <span class=k>return</span> <span class=n>TimeData</span><span class=p>(</span>
        <span class=n>start</span><span class=o>=</span><span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;frameStart&quot;</span><span class=p>,</span> <span class=n>context</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;frameStart&quot;</span><span class=p>)),</span>
        <span class=n>end</span><span class=o>=</span><span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;frameEnd&quot;</span><span class=p>,</span> <span class=n>context</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;frameEnd&quot;</span><span class=p>)),</span>
        <span class=n>fps</span><span class=o>=</span><span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;fps&quot;</span><span class=p>,</span> <span class=n>context</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;fps&quot;</span><span class=p>)),</span>
        <span class=n>step</span><span class=o>=</span><span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;byFrameStep&quot;</span><span class=p>,</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;step&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)),</span>
        <span class=n>handle_start</span><span class=o>=</span><span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span>
            <span class=s2>&quot;handleStart&quot;</span><span class=p>,</span> <span class=n>context</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;handleStart&quot;</span><span class=p>)</span>
        <span class=p>),</span>
        <span class=n>handle_end</span><span class=o>=</span><span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span>
            <span class=s2>&quot;handleEnd&quot;</span><span class=p>,</span> <span class=n>context</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;handleEnd&quot;</span><span class=p>)</span>
        <span class=p>)</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.get_transferable_representations class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_transferable_representations</span><span class=p>(</span><span class=n>instance</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Transfer representations from original instance.</p> <p>This will get all representations on the original instance that are flagged with <code>publish_on_farm</code> and return them to be included on skeleton instance if needed.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>instance</code> </td> <td> <code><span title=pyblish.api.Instance>Instance</span></code> </td> <td> <div class=doc-md-description> <p>Original instance to be processed.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=return open> <summary>Return</summary> <p>list of dicts: List of transferable representations.</p> </details> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span>
<span class=normal>150</span>
<span class=normal>151</span>
<span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_transferable_representations</span><span class=p>(</span><span class=n>instance</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Transfer representations from original instance.</span>

<span class=sd>    This will get all representations on the original instance that</span>
<span class=sd>    are flagged with `publish_on_farm` and return them to be included</span>
<span class=sd>    on skeleton instance if needed.</span>

<span class=sd>    Args:</span>
<span class=sd>        instance (pyblish.api.Instance): Original instance to be processed.</span>

<span class=sd>    Return:</span>
<span class=sd>        list of dicts: List of transferable representations.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>anatomy</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>context</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;anatomy&quot;</span><span class=p>]</span>
    <span class=n>to_transfer</span> <span class=o>=</span> <span class=p>[]</span>

    <span class=k>for</span> <span class=n>representation</span> <span class=ow>in</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;representations&quot;</span><span class=p>,</span> <span class=p>[]):</span>
        <span class=k>if</span> <span class=s2>&quot;publish_on_farm&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>representation</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;tags&quot;</span><span class=p>,</span> <span class=p>[]):</span>
            <span class=k>continue</span>

        <span class=n>trans_rep</span> <span class=o>=</span> <span class=n>representation</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>

        <span class=c1># remove publish_on_farm from representations tags</span>
        <span class=n>trans_rep</span><span class=p>[</span><span class=s2>&quot;tags&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=s2>&quot;publish_on_farm&quot;</span><span class=p>)</span>

        <span class=n>staging_dir</span> <span class=o>=</span> <span class=n>trans_rep</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;stagingDir&quot;</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>staging_dir</span><span class=p>:</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=n>trans_rep</span><span class=p>[</span><span class=s2>&quot;stagingDir&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>remap_source</span><span class=p>(</span><span class=n>staging_dir</span><span class=p>,</span> <span class=n>anatomy</span><span class=p>)</span>
            <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
                <span class=n>log</span> <span class=o>=</span> <span class=n>Logger</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=s2>&quot;farm_publishing&quot;</span><span class=p>)</span>
                <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                    <span class=p>(</span><span class=s2>&quot;Could not find root path for remapping </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>. &quot;</span>
                     <span class=s2>&quot;This may cause issues on farm.&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>staging_dir</span><span class=p>))</span>

        <span class=n>to_transfer</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>trans_rep</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>to_transfer</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.prepare_cache_representations class="doc doc-heading"> <code class="highlight language-python"><span class=n>prepare_cache_representations</span><span class=p>(</span><span class=n>skeleton_data</span><span class=p>,</span> <span class=n>exp_files</span><span class=p>,</span> <span class=n>anatomy</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Create representations for file sequences.</p> <p>This will return representations of expected files if they are not in hierarchy of aovs. There should be only one sequence of files for most cases, but if not - we create representation from each of them.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>skeleton_data</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>instance data for which we are setting representations</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>exp_files</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>list of expected files</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p>Returns: list of representations</p> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1146</span>
<span class=normal>1147</span>
<span class=normal>1148</span>
<span class=normal>1149</span>
<span class=normal>1150</span>
<span class=normal>1151</span>
<span class=normal>1152</span>
<span class=normal>1153</span>
<span class=normal>1154</span>
<span class=normal>1155</span>
<span class=normal>1156</span>
<span class=normal>1157</span>
<span class=normal>1158</span>
<span class=normal>1159</span>
<span class=normal>1160</span>
<span class=normal>1161</span>
<span class=normal>1162</span>
<span class=normal>1163</span>
<span class=normal>1164</span>
<span class=normal>1165</span>
<span class=normal>1166</span>
<span class=normal>1167</span>
<span class=normal>1168</span>
<span class=normal>1169</span>
<span class=normal>1170</span>
<span class=normal>1171</span>
<span class=normal>1172</span>
<span class=normal>1173</span>
<span class=normal>1174</span>
<span class=normal>1175</span>
<span class=normal>1176</span>
<span class=normal>1177</span>
<span class=normal>1178</span>
<span class=normal>1179</span>
<span class=normal>1180</span>
<span class=normal>1181</span>
<span class=normal>1182</span>
<span class=normal>1183</span>
<span class=normal>1184</span>
<span class=normal>1185</span>
<span class=normal>1186</span>
<span class=normal>1187</span>
<span class=normal>1188</span>
<span class=normal>1189</span>
<span class=normal>1190</span>
<span class=normal>1191</span>
<span class=normal>1192</span>
<span class=normal>1193</span>
<span class=normal>1194</span>
<span class=normal>1195</span>
<span class=normal>1196</span>
<span class=normal>1197</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>prepare_cache_representations</span><span class=p>(</span><span class=n>skeleton_data</span><span class=p>,</span> <span class=n>exp_files</span><span class=p>,</span> <span class=n>anatomy</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Create representations for file sequences.</span>

<span class=sd>    This will return representations of expected files if they are not</span>
<span class=sd>    in hierarchy of aovs. There should be only one sequence of files for</span>
<span class=sd>    most cases, but if not - we create representation from each of them.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        skeleton_data (dict): instance data for which we are</span>
<span class=sd>                         setting representations</span>
<span class=sd>        exp_files (list): list of expected files</span>
<span class=sd>        anatomy (Anatomy)</span>
<span class=sd>    Returns:</span>
<span class=sd>        list of representations</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>representations</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>collections</span><span class=p>,</span> <span class=n>_remainders</span> <span class=o>=</span> <span class=n>clique</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>exp_files</span><span class=p>)</span>

    <span class=n>log</span> <span class=o>=</span> <span class=n>Logger</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=s2>&quot;farm_publishing&quot;</span><span class=p>)</span>

    <span class=c1># create representation for every collected sequence</span>
    <span class=k>for</span> <span class=n>collection</span> <span class=ow>in</span> <span class=n>collections</span><span class=p>:</span>
        <span class=n>ext</span> <span class=o>=</span> <span class=n>collection</span><span class=o>.</span><span class=n>tail</span><span class=o>.</span><span class=n>lstrip</span><span class=p>(</span><span class=s2>&quot;.&quot;</span><span class=p>)</span>

        <span class=n>staging</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=n>collection</span><span class=p>)[</span><span class=mi>0</span><span class=p>])</span>
        <span class=n>success</span><span class=p>,</span> <span class=n>rootless_staging_dir</span> <span class=o>=</span> <span class=p>(</span>
            <span class=n>anatomy</span><span class=o>.</span><span class=n>find_root_template_from_path</span><span class=p>(</span><span class=n>staging</span><span class=p>)</span>
        <span class=p>)</span>
        <span class=k>if</span> <span class=n>success</span><span class=p>:</span>
            <span class=n>staging</span> <span class=o>=</span> <span class=n>rootless_staging_dir</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>((</span>
                <span class=s2>&quot;Could not find root path for remapping </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>.&quot;</span>
                <span class=s2>&quot; This may cause issues on farm.&quot;</span>
            <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>staging</span><span class=p>))</span>

        <span class=n>frame_start</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>skeleton_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;frameStartHandle&quot;</span><span class=p>))</span>
        <span class=n>rep</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>ext</span><span class=p>,</span>
            <span class=s2>&quot;ext&quot;</span><span class=p>:</span> <span class=n>ext</span><span class=p>,</span>
            <span class=s2>&quot;files&quot;</span><span class=p>:</span> <span class=p>[</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>f</span><span class=p>)</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=nb>list</span><span class=p>(</span><span class=n>collection</span><span class=p>)],</span>
            <span class=s2>&quot;frameStart&quot;</span><span class=p>:</span> <span class=n>frame_start</span><span class=p>,</span>
            <span class=s2>&quot;frameEnd&quot;</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>skeleton_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;frameEndHandle&quot;</span><span class=p>)),</span>
            <span class=c1># If expectedFile are absolute, we need only filenames</span>
            <span class=s2>&quot;stagingDir&quot;</span><span class=p>:</span> <span class=n>staging</span><span class=p>,</span>
            <span class=s2>&quot;fps&quot;</span><span class=p>:</span> <span class=n>skeleton_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;fps&quot;</span><span class=p>)</span>
        <span class=p>}</span>

        <span class=n>representations</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>rep</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>representations</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.prepare_representations class="doc doc-heading"> <code class="highlight language-python"><span class=n>prepare_representations</span><span class=p>(</span><span class=n>skeleton_data</span><span class=p>,</span> <span class=n>exp_files</span><span class=p>,</span> <span class=n>anatomy</span><span class=p>,</span> <span class=n>aov_filter</span><span class=p>,</span> <span class=n>skip_integration_repre_list</span><span class=p>,</span> <span class=n>do_not_add_review</span><span class=p>,</span> <span class=n>context</span><span class=p>,</span> <span class=n>color_managed_plugin</span><span class=p>,</span> <span class=n>frames_to_render</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Create representations for file sequences.</p> <p>This will return representations of expected files if they are not in hierarchy of aovs. There should be only one sequence of files for most cases, but if not - we create representation from each of them.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>skeleton_data</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>instance data for which we are setting representations</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>exp_files</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>list of expected files</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>anatomy</code> </td> <td> <code><a class="autorefs autorefs-internal" title="Anatomy (client.ayon_core.pipeline.anatomy.Anatomy)" href=../anatomy/index.html#client.ayon_core.pipeline.anatomy.Anatomy>Anatomy</a></code> </td> <td> <div class=doc-md-description> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>aov_filter</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>add review for specific aov names</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>skip_integration_repre_list</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>exclude specific extensions,</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>do_not_add_review</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>explicitly skip review</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>frames_to_render</code> </td> <td> <code><span title=str>str</span> | None</code> </td> <td> <div class=doc-md-description> <p>implicit or explicit range of frames to render this value is sent to Deadline in JobInfo.Frames</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p>Returns: list of representations</p> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span>
<span class=normal>366</span>
<span class=normal>367</span>
<span class=normal>368</span>
<span class=normal>369</span>
<span class=normal>370</span>
<span class=normal>371</span>
<span class=normal>372</span>
<span class=normal>373</span>
<span class=normal>374</span>
<span class=normal>375</span>
<span class=normal>376</span>
<span class=normal>377</span>
<span class=normal>378</span>
<span class=normal>379</span>
<span class=normal>380</span>
<span class=normal>381</span>
<span class=normal>382</span>
<span class=normal>383</span>
<span class=normal>384</span>
<span class=normal>385</span>
<span class=normal>386</span>
<span class=normal>387</span>
<span class=normal>388</span>
<span class=normal>389</span>
<span class=normal>390</span>
<span class=normal>391</span>
<span class=normal>392</span>
<span class=normal>393</span>
<span class=normal>394</span>
<span class=normal>395</span>
<span class=normal>396</span>
<span class=normal>397</span>
<span class=normal>398</span>
<span class=normal>399</span>
<span class=normal>400</span>
<span class=normal>401</span>
<span class=normal>402</span>
<span class=normal>403</span>
<span class=normal>404</span>
<span class=normal>405</span>
<span class=normal>406</span>
<span class=normal>407</span>
<span class=normal>408</span>
<span class=normal>409</span>
<span class=normal>410</span>
<span class=normal>411</span>
<span class=normal>412</span>
<span class=normal>413</span>
<span class=normal>414</span>
<span class=normal>415</span>
<span class=normal>416</span>
<span class=normal>417</span>
<span class=normal>418</span>
<span class=normal>419</span>
<span class=normal>420</span>
<span class=normal>421</span>
<span class=normal>422</span>
<span class=normal>423</span>
<span class=normal>424</span>
<span class=normal>425</span>
<span class=normal>426</span>
<span class=normal>427</span>
<span class=normal>428</span>
<span class=normal>429</span>
<span class=normal>430</span>
<span class=normal>431</span>
<span class=normal>432</span>
<span class=normal>433</span>
<span class=normal>434</span>
<span class=normal>435</span>
<span class=normal>436</span>
<span class=normal>437</span>
<span class=normal>438</span>
<span class=normal>439</span>
<span class=normal>440</span>
<span class=normal>441</span>
<span class=normal>442</span>
<span class=normal>443</span>
<span class=normal>444</span>
<span class=normal>445</span>
<span class=normal>446</span>
<span class=normal>447</span>
<span class=normal>448</span>
<span class=normal>449</span>
<span class=normal>450</span>
<span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span>
<span class=normal>464</span>
<span class=normal>465</span>
<span class=normal>466</span>
<span class=normal>467</span>
<span class=normal>468</span>
<span class=normal>469</span>
<span class=normal>470</span>
<span class=normal>471</span>
<span class=normal>472</span>
<span class=normal>473</span>
<span class=normal>474</span>
<span class=normal>475</span>
<span class=normal>476</span>
<span class=normal>477</span>
<span class=normal>478</span>
<span class=normal>479</span>
<span class=normal>480</span>
<span class=normal>481</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>prepare_representations</span><span class=p>(</span>
    <span class=n>skeleton_data</span><span class=p>,</span>
    <span class=n>exp_files</span><span class=p>,</span>
    <span class=n>anatomy</span><span class=p>,</span>
    <span class=n>aov_filter</span><span class=p>,</span>
    <span class=n>skip_integration_repre_list</span><span class=p>,</span>
    <span class=n>do_not_add_review</span><span class=p>,</span>
    <span class=n>context</span><span class=p>,</span>
    <span class=n>color_managed_plugin</span><span class=p>,</span>
    <span class=n>frames_to_render</span><span class=o>=</span><span class=kc>None</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Create representations for file sequences.</span>

<span class=sd>    This will return representations of expected files if they are not</span>
<span class=sd>    in hierarchy of aovs. There should be only one sequence of files for</span>
<span class=sd>    most cases, but if not - we create representation from each of them.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        skeleton_data (dict): instance data for which we are</span>
<span class=sd>                         setting representations</span>
<span class=sd>        exp_files (list): list of expected files</span>
<span class=sd>        anatomy (Anatomy):</span>
<span class=sd>        aov_filter (dict): add review for specific aov names</span>
<span class=sd>        skip_integration_repre_list (list): exclude specific extensions,</span>
<span class=sd>        do_not_add_review (bool): explicitly skip review</span>
<span class=sd>        color_managed_plugin (publish.ColormanagedPyblishPluginMixin)</span>
<span class=sd>        frames_to_render (str | None): implicit or explicit range of frames</span>
<span class=sd>            to render this value is sent to Deadline in JobInfo.Frames</span>
<span class=sd>    Returns:</span>
<span class=sd>        list of representations</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>representations</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>host_name</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;AYON_HOST_NAME&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
    <span class=n>collections</span><span class=p>,</span> <span class=n>remainders</span> <span class=o>=</span> <span class=n>clique</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span><span class=n>exp_files</span><span class=p>)</span>

    <span class=n>log</span> <span class=o>=</span> <span class=n>Logger</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=s2>&quot;farm_publishing&quot;</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>frames_to_render</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>frames_to_render</span> <span class=o>=</span> <span class=n>convert_frames_str_to_list</span><span class=p>(</span><span class=n>frames_to_render</span><span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=c1># Backwards compatibility for older logic</span>
        <span class=n>frame_start</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>skeleton_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;frameStartHandle&quot;</span><span class=p>))</span>
        <span class=n>frame_end</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>skeleton_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;frameEndHandle&quot;</span><span class=p>))</span>
        <span class=n>frames_to_render</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>frame_start</span><span class=p>,</span> <span class=n>frame_end</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span>

    <span class=c1># create representation for every collected sequence</span>
    <span class=k>for</span> <span class=n>collection</span> <span class=ow>in</span> <span class=n>collections</span><span class=p>:</span>
        <span class=n>ext</span> <span class=o>=</span> <span class=n>collection</span><span class=o>.</span><span class=n>tail</span><span class=o>.</span><span class=n>lstrip</span><span class=p>(</span><span class=s2>&quot;.&quot;</span><span class=p>)</span>
        <span class=n>preview</span> <span class=o>=</span> <span class=kc>False</span>
        <span class=c1># TODO &#39;useSequenceForReview&#39; is temporary solution which does</span>
        <span class=c1>#   not work for 100% of cases. We must be able to tell what</span>
        <span class=c1>#   expected files contains more explicitly and from what</span>
        <span class=c1>#   should be review made.</span>
        <span class=c1># - &quot;review&quot; tag is never added when is set to &#39;False&#39;</span>
        <span class=k>if</span> <span class=n>skeleton_data</span><span class=p>[</span><span class=s2>&quot;useSequenceForReview&quot;</span><span class=p>]:</span>
            <span class=c1># toggle preview on if multipart is on</span>
            <span class=k>if</span> <span class=n>skeleton_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;multipartExr&quot;</span><span class=p>,</span> <span class=kc>False</span><span class=p>):</span>
                <span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
                    <span class=s2>&quot;Adding preview tag because its multipartExr&quot;</span>
                <span class=p>)</span>
                <span class=n>preview</span> <span class=o>=</span> <span class=kc>True</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>render_file_name</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>collection</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
                <span class=c1># if filtered aov name is found in filename, toggle it for</span>
                <span class=c1># preview video rendering</span>
                <span class=n>preview</span> <span class=o>=</span> <span class=n>match_aov_pattern</span><span class=p>(</span>
                    <span class=n>host_name</span><span class=p>,</span> <span class=n>aov_filter</span><span class=p>,</span> <span class=n>render_file_name</span>
                <span class=p>)</span>

        <span class=n>staging</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=n>collection</span><span class=p>)[</span><span class=mi>0</span><span class=p>])</span>
        <span class=n>success</span><span class=p>,</span> <span class=n>rootless_staging_dir</span> <span class=o>=</span> <span class=p>(</span>
            <span class=n>anatomy</span><span class=o>.</span><span class=n>find_root_template_from_path</span><span class=p>(</span><span class=n>staging</span><span class=p>)</span>
        <span class=p>)</span>
        <span class=k>if</span> <span class=n>success</span><span class=p>:</span>
            <span class=n>staging</span> <span class=o>=</span> <span class=n>rootless_staging_dir</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>((</span>
                <span class=s2>&quot;Could not find root path for remapping </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>.&quot;</span>
                <span class=s2>&quot; This may cause issues on farm.&quot;</span>
            <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>staging</span><span class=p>))</span>

        <span class=n>frame_start</span> <span class=o>=</span> <span class=n>frames_to_render</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
        <span class=n>frame_end</span> <span class=o>=</span> <span class=n>frames_to_render</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
        <span class=k>if</span> <span class=n>skeleton_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;slate&quot;</span><span class=p>):</span>
            <span class=n>frame_start</span> <span class=o>-=</span> <span class=mi>1</span>
            <span class=n>frames_to_render</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>frame_start</span><span class=p>)</span>

        <span class=n>filenames</span> <span class=o>=</span> <span class=p>[</span>
            <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>filepath</span><span class=p>)</span>
            <span class=k>for</span> <span class=n>filepath</span> <span class=ow>in</span> <span class=n>_get_real_files_to_render</span><span class=p>(</span>
                <span class=n>collection</span><span class=p>,</span> <span class=n>frames_to_render</span>
            <span class=p>)</span>
        <span class=p>]</span>
        <span class=c1># explicitly disable review by user</span>
        <span class=n>preview</span> <span class=o>=</span> <span class=n>preview</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>do_not_add_review</span>
        <span class=n>rep</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>ext</span><span class=p>,</span>
            <span class=s2>&quot;ext&quot;</span><span class=p>:</span> <span class=n>ext</span><span class=p>,</span>
            <span class=s2>&quot;files&quot;</span><span class=p>:</span> <span class=n>filenames</span><span class=p>,</span>
            <span class=s2>&quot;stagingDir&quot;</span><span class=p>:</span> <span class=n>staging</span><span class=p>,</span>
            <span class=s2>&quot;frameStart&quot;</span><span class=p>:</span> <span class=n>frame_start</span><span class=p>,</span>
            <span class=s2>&quot;frameEnd&quot;</span><span class=p>:</span> <span class=n>frame_end</span><span class=p>,</span>
            <span class=s2>&quot;fps&quot;</span><span class=p>:</span> <span class=n>skeleton_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;fps&quot;</span><span class=p>),</span>
            <span class=s2>&quot;tags&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;review&quot;</span><span class=p>]</span> <span class=k>if</span> <span class=n>preview</span> <span class=k>else</span> <span class=p>[],</span>
        <span class=p>}</span>

        <span class=c1># poor man exclusion</span>
        <span class=k>if</span> <span class=n>ext</span> <span class=ow>in</span> <span class=n>skip_integration_repre_list</span><span class=p>:</span>
            <span class=n>rep</span><span class=p>[</span><span class=s2>&quot;tags&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;delete&quot;</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>skeleton_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;multipartExr&quot;</span><span class=p>,</span> <span class=kc>False</span><span class=p>):</span>
            <span class=n>rep</span><span class=p>[</span><span class=s2>&quot;tags&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;multipartExr&quot;</span><span class=p>)</span>

        <span class=c1># support conversion from tiled to scanline</span>
        <span class=k>if</span> <span class=n>skeleton_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;convertToScanline&quot;</span><span class=p>):</span>
            <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Adding scanline conversion.&quot;</span><span class=p>)</span>
            <span class=n>rep</span><span class=p>[</span><span class=s2>&quot;tags&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;toScanline&quot;</span><span class=p>)</span>

        <span class=n>representations</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>rep</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>preview</span><span class=p>:</span>
            <span class=n>skeleton_data</span><span class=p>[</span><span class=s2>&quot;families&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>_add_review_families</span><span class=p>(</span>
                <span class=n>skeleton_data</span><span class=p>[</span><span class=s2>&quot;families&quot;</span><span class=p>])</span>

    <span class=c1># add remainders as representations</span>
    <span class=k>for</span> <span class=n>remainder</span> <span class=ow>in</span> <span class=n>remainders</span><span class=p>:</span>
        <span class=n>ext</span> <span class=o>=</span> <span class=n>remainder</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;.&quot;</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>

        <span class=n>staging</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>remainder</span><span class=p>)</span>
        <span class=n>success</span><span class=p>,</span> <span class=n>rootless_staging_dir</span> <span class=o>=</span> <span class=p>(</span>
            <span class=n>anatomy</span><span class=o>.</span><span class=n>find_root_template_from_path</span><span class=p>(</span><span class=n>staging</span><span class=p>)</span>
        <span class=p>)</span>
        <span class=k>if</span> <span class=n>success</span><span class=p>:</span>
            <span class=n>staging</span> <span class=o>=</span> <span class=n>rootless_staging_dir</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>((</span>
                <span class=s2>&quot;Could not find root path for remapping </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>.&quot;</span>
                <span class=s2>&quot; This may cause issues on farm.&quot;</span>
            <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>staging</span><span class=p>))</span>

        <span class=n>rep</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>ext</span><span class=p>,</span>
            <span class=s2>&quot;ext&quot;</span><span class=p>:</span> <span class=n>ext</span><span class=p>,</span>
            <span class=s2>&quot;files&quot;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>remainder</span><span class=p>),</span>
            <span class=s2>&quot;stagingDir&quot;</span><span class=p>:</span> <span class=n>staging</span><span class=p>,</span>
        <span class=p>}</span>

        <span class=n>preview</span> <span class=o>=</span> <span class=n>match_aov_pattern</span><span class=p>(</span>
            <span class=n>host_name</span><span class=p>,</span> <span class=n>aov_filter</span><span class=p>,</span> <span class=n>remainder</span>
        <span class=p>)</span>
        <span class=n>preview</span> <span class=o>=</span> <span class=n>preview</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>do_not_add_review</span>
        <span class=k>if</span> <span class=n>preview</span><span class=p>:</span>
            <span class=n>rep</span><span class=o>.</span><span class=n>update</span><span class=p>({</span>
                <span class=s2>&quot;fps&quot;</span><span class=p>:</span> <span class=n>skeleton_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;fps&quot;</span><span class=p>),</span>
                <span class=s2>&quot;tags&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;review&quot;</span><span class=p>]</span>
            <span class=p>})</span>
            <span class=n>skeleton_data</span><span class=p>[</span><span class=s2>&quot;families&quot;</span><span class=p>]</span> <span class=o>=</span> \
                <span class=n>_add_review_families</span><span class=p>(</span><span class=n>skeleton_data</span><span class=p>[</span><span class=s2>&quot;families&quot;</span><span class=p>])</span>

        <span class=n>already_there</span> <span class=o>=</span> <span class=kc>False</span>
        <span class=k>for</span> <span class=n>repre</span> <span class=ow>in</span> <span class=n>skeleton_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;representations&quot;</span><span class=p>,</span> <span class=p>[]):</span>
            <span class=c1># might be added explicitly before by publish_on_farm</span>
            <span class=n>already_there</span> <span class=o>=</span> <span class=n>repre</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;files&quot;</span><span class=p>)</span> <span class=o>==</span> <span class=n>rep</span><span class=p>[</span><span class=s2>&quot;files&quot;</span><span class=p>]</span>
            <span class=k>if</span> <span class=n>already_there</span><span class=p>:</span>
                <span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&quot;repre </span><span class=si>{}</span><span class=s2> already_there&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>repre</span><span class=p>))</span>
                <span class=k>break</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>already_there</span><span class=p>:</span>
            <span class=n>representations</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>rep</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>rep</span> <span class=ow>in</span> <span class=n>representations</span><span class=p>:</span>
        <span class=c1># inject colorspace data</span>
        <span class=n>color_managed_plugin</span><span class=o>.</span><span class=n>set_representation_colorspace</span><span class=p>(</span>
            <span class=n>rep</span><span class=p>,</span> <span class=n>context</span><span class=p>,</span>
            <span class=n>colorspace</span><span class=o>=</span><span class=n>skeleton_data</span><span class=p>[</span><span class=s2>&quot;colorspace&quot;</span><span class=p>]</span>
        <span class=p>)</span>

    <span class=k>return</span> <span class=n>representations</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_core.pipeline.farm.pyblish_functions.remap_source class="doc doc-heading"> <code class="highlight language-python"><span class=n>remap_source</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>anatomy</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Try to remap path to rootless path.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Path to be remapped to rootless.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>anatomy</code> </td> <td> <code><a class="autorefs autorefs-internal" title="Anatomy (client.ayon_core.pipeline.anatomy.Anatomy)" href=../anatomy/index.html#client.ayon_core.pipeline.anatomy.Anatomy>Anatomy</a></code> </td> <td> <div class=doc-md-description> <p>Anatomy object to handle remapping itself.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>str</code></td> <td> </td> <td> <div class=doc-md-description> <p>Remapped path.</p> </div> </td> </tr> </tbody> </table> <details class=throws open> <summary>Throws</summary> <p>ValueError: if the root cannot be found.</p> </details> <details class=quote> <summary>Source code in <code>client/ayon_core/pipeline/farm/pyblish_functions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>remap_source</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>anatomy</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Try to remap path to rootless path.</span>

<span class=sd>    Args:</span>
<span class=sd>        path (str): Path to be remapped to rootless.</span>
<span class=sd>        anatomy (Anatomy): Anatomy object to handle remapping</span>
<span class=sd>            itself.</span>

<span class=sd>    Returns:</span>
<span class=sd>        str: Remapped path.</span>

<span class=sd>    Throws:</span>
<span class=sd>        ValueError: if the root cannot be found.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>success</span><span class=p>,</span> <span class=n>rootless_path</span> <span class=o>=</span> <span class=p>(</span>
        <span class=n>anatomy</span><span class=o>.</span><span class=n>find_root_template_from_path</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
    <span class=p>)</span>
    <span class=k>if</span> <span class=n>success</span><span class=p>:</span>
        <span class=n>source</span> <span class=o>=</span> <span class=n>rootless_path</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
            <span class=s2>&quot;Root from template path cannot be found: </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>path</span><span class=p>))</span>
    <span class=k>return</span> <span class=n>source</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../../..", "features": ["navigation.sections", "navigation.path", "navigation.prune"], "search": "../../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../../../assets/javascripts/bundle.f55a23d4.min.js></script> </body> </html>