<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=prev href=../control.html><link rel=next href=actions.html><link rel=icon href=../../../../../../img/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.20"><title>models - ayon-core</title><link rel=stylesheet href=../../../../../../assets/stylesheets/main.e53b48f4.min.css><link rel=stylesheet href=../../../../../../assets/stylesheets/palette.06af60db.min.css><script src=https://unpkg.com/iframe-worker/shim></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../../../../css/custom.css><script>__md_scope=new URL("../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#client.ayon_core.tools.loader.models class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../../../../index.html title=ayon-core class="md-header__button md-logo" aria-label=ayon-core data-md-component=logo> <img src=../../../../../../img/ay-symbol-blackw-full.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ayon-core </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> models </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ynput/ayon-core title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../../../../index.html title=ayon-core class="md-nav__button md-logo" aria-label=ayon-core data-md-component=logo> <img src=../../../../../../img/ay-symbol-blackw-full.png alt=logo> </a> ayon-core </label> <div class=md-nav__source> <a href=https://github.com/ynput/ayon-core title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../../index.html class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../license.html class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1 checked> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class=md-ellipsis> client </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> client </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1 checked> <label class=md-nav__link for=__nav_3_1_1 id=__nav_3_1_1_label tabindex=0> <span class=md-ellipsis> ayon_core </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_1_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1> <span class="md-nav__icon md-icon"></span> ayon_core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../__main__.html class=md-nav__link> <span class=md-ellipsis> __main__ </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../addon/base.html class=md-nav__link> <span class=md-ellipsis> addon </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../../cli.html class=md-nav__link> <span class=md-ellipsis> cli </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../hooks/pre_add_last_workfile_arg.html class=md-nav__link> <span class=md-ellipsis> hooks </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../host/abstract.html class=md-nav__link> <span class=md-ellipsis> host </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../lib/attribute_definitions.html class=md-nav__link> <span class=md-ellipsis> lib </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../pipeline/actions.html class=md-nav__link> <span class=md-ellipsis> pipeline </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../plugins/actions/open_file_explorer.html class=md-nav__link> <span class=md-ellipsis> plugins </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../../resources/index.html class=md-nav__link> <span class=md-ellipsis> resources </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../scripts/ocio_wrapper.html class=md-nav__link> <span class=md-ellipsis> scripts </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../settings/lib.html class=md-nav__link> <span class=md-ellipsis> settings </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../style/color_defs.html class=md-nav__link> <span class=md-ellipsis> style </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../tests/conftest.html class=md-nav__link> <span class=md-ellipsis> tests </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1_14 checked> <label class=md-nav__link for=__nav_3_1_1_14 id=__nav_3_1_1_14_label tabindex=0> <span class=md-ellipsis> tools </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_1_1_14_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1_14> <span class="md-nav__icon md-icon"></span> tools </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../attribute_defs/_constants.html class=md-nav__link> <span class=md-ellipsis> attribute_defs </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../common_models/cache.html class=md-nav__link> <span class=md-ellipsis> common_models </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../console_interpreter/abstract.html class=md-nav__link> <span class=md-ellipsis> console_interpreter </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../context_dialog/window.html class=md-nav__link> <span class=md-ellipsis> context_dialog </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../experimental_tools/dialog.html class=md-nav__link> <span class=md-ellipsis> experimental_tools </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../flickcharm.html class=md-nav__link> <span class=md-ellipsis> flickcharm </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../launcher/abstract.html class=md-nav__link> <span class=md-ellipsis> launcher </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1_14_8 checked> <label class=md-nav__link for=__nav_3_1_1_14_8 id=__nav_3_1_1_14_8_label tabindex=0> <span class=md-ellipsis> loader </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_3_1_1_14_8_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1_14_8> <span class="md-nav__icon md-icon"></span> loader </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../abstract.html class=md-nav__link> <span class=md-ellipsis> abstract </span> </a> </li> <li class=md-nav__item> <a href=../control.html class=md-nav__link> <span class=md-ellipsis> control </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1_14_8_3 checked> <label class=md-nav__link for=__nav_3_1_1_14_8_3 id=__nav_3_1_1_14_8_3_label tabindex=0> <span class=md-ellipsis> models </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=6 aria-labelledby=__nav_3_1_1_14_8_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1_14_8_3> <span class="md-nav__icon md-icon"></span> models </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=actions.html class=md-nav__link> <span class=md-ellipsis> actions </span> </a> </li> <li class=md-nav__item> <a href=products.html class=md-nav__link> <span class=md-ellipsis> products </span> </a> </li> <li class=md-nav__item> <a href=selection.html class=md-nav__link> <span class=md-ellipsis> selection </span> </a> </li> <li class=md-nav__item> <a href=sitesync.html class=md-nav__link> <span class=md-ellipsis> sitesync </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../ui/_multicombobox.html class=md-nav__link> <span class=md-ellipsis> ui </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../publisher/abstract.html class=md-nav__link> <span class=md-ellipsis> publisher </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../push_to_project/control.html class=md-nav__link> <span class=md-ellipsis> push_to_project </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../resources/index.html class=md-nav__link> <span class=md-ellipsis> resources </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../sceneinventory/control.html class=md-nav__link> <span class=md-ellipsis> sceneinventory </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../stdout_broker/broker.html class=md-nav__link> <span class=md-ellipsis> stdout_broker </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../texture_copy/app.html class=md-nav__link> <span class=md-ellipsis> texture_copy </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../tray/lib.html class=md-nav__link> <span class=md-ellipsis> tray </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../utils/color_widgets/color_inputs.html class=md-nav__link> <span class=md-ellipsis> utils </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../workfile_template_build/lib.html class=md-nav__link> <span class=md-ellipsis> workfile_template_build </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../workfiles/abstract.html class=md-nav__link> <span class=md-ellipsis> workfiles </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../vendor/python/qargparse.html class=md-nav__link> <span class=md-ellipsis> vendor </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../../version.html class=md-nav__link> <span class=md-ellipsis> version </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../../server/settings/conversion.html class=md-nav__link> <span class=md-ellipsis> server </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models class=md-nav__link> <span class=md-ellipsis> models </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.LoaderActionsModel class=md-nav__link> <span class=md-ellipsis> LoaderActionsModel </span> </a> <nav class=md-nav aria-label=LoaderActionsModel> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.LoaderActionsModel.get_representations_action_items class=md-nav__link> <span class=md-ellipsis> get_representations_action_items </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.LoaderActionsModel.get_versions_action_items class=md-nav__link> <span class=md-ellipsis> get_versions_action_items </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.LoaderActionsModel.reset class=md-nav__link> <span class=md-ellipsis> reset </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.LoaderActionsModel.trigger_action_item class=md-nav__link> <span class=md-ellipsis> trigger_action_item </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.ProductsModel class=md-nav__link> <span class=md-ellipsis> ProductsModel </span> </a> <nav class=md-nav aria-label=ProductsModel> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.ProductsModel.change_products_group class=md-nav__link> <span class=md-ellipsis> change_products_group </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.ProductsModel.get_product_base_type_items class=md-nav__link> <span class=md-ellipsis> get_product_base_type_items </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.ProductsModel.get_product_ids_by_repre_ids class=md-nav__link> <span class=md-ellipsis> get_product_ids_by_repre_ids </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.ProductsModel.get_product_item class=md-nav__link> <span class=md-ellipsis> get_product_item </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.ProductsModel.get_product_items class=md-nav__link> <span class=md-ellipsis> get_product_items </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.ProductsModel.get_product_type_items class=md-nav__link> <span class=md-ellipsis> get_product_type_items </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.ProductsModel.get_repre_items class=md-nav__link> <span class=md-ellipsis> get_repre_items </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.ProductsModel.get_versions_repre_count class=md-nav__link> <span class=md-ellipsis> get_versions_repre_count </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.ProductsModel.reset class=md-nav__link> <span class=md-ellipsis> reset </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.SelectionModel class=md-nav__link> <span class=md-ellipsis> SelectionModel </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.SiteSyncModel class=md-nav__link> <span class=md-ellipsis> SiteSyncModel </span> </a> <nav class=md-nav aria-label=SiteSyncModel> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.SiteSyncModel.get_active_site class=md-nav__link> <span class=md-ellipsis> get_active_site </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.SiteSyncModel.get_active_site_icon_def class=md-nav__link> <span class=md-ellipsis> get_active_site_icon_def </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.SiteSyncModel.get_remote_site class=md-nav__link> <span class=md-ellipsis> get_remote_site </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.SiteSyncModel.get_remote_site_icon_def class=md-nav__link> <span class=md-ellipsis> get_remote_site_icon_def </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.SiteSyncModel.get_representations_sync_status class=md-nav__link> <span class=md-ellipsis> get_representations_sync_status </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.SiteSyncModel.get_sitesync_action_items class=md-nav__link> <span class=md-ellipsis> get_sitesync_action_items </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.SiteSyncModel.get_version_sync_availability class=md-nav__link> <span class=md-ellipsis> get_version_sync_availability </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.SiteSyncModel.is_sitesync_action class=md-nav__link> <span class=md-ellipsis> is_sitesync_action </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.SiteSyncModel.is_sitesync_enabled class=md-nav__link> <span class=md-ellipsis> is_sitesync_enabled </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_core.tools.loader.models.SiteSyncModel.trigger_action_item class=md-nav__link> <span class=md-ellipsis> trigger_action_item </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>models</h1> <div class="doc doc-object doc-module"> <a id=client.ayon_core.tools.loader.models></a> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=client.ayon_core.tools.loader.models.LoaderActionsModel class="doc doc-heading"> <code>LoaderActionsModel</code> </h2> <div class="doc doc-contents "> <p>Model for loader actions.</p> <details class=todos open> <summary>TODOs</summary> <p>Deprecate 'qargparse' usage in loaders and implement conversion of 'ActionItem' to data (and 'from_data'). Use controller to get entities -&gt; possible only when loaders are able to handle AYON vs. OpenPype logic. Add missing site sync logic, and if possible remove it from loaders. Implement loader actions to replace load plugins. Ask loader actions to return action items instead of guessing them.</p> </details> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/actions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span>
<span class=normal>150</span>
<span class=normal>151</span>
<span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span>
<span class=normal>164</span>
<span class=normal>165</span>
<span class=normal>166</span>
<span class=normal>167</span>
<span class=normal>168</span>
<span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span>
<span class=normal>172</span>
<span class=normal>173</span>
<span class=normal>174</span>
<span class=normal>175</span>
<span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span>
<span class=normal>200</span>
<span class=normal>201</span>
<span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span>
<span class=normal>242</span>
<span class=normal>243</span>
<span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span>
<span class=normal>288</span>
<span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span>
<span class=normal>295</span>
<span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span>
<span class=normal>366</span>
<span class=normal>367</span>
<span class=normal>368</span>
<span class=normal>369</span>
<span class=normal>370</span>
<span class=normal>371</span>
<span class=normal>372</span>
<span class=normal>373</span>
<span class=normal>374</span>
<span class=normal>375</span>
<span class=normal>376</span>
<span class=normal>377</span>
<span class=normal>378</span>
<span class=normal>379</span>
<span class=normal>380</span>
<span class=normal>381</span>
<span class=normal>382</span>
<span class=normal>383</span>
<span class=normal>384</span>
<span class=normal>385</span>
<span class=normal>386</span>
<span class=normal>387</span>
<span class=normal>388</span>
<span class=normal>389</span>
<span class=normal>390</span>
<span class=normal>391</span>
<span class=normal>392</span>
<span class=normal>393</span>
<span class=normal>394</span>
<span class=normal>395</span>
<span class=normal>396</span>
<span class=normal>397</span>
<span class=normal>398</span>
<span class=normal>399</span>
<span class=normal>400</span>
<span class=normal>401</span>
<span class=normal>402</span>
<span class=normal>403</span>
<span class=normal>404</span>
<span class=normal>405</span>
<span class=normal>406</span>
<span class=normal>407</span>
<span class=normal>408</span>
<span class=normal>409</span>
<span class=normal>410</span>
<span class=normal>411</span>
<span class=normal>412</span>
<span class=normal>413</span>
<span class=normal>414</span>
<span class=normal>415</span>
<span class=normal>416</span>
<span class=normal>417</span>
<span class=normal>418</span>
<span class=normal>419</span>
<span class=normal>420</span>
<span class=normal>421</span>
<span class=normal>422</span>
<span class=normal>423</span>
<span class=normal>424</span>
<span class=normal>425</span>
<span class=normal>426</span>
<span class=normal>427</span>
<span class=normal>428</span>
<span class=normal>429</span>
<span class=normal>430</span>
<span class=normal>431</span>
<span class=normal>432</span>
<span class=normal>433</span>
<span class=normal>434</span>
<span class=normal>435</span>
<span class=normal>436</span>
<span class=normal>437</span>
<span class=normal>438</span>
<span class=normal>439</span>
<span class=normal>440</span>
<span class=normal>441</span>
<span class=normal>442</span>
<span class=normal>443</span>
<span class=normal>444</span>
<span class=normal>445</span>
<span class=normal>446</span>
<span class=normal>447</span>
<span class=normal>448</span>
<span class=normal>449</span>
<span class=normal>450</span>
<span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span>
<span class=normal>464</span>
<span class=normal>465</span>
<span class=normal>466</span>
<span class=normal>467</span>
<span class=normal>468</span>
<span class=normal>469</span>
<span class=normal>470</span>
<span class=normal>471</span>
<span class=normal>472</span>
<span class=normal>473</span>
<span class=normal>474</span>
<span class=normal>475</span>
<span class=normal>476</span>
<span class=normal>477</span>
<span class=normal>478</span>
<span class=normal>479</span>
<span class=normal>480</span>
<span class=normal>481</span>
<span class=normal>482</span>
<span class=normal>483</span>
<span class=normal>484</span>
<span class=normal>485</span>
<span class=normal>486</span>
<span class=normal>487</span>
<span class=normal>488</span>
<span class=normal>489</span>
<span class=normal>490</span>
<span class=normal>491</span>
<span class=normal>492</span>
<span class=normal>493</span>
<span class=normal>494</span>
<span class=normal>495</span>
<span class=normal>496</span>
<span class=normal>497</span>
<span class=normal>498</span>
<span class=normal>499</span>
<span class=normal>500</span>
<span class=normal>501</span>
<span class=normal>502</span>
<span class=normal>503</span>
<span class=normal>504</span>
<span class=normal>505</span>
<span class=normal>506</span>
<span class=normal>507</span>
<span class=normal>508</span>
<span class=normal>509</span>
<span class=normal>510</span>
<span class=normal>511</span>
<span class=normal>512</span>
<span class=normal>513</span>
<span class=normal>514</span>
<span class=normal>515</span>
<span class=normal>516</span>
<span class=normal>517</span>
<span class=normal>518</span>
<span class=normal>519</span>
<span class=normal>520</span>
<span class=normal>521</span>
<span class=normal>522</span>
<span class=normal>523</span>
<span class=normal>524</span>
<span class=normal>525</span>
<span class=normal>526</span>
<span class=normal>527</span>
<span class=normal>528</span>
<span class=normal>529</span>
<span class=normal>530</span>
<span class=normal>531</span>
<span class=normal>532</span>
<span class=normal>533</span>
<span class=normal>534</span>
<span class=normal>535</span>
<span class=normal>536</span>
<span class=normal>537</span>
<span class=normal>538</span>
<span class=normal>539</span>
<span class=normal>540</span>
<span class=normal>541</span>
<span class=normal>542</span>
<span class=normal>543</span>
<span class=normal>544</span>
<span class=normal>545</span>
<span class=normal>546</span>
<span class=normal>547</span>
<span class=normal>548</span>
<span class=normal>549</span>
<span class=normal>550</span>
<span class=normal>551</span>
<span class=normal>552</span>
<span class=normal>553</span>
<span class=normal>554</span>
<span class=normal>555</span>
<span class=normal>556</span>
<span class=normal>557</span>
<span class=normal>558</span>
<span class=normal>559</span>
<span class=normal>560</span>
<span class=normal>561</span>
<span class=normal>562</span>
<span class=normal>563</span>
<span class=normal>564</span>
<span class=normal>565</span>
<span class=normal>566</span>
<span class=normal>567</span>
<span class=normal>568</span>
<span class=normal>569</span>
<span class=normal>570</span>
<span class=normal>571</span>
<span class=normal>572</span>
<span class=normal>573</span>
<span class=normal>574</span>
<span class=normal>575</span>
<span class=normal>576</span>
<span class=normal>577</span>
<span class=normal>578</span>
<span class=normal>579</span>
<span class=normal>580</span>
<span class=normal>581</span>
<span class=normal>582</span>
<span class=normal>583</span>
<span class=normal>584</span>
<span class=normal>585</span>
<span class=normal>586</span>
<span class=normal>587</span>
<span class=normal>588</span>
<span class=normal>589</span>
<span class=normal>590</span>
<span class=normal>591</span>
<span class=normal>592</span>
<span class=normal>593</span>
<span class=normal>594</span>
<span class=normal>595</span>
<span class=normal>596</span>
<span class=normal>597</span>
<span class=normal>598</span>
<span class=normal>599</span>
<span class=normal>600</span>
<span class=normal>601</span>
<span class=normal>602</span>
<span class=normal>603</span>
<span class=normal>604</span>
<span class=normal>605</span>
<span class=normal>606</span>
<span class=normal>607</span>
<span class=normal>608</span>
<span class=normal>609</span>
<span class=normal>610</span>
<span class=normal>611</span>
<span class=normal>612</span>
<span class=normal>613</span>
<span class=normal>614</span>
<span class=normal>615</span>
<span class=normal>616</span>
<span class=normal>617</span>
<span class=normal>618</span>
<span class=normal>619</span>
<span class=normal>620</span>
<span class=normal>621</span>
<span class=normal>622</span>
<span class=normal>623</span>
<span class=normal>624</span>
<span class=normal>625</span>
<span class=normal>626</span>
<span class=normal>627</span>
<span class=normal>628</span>
<span class=normal>629</span>
<span class=normal>630</span>
<span class=normal>631</span>
<span class=normal>632</span>
<span class=normal>633</span>
<span class=normal>634</span>
<span class=normal>635</span>
<span class=normal>636</span>
<span class=normal>637</span>
<span class=normal>638</span>
<span class=normal>639</span>
<span class=normal>640</span>
<span class=normal>641</span>
<span class=normal>642</span>
<span class=normal>643</span>
<span class=normal>644</span>
<span class=normal>645</span>
<span class=normal>646</span>
<span class=normal>647</span>
<span class=normal>648</span>
<span class=normal>649</span>
<span class=normal>650</span>
<span class=normal>651</span>
<span class=normal>652</span>
<span class=normal>653</span>
<span class=normal>654</span>
<span class=normal>655</span>
<span class=normal>656</span>
<span class=normal>657</span>
<span class=normal>658</span>
<span class=normal>659</span>
<span class=normal>660</span>
<span class=normal>661</span>
<span class=normal>662</span>
<span class=normal>663</span>
<span class=normal>664</span>
<span class=normal>665</span>
<span class=normal>666</span>
<span class=normal>667</span>
<span class=normal>668</span>
<span class=normal>669</span>
<span class=normal>670</span>
<span class=normal>671</span>
<span class=normal>672</span>
<span class=normal>673</span>
<span class=normal>674</span>
<span class=normal>675</span>
<span class=normal>676</span>
<span class=normal>677</span>
<span class=normal>678</span>
<span class=normal>679</span>
<span class=normal>680</span>
<span class=normal>681</span>
<span class=normal>682</span>
<span class=normal>683</span>
<span class=normal>684</span>
<span class=normal>685</span>
<span class=normal>686</span>
<span class=normal>687</span>
<span class=normal>688</span>
<span class=normal>689</span>
<span class=normal>690</span>
<span class=normal>691</span>
<span class=normal>692</span>
<span class=normal>693</span>
<span class=normal>694</span>
<span class=normal>695</span>
<span class=normal>696</span>
<span class=normal>697</span>
<span class=normal>698</span>
<span class=normal>699</span>
<span class=normal>700</span>
<span class=normal>701</span>
<span class=normal>702</span>
<span class=normal>703</span>
<span class=normal>704</span>
<span class=normal>705</span>
<span class=normal>706</span>
<span class=normal>707</span>
<span class=normal>708</span>
<span class=normal>709</span>
<span class=normal>710</span>
<span class=normal>711</span>
<span class=normal>712</span>
<span class=normal>713</span>
<span class=normal>714</span>
<span class=normal>715</span>
<span class=normal>716</span>
<span class=normal>717</span>
<span class=normal>718</span>
<span class=normal>719</span>
<span class=normal>720</span>
<span class=normal>721</span>
<span class=normal>722</span>
<span class=normal>723</span>
<span class=normal>724</span>
<span class=normal>725</span>
<span class=normal>726</span>
<span class=normal>727</span>
<span class=normal>728</span>
<span class=normal>729</span>
<span class=normal>730</span>
<span class=normal>731</span>
<span class=normal>732</span>
<span class=normal>733</span>
<span class=normal>734</span>
<span class=normal>735</span>
<span class=normal>736</span>
<span class=normal>737</span>
<span class=normal>738</span>
<span class=normal>739</span>
<span class=normal>740</span>
<span class=normal>741</span>
<span class=normal>742</span>
<span class=normal>743</span>
<span class=normal>744</span>
<span class=normal>745</span>
<span class=normal>746</span>
<span class=normal>747</span>
<span class=normal>748</span>
<span class=normal>749</span>
<span class=normal>750</span>
<span class=normal>751</span>
<span class=normal>752</span>
<span class=normal>753</span>
<span class=normal>754</span>
<span class=normal>755</span>
<span class=normal>756</span>
<span class=normal>757</span>
<span class=normal>758</span>
<span class=normal>759</span>
<span class=normal>760</span>
<span class=normal>761</span>
<span class=normal>762</span>
<span class=normal>763</span>
<span class=normal>764</span>
<span class=normal>765</span>
<span class=normal>766</span>
<span class=normal>767</span>
<span class=normal>768</span>
<span class=normal>769</span>
<span class=normal>770</span>
<span class=normal>771</span>
<span class=normal>772</span>
<span class=normal>773</span>
<span class=normal>774</span>
<span class=normal>775</span>
<span class=normal>776</span>
<span class=normal>777</span>
<span class=normal>778</span>
<span class=normal>779</span>
<span class=normal>780</span>
<span class=normal>781</span>
<span class=normal>782</span>
<span class=normal>783</span>
<span class=normal>784</span>
<span class=normal>785</span>
<span class=normal>786</span>
<span class=normal>787</span>
<span class=normal>788</span>
<span class=normal>789</span>
<span class=normal>790</span>
<span class=normal>791</span>
<span class=normal>792</span>
<span class=normal>793</span>
<span class=normal>794</span>
<span class=normal>795</span>
<span class=normal>796</span>
<span class=normal>797</span>
<span class=normal>798</span>
<span class=normal>799</span>
<span class=normal>800</span>
<span class=normal>801</span>
<span class=normal>802</span>
<span class=normal>803</span>
<span class=normal>804</span>
<span class=normal>805</span>
<span class=normal>806</span>
<span class=normal>807</span>
<span class=normal>808</span>
<span class=normal>809</span>
<span class=normal>810</span>
<span class=normal>811</span>
<span class=normal>812</span>
<span class=normal>813</span>
<span class=normal>814</span>
<span class=normal>815</span>
<span class=normal>816</span>
<span class=normal>817</span>
<span class=normal>818</span>
<span class=normal>819</span>
<span class=normal>820</span>
<span class=normal>821</span>
<span class=normal>822</span>
<span class=normal>823</span>
<span class=normal>824</span>
<span class=normal>825</span>
<span class=normal>826</span>
<span class=normal>827</span>
<span class=normal>828</span>
<span class=normal>829</span>
<span class=normal>830</span>
<span class=normal>831</span>
<span class=normal>832</span>
<span class=normal>833</span>
<span class=normal>834</span>
<span class=normal>835</span>
<span class=normal>836</span>
<span class=normal>837</span>
<span class=normal>838</span>
<span class=normal>839</span>
<span class=normal>840</span>
<span class=normal>841</span>
<span class=normal>842</span>
<span class=normal>843</span>
<span class=normal>844</span>
<span class=normal>845</span>
<span class=normal>846</span>
<span class=normal>847</span>
<span class=normal>848</span>
<span class=normal>849</span>
<span class=normal>850</span>
<span class=normal>851</span>
<span class=normal>852</span>
<span class=normal>853</span>
<span class=normal>854</span>
<span class=normal>855</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>LoaderActionsModel</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Model for loader actions.</span>

<span class=sd>    TODOs:</span>
<span class=sd>        Deprecate &#39;qargparse&#39; usage in loaders and implement conversion</span>
<span class=sd>            of &#39;ActionItem&#39; to data (and &#39;from_data&#39;).</span>
<span class=sd>        Use controller to get entities -&gt; possible only when</span>
<span class=sd>            loaders are able to handle AYON vs. OpenPype logic.</span>
<span class=sd>        Add missing site sync logic, and if possible remove it from loaders.</span>
<span class=sd>        Implement loader actions to replace load plugins.</span>
<span class=sd>        Ask loader actions to return action items instead of guessing them.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=c1># Cache loader plugins for some time</span>
    <span class=c1># NOTE Set to &#39;0&#39; for development</span>
    <span class=n>loaders_cache_lifetime</span> <span class=o>=</span> <span class=mi>30</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>controller</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span> <span class=o>=</span> <span class=n>controller</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_current_context_project</span> <span class=o>=</span> <span class=n>NOT_SET</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_loaders_by_identifier</span> <span class=o>=</span> <span class=n>NestedCacheItem</span><span class=p>(</span>
            <span class=n>levels</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lifetime</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>loaders_cache_lifetime</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_product_loaders</span> <span class=o>=</span> <span class=n>NestedCacheItem</span><span class=p>(</span>
            <span class=n>levels</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lifetime</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>loaders_cache_lifetime</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_repre_loaders</span> <span class=o>=</span> <span class=n>NestedCacheItem</span><span class=p>(</span>
            <span class=n>levels</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lifetime</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>loaders_cache_lifetime</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>reset</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Reset the model with all cached items.&quot;&quot;&quot;</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_current_context_project</span> <span class=o>=</span> <span class=n>NOT_SET</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_loaders_by_identifier</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_product_loaders</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_repre_loaders</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_versions_action_items</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Get action items for given version ids.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            version_ids (Iterable[str]): Version ids.</span>

<span class=sd>        Returns:</span>
<span class=sd>            list[ActionItem]: List of action items.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=p>(</span>
            <span class=n>version_context_by_id</span><span class=p>,</span>
            <span class=n>repre_context_by_id</span>
        <span class=p>)</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_contexts_for_versions</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span>
            <span class=n>version_ids</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_action_items_for_contexts</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span>
            <span class=n>version_context_by_id</span><span class=p>,</span>
            <span class=n>repre_context_by_id</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_representations_action_items</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span>
    <span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Get action items for given representation ids.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            representation_ids (Iterable[str]): Representation ids.</span>

<span class=sd>        Returns:</span>
<span class=sd>            list[ActionItem]: List of action items.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=p>(</span>
            <span class=n>product_context_by_id</span><span class=p>,</span>
            <span class=n>repre_context_by_id</span>
        <span class=p>)</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_contexts_for_representations</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span>
            <span class=n>representation_ids</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_action_items_for_contexts</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span>
            <span class=n>product_context_by_id</span><span class=p>,</span>
            <span class=n>repre_context_by_id</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>trigger_action_item</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>identifier</span><span class=p>,</span>
        <span class=n>options</span><span class=p>,</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>version_ids</span><span class=p>,</span>
        <span class=n>representation_ids</span>
    <span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Trigger action by identifier.</span>

<span class=sd>        Triggers the action by identifier for given contexts.</span>

<span class=sd>        Triggers events &quot;load.started&quot; and &quot;load.finished&quot;. Finished event</span>
<span class=sd>            also contains &quot;error_info&quot; key with error information if any</span>
<span class=sd>            happened.</span>

<span class=sd>        Args:</span>
<span class=sd>            identifier (str): Loader identifier.</span>
<span class=sd>            options (dict[str, Any]): Loader option values.</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            version_ids (Iterable[str]): Version ids.</span>
<span class=sd>            representation_ids (Iterable[str]): Representation ids.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>event_data</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;identifier&quot;</span><span class=p>:</span> <span class=n>identifier</span><span class=p>,</span>
            <span class=s2>&quot;id&quot;</span><span class=p>:</span> <span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>()</span><span class=o>.</span><span class=n>hex</span><span class=p>,</span>
        <span class=p>}</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>emit_event</span><span class=p>(</span>
            <span class=s2>&quot;load.started&quot;</span><span class=p>,</span>
            <span class=n>event_data</span><span class=p>,</span>
            <span class=n>ACTIONS_MODEL_SENDER</span><span class=p>,</span>
        <span class=p>)</span>
        <span class=n>loader</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_loader_by_identifier</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>identifier</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>representation_ids</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>error_info</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_trigger_representation_loader</span><span class=p>(</span>
                <span class=n>loader</span><span class=p>,</span>
                <span class=n>options</span><span class=p>,</span>
                <span class=n>project_name</span><span class=p>,</span>
                <span class=n>representation_ids</span><span class=p>,</span>
            <span class=p>)</span>
        <span class=k>elif</span> <span class=n>version_ids</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>error_info</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_trigger_version_loader</span><span class=p>(</span>
                <span class=n>loader</span><span class=p>,</span>
                <span class=n>options</span><span class=p>,</span>
                <span class=n>project_name</span><span class=p>,</span>
                <span class=n>version_ids</span><span class=p>,</span>
            <span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>NotImplementedError</span><span class=p>(</span>
                <span class=s2>&quot;Invalid arguments to trigger action item&quot;</span><span class=p>)</span>

        <span class=n>event_data</span><span class=p>[</span><span class=s2>&quot;error_info&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>error_info</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>emit_event</span><span class=p>(</span>
            <span class=s2>&quot;load.finished&quot;</span><span class=p>,</span>
            <span class=n>event_data</span><span class=p>,</span>
            <span class=n>ACTIONS_MODEL_SENDER</span><span class=p>,</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_current_context_project</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Get current context project name.</span>

<span class=sd>        The value is based on controller (host) and cached.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Union[str, None]: Current context project.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_current_context_project</span> <span class=ow>is</span> <span class=n>NOT_SET</span><span class=p>:</span>
            <span class=n>context</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>get_current_context</span><span class=p>()</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_current_context_project</span> <span class=o>=</span> <span class=n>context</span><span class=p>[</span><span class=s2>&quot;project_name&quot;</span><span class=p>]</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_current_context_project</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_action_label</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>loader</span><span class=p>,</span> <span class=n>representation</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Pull label info from loader class.</span>

<span class=sd>        Args:</span>
<span class=sd>            loader (LoaderPlugin): Plugin class.</span>
<span class=sd>            representation (Optional[dict[str, Any]]): Representation data.</span>

<span class=sd>        Returns:</span>
<span class=sd>            str: Action label.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>label</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>loader</span><span class=p>,</span> <span class=s2>&quot;label&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>label</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>label</span> <span class=o>=</span> <span class=n>loader</span><span class=o>.</span><span class=vm>__name__</span>
        <span class=k>if</span> <span class=n>representation</span><span class=p>:</span>
            <span class=c1># Add the representation as suffix</span>
            <span class=n>label</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>{}</span><span class=s2> (</span><span class=si>{}</span><span class=s2>)&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=n>representation</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>])</span>
        <span class=k>return</span> <span class=n>label</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_action_icon</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>loader</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Pull icon info from loader class.</span>

<span class=sd>        Args:</span>
<span class=sd>            loader (LoaderPlugin): Plugin class.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Union[dict[str, Any], None]: Icon definition based on</span>
<span class=sd>                loader plugin.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=c1># Support font-awesome icons using the `.icon` and `.color`</span>
        <span class=c1># attributes on plug-ins.</span>
        <span class=n>icon</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>loader</span><span class=p>,</span> <span class=s2>&quot;icon&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>icon</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>icon</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
            <span class=n>icon</span> <span class=o>=</span> <span class=p>{</span>
                <span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=s2>&quot;awesome-font&quot;</span><span class=p>,</span>
                <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>icon</span><span class=p>,</span>
                <span class=s2>&quot;color&quot;</span><span class=p>:</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>loader</span><span class=p>,</span> <span class=s2>&quot;color&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span> <span class=ow>or</span> <span class=s2>&quot;white&quot;</span>
            <span class=p>}</span>
        <span class=k>return</span> <span class=n>icon</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_action_tooltip</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>loader</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Pull tooltip info from loader class.</span>

<span class=sd>        Args:</span>
<span class=sd>            loader (LoaderPlugin): Plugin class.</span>

<span class=sd>        Returns:</span>
<span class=sd>            str: Action tooltip.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=c1># Add tooltip and statustip from Loader docstring</span>
        <span class=k>return</span> <span class=n>inspect</span><span class=o>.</span><span class=n>getdoc</span><span class=p>(</span><span class=n>loader</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_filter_loaders_by_tool_name</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>loaders</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Filter loaders by tool name.</span>

<span class=sd>        Tool names are based on AYON tools loader tool and library</span>
<span class=sd>        loader tool. The new tool merged both into one tool and the difference</span>
<span class=sd>        is based only on current project name.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            loaders (list[LoaderPlugin]): List of loader plugins.</span>

<span class=sd>        Returns:</span>
<span class=sd>            list[LoaderPlugin]: Filtered list of loader plugins.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=c1># Keep filtering by tool name</span>
        <span class=c1># - if current context project name is same as project name we do</span>
        <span class=c1>#   expect the tool is used as AYON loader tool, otherwise</span>
        <span class=c1>#   as library loader tool.</span>
        <span class=k>if</span> <span class=n>project_name</span> <span class=o>==</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_current_context_project</span><span class=p>():</span>
            <span class=n>tool_name</span> <span class=o>=</span> <span class=s2>&quot;loader&quot;</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>tool_name</span> <span class=o>=</span> <span class=s2>&quot;library_loader&quot;</span>
        <span class=n>filtered_loaders</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>for</span> <span class=n>loader</span> <span class=ow>in</span> <span class=n>loaders</span><span class=p>:</span>
            <span class=n>tool_names</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>loader</span><span class=p>,</span> <span class=s2>&quot;tool_names&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
            <span class=k>if</span> <span class=p>(</span>
                <span class=n>tool_names</span> <span class=ow>is</span> <span class=kc>None</span>
                <span class=ow>or</span> <span class=s2>&quot;*&quot;</span> <span class=ow>in</span> <span class=n>tool_names</span>
                <span class=ow>or</span> <span class=n>tool_name</span> <span class=ow>in</span> <span class=n>tool_names</span>
            <span class=p>):</span>
                <span class=n>filtered_loaders</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>loader</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>filtered_loaders</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_create_loader_action_item</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>loader</span><span class=p>,</span>
        <span class=n>contexts</span><span class=p>,</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>folder_ids</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>product_ids</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>version_ids</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>representation_ids</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>repre_name</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=p>):</span>
        <span class=n>label</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_action_label</span><span class=p>(</span><span class=n>loader</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>repre_name</span><span class=p>:</span>
            <span class=n>label</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>{}</span><span class=s2> (</span><span class=si>{}</span><span class=s2>)&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=n>repre_name</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>ActionItem</span><span class=p>(</span>
            <span class=n>get_loader_identifier</span><span class=p>(</span><span class=n>loader</span><span class=p>),</span>
            <span class=n>label</span><span class=o>=</span><span class=n>label</span><span class=p>,</span>
            <span class=n>icon</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_get_action_icon</span><span class=p>(</span><span class=n>loader</span><span class=p>),</span>
            <span class=n>tooltip</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_get_action_tooltip</span><span class=p>(</span><span class=n>loader</span><span class=p>),</span>
            <span class=n>options</span><span class=o>=</span><span class=n>loader</span><span class=o>.</span><span class=n>get_options</span><span class=p>(</span><span class=n>contexts</span><span class=p>),</span>
            <span class=n>order</span><span class=o>=</span><span class=n>loader</span><span class=o>.</span><span class=n>order</span><span class=p>,</span>
            <span class=n>project_name</span><span class=o>=</span><span class=n>project_name</span><span class=p>,</span>
            <span class=n>folder_ids</span><span class=o>=</span><span class=n>folder_ids</span><span class=p>,</span>
            <span class=n>product_ids</span><span class=o>=</span><span class=n>product_ids</span><span class=p>,</span>
            <span class=n>version_ids</span><span class=o>=</span><span class=n>version_ids</span><span class=p>,</span>
            <span class=n>representation_ids</span><span class=o>=</span><span class=n>representation_ids</span><span class=p>,</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_loaders</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Loaders with loaded settings for a project.</span>

<span class=sd>        Questions:</span>
<span class=sd>            Project name is required because of settings. Should we actually</span>
<span class=sd>                pass in current project name instead of project name where</span>
<span class=sd>                we want to show loaders for?</span>

<span class=sd>        Returns:</span>
<span class=sd>            tuple[list[ProductLoaderPlugin], list[LoaderPlugin]]: Discovered</span>
<span class=sd>                loader plugins.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>loaders_by_identifier_c</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_loaders_by_identifier</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=n>product_loaders_c</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_loaders</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=n>repre_loaders_c</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_repre_loaders</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=k>if</span> <span class=n>loaders_by_identifier_c</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>product_loaders_c</span><span class=o>.</span><span class=n>get_data</span><span class=p>(),</span> <span class=n>repre_loaders_c</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>

        <span class=c1># Get all representation-&gt;loader combinations available for the</span>
        <span class=c1># index under the cursor, so we can list the user the options.</span>
        <span class=n>available_loaders</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_filter_loaders_by_tool_name</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>discover_loader_plugins</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
        <span class=p>)</span>
        <span class=n>repre_loaders</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=n>product_loaders</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=n>loaders_by_identifier</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>for</span> <span class=n>loader_cls</span> <span class=ow>in</span> <span class=n>available_loaders</span><span class=p>:</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>loader_cls</span><span class=o>.</span><span class=n>enabled</span><span class=p>:</span>
                <span class=k>continue</span>

            <span class=n>identifier</span> <span class=o>=</span> <span class=n>get_loader_identifier</span><span class=p>(</span><span class=n>loader_cls</span><span class=p>)</span>
            <span class=n>loaders_by_identifier</span><span class=p>[</span><span class=n>identifier</span><span class=p>]</span> <span class=o>=</span> <span class=n>loader_cls</span>
            <span class=k>if</span> <span class=nb>issubclass</span><span class=p>(</span><span class=n>loader_cls</span><span class=p>,</span> <span class=n>ProductLoaderPlugin</span><span class=p>):</span>
                <span class=n>product_loaders</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>loader_cls</span><span class=p>)</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>repre_loaders</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>loader_cls</span><span class=p>)</span>

        <span class=n>loaders_by_identifier_c</span><span class=o>.</span><span class=n>update_data</span><span class=p>(</span><span class=n>loaders_by_identifier</span><span class=p>)</span>
        <span class=n>product_loaders_c</span><span class=o>.</span><span class=n>update_data</span><span class=p>(</span><span class=n>product_loaders</span><span class=p>)</span>
        <span class=n>repre_loaders_c</span><span class=o>.</span><span class=n>update_data</span><span class=p>(</span><span class=n>repre_loaders</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>product_loaders</span><span class=p>,</span> <span class=n>repre_loaders</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_loader_by_identifier</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>identifier</span><span class=p>):</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_loaders_by_identifier</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_get_loaders</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
        <span class=n>loaders_by_identifier_c</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_loaders_by_identifier</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=n>loaders_by_identifier</span> <span class=o>=</span> <span class=n>loaders_by_identifier_c</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>loaders_by_identifier</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>identifier</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_actions_sorter</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>action_item</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Sort the Loaders by their order and then their name.</span>

<span class=sd>        Returns:</span>
<span class=sd>            tuple[int, str]: Sort keys.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>return</span> <span class=n>action_item</span><span class=o>.</span><span class=n>order</span><span class=p>,</span> <span class=n>action_item</span><span class=o>.</span><span class=n>label</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_contexts_for_versions</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Get contexts for given version ids.</span>

<span class=sd>        Prepare version contexts for &#39;ProductLoaderPlugin&#39; and representation</span>
<span class=sd>        contexts for &#39;LoaderPlugin&#39; for all children representations of</span>
<span class=sd>        given versions.</span>

<span class=sd>        This method is very similar to &#39;_contexts_for_representations&#39; but the</span>
<span class=sd>        queries of entities are called in a different order.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            version_ids (Iterable[str]): Version ids.</span>

<span class=sd>        Returns:</span>
<span class=sd>            tuple[list[dict[str, Any]], list[dict[str, Any]]]: Version and</span>
<span class=sd>                representation contexts.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=c1># TODO fix hero version</span>
        <span class=n>version_context_by_id</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=n>repre_context_by_id</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>project_name</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>version_ids</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>version_context_by_id</span><span class=p>,</span> <span class=n>repre_context_by_id</span>

        <span class=n>version_entities</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_versions</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=o>=</span><span class=n>version_ids</span>
        <span class=p>)</span>
        <span class=n>version_entities_by_id</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=n>version_entities_by_product_id</span> <span class=o>=</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>version_entity</span> <span class=ow>in</span> <span class=n>version_entities</span><span class=p>:</span>
            <span class=n>version_id</span> <span class=o>=</span> <span class=n>version_entity</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span>
            <span class=n>product_id</span> <span class=o>=</span> <span class=n>version_entity</span><span class=p>[</span><span class=s2>&quot;productId&quot;</span><span class=p>]</span>
            <span class=n>version_entities_by_id</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>version_entity</span>
            <span class=n>version_entities_by_product_id</span><span class=p>[</span><span class=n>product_id</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>version_entity</span><span class=p>)</span>

        <span class=n>_product_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>version_entities_by_product_id</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
        <span class=n>_product_entities</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_products</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span><span class=o>=</span><span class=n>_product_ids</span>
        <span class=p>)</span>
        <span class=n>product_entities_by_id</span> <span class=o>=</span> <span class=p>{</span><span class=n>p</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]:</span> <span class=n>p</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>_product_entities</span><span class=p>}</span>

        <span class=n>_folder_ids</span> <span class=o>=</span> <span class=p>{</span><span class=n>p</span><span class=p>[</span><span class=s2>&quot;folderId&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>product_entities_by_id</span><span class=o>.</span><span class=n>values</span><span class=p>()}</span>
        <span class=n>_folder_entities</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_folders</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>folder_ids</span><span class=o>=</span><span class=n>_folder_ids</span>
        <span class=p>)</span>
        <span class=n>folder_entities_by_id</span> <span class=o>=</span> <span class=p>{</span><span class=n>f</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]:</span> <span class=n>f</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>_folder_entities</span><span class=p>}</span>

        <span class=n>project_entity</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_project</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>

        <span class=k>for</span> <span class=n>version_id</span><span class=p>,</span> <span class=n>version_entity</span> <span class=ow>in</span> <span class=n>version_entities_by_id</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=n>product_id</span> <span class=o>=</span> <span class=n>version_entity</span><span class=p>[</span><span class=s2>&quot;productId&quot;</span><span class=p>]</span>
            <span class=n>product_entity</span> <span class=o>=</span> <span class=n>product_entities_by_id</span><span class=p>[</span><span class=n>product_id</span><span class=p>]</span>
            <span class=n>folder_id</span> <span class=o>=</span> <span class=n>product_entity</span><span class=p>[</span><span class=s2>&quot;folderId&quot;</span><span class=p>]</span>
            <span class=n>folder_entity</span> <span class=o>=</span> <span class=n>folder_entities_by_id</span><span class=p>[</span><span class=n>folder_id</span><span class=p>]</span>
            <span class=n>version_context_by_id</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
                <span class=s2>&quot;project&quot;</span><span class=p>:</span> <span class=n>project_entity</span><span class=p>,</span>
                <span class=s2>&quot;folder&quot;</span><span class=p>:</span> <span class=n>folder_entity</span><span class=p>,</span>
                <span class=s2>&quot;product&quot;</span><span class=p>:</span> <span class=n>product_entity</span><span class=p>,</span>
                <span class=s2>&quot;version&quot;</span><span class=p>:</span> <span class=n>version_entity</span><span class=p>,</span>
            <span class=p>}</span>

        <span class=n>repre_entities</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_representations</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=o>=</span><span class=n>version_ids</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>repre_entity</span> <span class=ow>in</span> <span class=n>repre_entities</span><span class=p>:</span>
            <span class=n>version_id</span> <span class=o>=</span> <span class=n>repre_entity</span><span class=p>[</span><span class=s2>&quot;versionId&quot;</span><span class=p>]</span>
            <span class=n>version_entity</span> <span class=o>=</span> <span class=n>version_entities_by_id</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
            <span class=n>product_id</span> <span class=o>=</span> <span class=n>version_entity</span><span class=p>[</span><span class=s2>&quot;productId&quot;</span><span class=p>]</span>
            <span class=n>product_entity</span> <span class=o>=</span> <span class=n>product_entities_by_id</span><span class=p>[</span><span class=n>product_id</span><span class=p>]</span>
            <span class=n>folder_id</span> <span class=o>=</span> <span class=n>product_entity</span><span class=p>[</span><span class=s2>&quot;folderId&quot;</span><span class=p>]</span>
            <span class=n>folder_entity</span> <span class=o>=</span> <span class=n>folder_entities_by_id</span><span class=p>[</span><span class=n>folder_id</span><span class=p>]</span>

            <span class=n>repre_context_by_id</span><span class=p>[</span><span class=n>repre_entity</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]]</span> <span class=o>=</span> <span class=p>{</span>
                <span class=s2>&quot;project&quot;</span><span class=p>:</span> <span class=n>project_entity</span><span class=p>,</span>
                <span class=s2>&quot;folder&quot;</span><span class=p>:</span> <span class=n>folder_entity</span><span class=p>,</span>
                <span class=s2>&quot;product&quot;</span><span class=p>:</span> <span class=n>product_entity</span><span class=p>,</span>
                <span class=s2>&quot;version&quot;</span><span class=p>:</span> <span class=n>version_entity</span><span class=p>,</span>
                <span class=s2>&quot;representation&quot;</span><span class=p>:</span> <span class=n>repre_entity</span><span class=p>,</span>
            <span class=p>}</span>

        <span class=k>return</span> <span class=n>version_context_by_id</span><span class=p>,</span> <span class=n>repre_context_by_id</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_contexts_for_representations</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_ids</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Get contexts for given representation ids.</span>

<span class=sd>        Prepare version contexts for &#39;ProductLoaderPlugin&#39; and representation</span>
<span class=sd>        contexts for &#39;LoaderPlugin&#39; for all children representations of</span>
<span class=sd>        given versions.</span>

<span class=sd>        This method is very similar to &#39;_contexts_for_versions&#39; but the</span>
<span class=sd>        queries of entities are called in a different order.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            repre_ids (Iterable[str]): Representation ids.</span>

<span class=sd>        Returns:</span>
<span class=sd>            tuple[list[dict[str, Any]], list[dict[str, Any]]]: Version and</span>
<span class=sd>                representation contexts.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>product_context_by_id</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=n>repre_context_by_id</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>project_name</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>repre_ids</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>product_context_by_id</span><span class=p>,</span> <span class=n>repre_context_by_id</span>

        <span class=n>repre_entities</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>ayon_api</span><span class=o>.</span><span class=n>get_representations</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span><span class=o>=</span><span class=n>repre_ids</span>
        <span class=p>))</span>
        <span class=n>version_ids</span> <span class=o>=</span> <span class=p>{</span><span class=n>r</span><span class=p>[</span><span class=s2>&quot;versionId&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>r</span> <span class=ow>in</span> <span class=n>repre_entities</span><span class=p>}</span>
        <span class=n>version_entities</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_versions</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=o>=</span><span class=n>version_ids</span>
        <span class=p>)</span>
        <span class=n>version_entities_by_id</span> <span class=o>=</span> <span class=p>{</span>
            <span class=n>v</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]:</span> <span class=n>v</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>version_entities</span>
        <span class=p>}</span>

        <span class=n>product_ids</span> <span class=o>=</span> <span class=p>{</span><span class=n>v</span><span class=p>[</span><span class=s2>&quot;productId&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>version_entities_by_id</span><span class=o>.</span><span class=n>values</span><span class=p>()}</span>
        <span class=n>product_entities</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_products</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span><span class=o>=</span><span class=n>product_ids</span>
        <span class=p>)</span>
        <span class=n>product_entities_by_id</span> <span class=o>=</span> <span class=p>{</span>
            <span class=n>p</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]:</span> <span class=n>p</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>product_entities</span>
        <span class=p>}</span>

        <span class=n>folder_ids</span> <span class=o>=</span> <span class=p>{</span><span class=n>p</span><span class=p>[</span><span class=s2>&quot;folderId&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>product_entities_by_id</span><span class=o>.</span><span class=n>values</span><span class=p>()}</span>
        <span class=n>folder_entities</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_folders</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>folder_ids</span><span class=o>=</span><span class=n>folder_ids</span>
        <span class=p>)</span>
        <span class=n>folder_entities_by_id</span> <span class=o>=</span> <span class=p>{</span>
            <span class=n>f</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]:</span> <span class=n>f</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>folder_entities</span>
        <span class=p>}</span>

        <span class=n>project_entity</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_project</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>

        <span class=k>for</span> <span class=n>product_id</span><span class=p>,</span> <span class=n>product_entity</span> <span class=ow>in</span> <span class=n>product_entities_by_id</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=n>folder_id</span> <span class=o>=</span> <span class=n>product_entity</span><span class=p>[</span><span class=s2>&quot;folderId&quot;</span><span class=p>]</span>
            <span class=n>folder_entity</span> <span class=o>=</span> <span class=n>folder_entities_by_id</span><span class=p>[</span><span class=n>folder_id</span><span class=p>]</span>
            <span class=n>product_context_by_id</span><span class=p>[</span><span class=n>product_id</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
                <span class=s2>&quot;project&quot;</span><span class=p>:</span> <span class=n>project_entity</span><span class=p>,</span>
                <span class=s2>&quot;folder&quot;</span><span class=p>:</span> <span class=n>folder_entity</span><span class=p>,</span>
                <span class=s2>&quot;product&quot;</span><span class=p>:</span> <span class=n>product_entity</span><span class=p>,</span>
            <span class=p>}</span>

        <span class=k>for</span> <span class=n>repre_entity</span> <span class=ow>in</span> <span class=n>repre_entities</span><span class=p>:</span>
            <span class=n>version_id</span> <span class=o>=</span> <span class=n>repre_entity</span><span class=p>[</span><span class=s2>&quot;versionId&quot;</span><span class=p>]</span>
            <span class=n>version_entity</span> <span class=o>=</span> <span class=n>version_entities_by_id</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
            <span class=n>product_id</span> <span class=o>=</span> <span class=n>version_entity</span><span class=p>[</span><span class=s2>&quot;productId&quot;</span><span class=p>]</span>
            <span class=n>product_entity</span> <span class=o>=</span> <span class=n>product_entities_by_id</span><span class=p>[</span><span class=n>product_id</span><span class=p>]</span>
            <span class=n>folder_id</span> <span class=o>=</span> <span class=n>product_entity</span><span class=p>[</span><span class=s2>&quot;folderId&quot;</span><span class=p>]</span>
            <span class=n>folder_entity</span> <span class=o>=</span> <span class=n>folder_entities_by_id</span><span class=p>[</span><span class=n>folder_id</span><span class=p>]</span>

            <span class=n>repre_context_by_id</span><span class=p>[</span><span class=n>repre_entity</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]]</span> <span class=o>=</span> <span class=p>{</span>
                <span class=s2>&quot;project&quot;</span><span class=p>:</span> <span class=n>project_entity</span><span class=p>,</span>
                <span class=s2>&quot;folder&quot;</span><span class=p>:</span> <span class=n>folder_entity</span><span class=p>,</span>
                <span class=s2>&quot;product&quot;</span><span class=p>:</span> <span class=n>product_entity</span><span class=p>,</span>
                <span class=s2>&quot;version&quot;</span><span class=p>:</span> <span class=n>version_entity</span><span class=p>,</span>
                <span class=s2>&quot;representation&quot;</span><span class=p>:</span> <span class=n>repre_entity</span><span class=p>,</span>
            <span class=p>}</span>
        <span class=k>return</span> <span class=n>product_context_by_id</span><span class=p>,</span> <span class=n>repre_context_by_id</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_action_items_for_contexts</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>version_context_by_id</span><span class=p>,</span>
        <span class=n>repre_context_by_id</span>
    <span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Prepare action items based on contexts.</span>

<span class=sd>        Actions are prepared based on discovered loader plugins and contexts.</span>
<span class=sd>        The context must be valid for the loader plugin.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            version_context_by_id (dict[str, dict[str, Any]]): Version</span>
<span class=sd>                contexts by version id.</span>
<span class=sd>            repre_context_by_id (dict[str, dict[str, Any]]): Representation</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>action_items</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>version_context_by_id</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>repre_context_by_id</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>action_items</span>

        <span class=n>product_loaders</span><span class=p>,</span> <span class=n>repre_loaders</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_loaders</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>

        <span class=n>repre_contexts_by_name</span> <span class=o>=</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>repre_context</span> <span class=ow>in</span> <span class=n>repre_context_by_id</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
            <span class=n>repre_name</span> <span class=o>=</span> <span class=n>repre_context</span><span class=p>[</span><span class=s2>&quot;representation&quot;</span><span class=p>][</span><span class=s2>&quot;name&quot;</span><span class=p>]</span>
            <span class=n>repre_contexts_by_name</span><span class=p>[</span><span class=n>repre_name</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>repre_context</span><span class=p>)</span>

        <span class=k>for</span> <span class=n>loader</span> <span class=ow>in</span> <span class=n>repre_loaders</span><span class=p>:</span>
            <span class=k>for</span> <span class=n>repre_name</span><span class=p>,</span> <span class=n>repre_contexts</span> <span class=ow>in</span> <span class=n>repre_contexts_by_name</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                <span class=n>filtered_repre_contexts</span> <span class=o>=</span> <span class=n>filter_repre_contexts_by_loader</span><span class=p>(</span>
                    <span class=n>repre_contexts</span><span class=p>,</span> <span class=n>loader</span><span class=p>)</span>
                <span class=k>if</span> <span class=ow>not</span> <span class=n>filtered_repre_contexts</span><span class=p>:</span>
                    <span class=k>continue</span>

                <span class=n>repre_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
                <span class=n>repre_version_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
                <span class=n>repre_product_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
                <span class=n>repre_folder_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
                <span class=k>for</span> <span class=n>repre_context</span> <span class=ow>in</span> <span class=n>filtered_repre_contexts</span><span class=p>:</span>
                    <span class=n>repre_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>repre_context</span><span class=p>[</span><span class=s2>&quot;representation&quot;</span><span class=p>][</span><span class=s2>&quot;id&quot;</span><span class=p>])</span>
                    <span class=n>repre_product_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>repre_context</span><span class=p>[</span><span class=s2>&quot;product&quot;</span><span class=p>][</span><span class=s2>&quot;id&quot;</span><span class=p>])</span>
                    <span class=n>repre_version_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>repre_context</span><span class=p>[</span><span class=s2>&quot;version&quot;</span><span class=p>][</span><span class=s2>&quot;id&quot;</span><span class=p>])</span>
                    <span class=n>repre_folder_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>repre_context</span><span class=p>[</span><span class=s2>&quot;folder&quot;</span><span class=p>][</span><span class=s2>&quot;id&quot;</span><span class=p>])</span>

                <span class=n>item</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_loader_action_item</span><span class=p>(</span>
                    <span class=n>loader</span><span class=p>,</span>
                    <span class=n>repre_contexts</span><span class=p>,</span>
                    <span class=n>project_name</span><span class=o>=</span><span class=n>project_name</span><span class=p>,</span>
                    <span class=n>folder_ids</span><span class=o>=</span><span class=n>repre_folder_ids</span><span class=p>,</span>
                    <span class=n>product_ids</span><span class=o>=</span><span class=n>repre_product_ids</span><span class=p>,</span>
                    <span class=n>version_ids</span><span class=o>=</span><span class=n>repre_version_ids</span><span class=p>,</span>
                    <span class=n>representation_ids</span><span class=o>=</span><span class=n>repre_ids</span><span class=p>,</span>
                    <span class=n>repre_name</span><span class=o>=</span><span class=n>repre_name</span><span class=p>,</span>
                <span class=p>)</span>
                <span class=n>action_items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>

        <span class=c1># Product Loaders.</span>
        <span class=n>version_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>version_context_by_id</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
        <span class=n>product_folder_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
        <span class=n>product_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
        <span class=k>for</span> <span class=n>product_context</span> <span class=ow>in</span> <span class=n>version_context_by_id</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
            <span class=n>product_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>product_context</span><span class=p>[</span><span class=s2>&quot;product&quot;</span><span class=p>][</span><span class=s2>&quot;id&quot;</span><span class=p>])</span>
            <span class=n>product_folder_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>product_context</span><span class=p>[</span><span class=s2>&quot;folder&quot;</span><span class=p>][</span><span class=s2>&quot;id&quot;</span><span class=p>])</span>

        <span class=n>version_contexts</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>version_context_by_id</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
        <span class=k>for</span> <span class=n>loader</span> <span class=ow>in</span> <span class=n>product_loaders</span><span class=p>:</span>
            <span class=n>item</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_loader_action_item</span><span class=p>(</span>
                <span class=n>loader</span><span class=p>,</span>
                <span class=n>version_contexts</span><span class=p>,</span>
                <span class=n>project_name</span><span class=o>=</span><span class=n>project_name</span><span class=p>,</span>
                <span class=n>folder_ids</span><span class=o>=</span><span class=n>product_folder_ids</span><span class=p>,</span>
                <span class=n>product_ids</span><span class=o>=</span><span class=n>product_ids</span><span class=p>,</span>
                <span class=n>version_ids</span><span class=o>=</span><span class=n>version_ids</span><span class=p>,</span>
            <span class=p>)</span>
            <span class=n>action_items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>

        <span class=n>action_items</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_actions_sorter</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>action_items</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_trigger_version_loader</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>loader</span><span class=p>,</span>
        <span class=n>options</span><span class=p>,</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>version_ids</span><span class=p>,</span>
    <span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Trigger version loader.</span>

<span class=sd>        This triggers &#39;load&#39; method of &#39;ProductLoaderPlugin&#39; for given version</span>
<span class=sd>        ids.</span>

<span class=sd>        Note:</span>
<span class=sd>            Even when the plugin is &#39;ProductLoaderPlugin&#39; it actually expects</span>
<span class=sd>                versions and should be named &#39;VersionLoaderPlugin&#39;. Because it</span>
<span class=sd>                is planned to refactor load system and introduce</span>
<span class=sd>                &#39;LoaderAction&#39; plugins it is not relevant to change it</span>
<span class=sd>                anymore.</span>

<span class=sd>        Args:</span>
<span class=sd>            loader (ProductLoaderPlugin): Loader plugin to use.</span>
<span class=sd>            options (dict): Option values for loader.</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            version_ids (Iterable[str]): Version ids.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>project_entity</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_project</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>

        <span class=n>version_entities</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>ayon_api</span><span class=o>.</span><span class=n>get_versions</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=o>=</span><span class=n>version_ids</span>
        <span class=p>))</span>
        <span class=n>product_ids</span> <span class=o>=</span> <span class=p>{</span><span class=n>v</span><span class=p>[</span><span class=s2>&quot;productId&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>version_entities</span><span class=p>}</span>
        <span class=n>product_entities</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_products</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span><span class=o>=</span><span class=n>product_ids</span>
        <span class=p>)</span>
        <span class=n>product_entities_by_id</span> <span class=o>=</span> <span class=p>{</span><span class=n>p</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]:</span> <span class=n>p</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>product_entities</span><span class=p>}</span>
        <span class=n>folder_ids</span> <span class=o>=</span> <span class=p>{</span><span class=n>p</span><span class=p>[</span><span class=s2>&quot;folderId&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>product_entities_by_id</span><span class=o>.</span><span class=n>values</span><span class=p>()}</span>
        <span class=n>folder_entities</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_folders</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>folder_ids</span><span class=o>=</span><span class=n>folder_ids</span>
        <span class=p>)</span>
        <span class=n>folder_entities_by_id</span> <span class=o>=</span> <span class=p>{</span><span class=n>f</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]:</span> <span class=n>f</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>folder_entities</span><span class=p>}</span>
        <span class=n>product_contexts</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>for</span> <span class=n>version_entity</span> <span class=ow>in</span> <span class=n>version_entities</span><span class=p>:</span>
            <span class=n>product_id</span> <span class=o>=</span> <span class=n>version_entity</span><span class=p>[</span><span class=s2>&quot;productId&quot;</span><span class=p>]</span>
            <span class=n>product_entity</span> <span class=o>=</span> <span class=n>product_entities_by_id</span><span class=p>[</span><span class=n>product_id</span><span class=p>]</span>
            <span class=n>folder_id</span> <span class=o>=</span> <span class=n>product_entity</span><span class=p>[</span><span class=s2>&quot;folderId&quot;</span><span class=p>]</span>
            <span class=n>folder_entity</span> <span class=o>=</span> <span class=n>folder_entities_by_id</span><span class=p>[</span><span class=n>folder_id</span><span class=p>]</span>
            <span class=n>product_contexts</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
                <span class=s2>&quot;project&quot;</span><span class=p>:</span> <span class=n>project_entity</span><span class=p>,</span>
                <span class=s2>&quot;folder&quot;</span><span class=p>:</span> <span class=n>folder_entity</span><span class=p>,</span>
                <span class=s2>&quot;product&quot;</span><span class=p>:</span> <span class=n>product_entity</span><span class=p>,</span>
                <span class=s2>&quot;version&quot;</span><span class=p>:</span> <span class=n>version_entity</span><span class=p>,</span>
            <span class=p>})</span>

        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_load_products_by_loader</span><span class=p>(</span>
            <span class=n>loader</span><span class=p>,</span> <span class=n>product_contexts</span><span class=p>,</span> <span class=n>options</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_trigger_representation_loader</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>loader</span><span class=p>,</span>
        <span class=n>options</span><span class=p>,</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>representation_ids</span><span class=p>,</span>
    <span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Trigger representation loader.</span>

<span class=sd>        This triggers &#39;load&#39; method of &#39;LoaderPlugin&#39; for given representation</span>
<span class=sd>            ids. For that are prepared contexts for each representation, with</span>
<span class=sd>            all parent entities.</span>

<span class=sd>        Args:</span>
<span class=sd>            loader (LoaderPlugin): Loader plugin to use.</span>
<span class=sd>            options (dict): Option values for loader.</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            representation_ids (Iterable[str]): Representation ids.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>project_entity</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_project</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
        <span class=n>repre_entities</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>ayon_api</span><span class=o>.</span><span class=n>get_representations</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span><span class=o>=</span><span class=n>representation_ids</span>
        <span class=p>))</span>
        <span class=n>version_ids</span> <span class=o>=</span> <span class=p>{</span><span class=n>r</span><span class=p>[</span><span class=s2>&quot;versionId&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>r</span> <span class=ow>in</span> <span class=n>repre_entities</span><span class=p>}</span>
        <span class=n>version_entities</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_versions</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=o>=</span><span class=n>version_ids</span>
        <span class=p>)</span>
        <span class=n>version_entities_by_id</span> <span class=o>=</span> <span class=p>{</span><span class=n>v</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]:</span> <span class=n>v</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>version_entities</span><span class=p>}</span>
        <span class=n>product_ids</span> <span class=o>=</span> <span class=p>{</span>
            <span class=n>v</span><span class=p>[</span><span class=s2>&quot;productId&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>version_entities_by_id</span><span class=o>.</span><span class=n>values</span><span class=p>()</span>
        <span class=p>}</span>
        <span class=n>product_entities</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_products</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span><span class=o>=</span><span class=n>product_ids</span>
        <span class=p>)</span>
        <span class=n>product_entities_by_id</span> <span class=o>=</span> <span class=p>{</span><span class=n>p</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]:</span> <span class=n>p</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>product_entities</span><span class=p>}</span>
        <span class=n>folder_ids</span> <span class=o>=</span> <span class=p>{</span><span class=n>p</span><span class=p>[</span><span class=s2>&quot;folderId&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>product_entities_by_id</span><span class=o>.</span><span class=n>values</span><span class=p>()}</span>
        <span class=n>folder_entities</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_folders</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>folder_ids</span><span class=o>=</span><span class=n>folder_ids</span>
        <span class=p>)</span>
        <span class=n>folder_entities_by_id</span> <span class=o>=</span> <span class=p>{</span><span class=n>f</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]:</span> <span class=n>f</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>folder_entities</span><span class=p>}</span>
        <span class=n>repre_contexts</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>for</span> <span class=n>repre_entity</span> <span class=ow>in</span> <span class=n>repre_entities</span><span class=p>:</span>
            <span class=n>version_id</span> <span class=o>=</span> <span class=n>repre_entity</span><span class=p>[</span><span class=s2>&quot;versionId&quot;</span><span class=p>]</span>
            <span class=n>version_entity</span> <span class=o>=</span> <span class=n>version_entities_by_id</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
            <span class=n>product_id</span> <span class=o>=</span> <span class=n>version_entity</span><span class=p>[</span><span class=s2>&quot;productId&quot;</span><span class=p>]</span>
            <span class=n>product_entity</span> <span class=o>=</span> <span class=n>product_entities_by_id</span><span class=p>[</span><span class=n>product_id</span><span class=p>]</span>
            <span class=n>folder_id</span> <span class=o>=</span> <span class=n>product_entity</span><span class=p>[</span><span class=s2>&quot;folderId&quot;</span><span class=p>]</span>
            <span class=n>folder_entity</span> <span class=o>=</span> <span class=n>folder_entities_by_id</span><span class=p>[</span><span class=n>folder_id</span><span class=p>]</span>
            <span class=n>repre_contexts</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
                <span class=s2>&quot;project&quot;</span><span class=p>:</span> <span class=n>project_entity</span><span class=p>,</span>
                <span class=s2>&quot;folder&quot;</span><span class=p>:</span> <span class=n>folder_entity</span><span class=p>,</span>
                <span class=s2>&quot;product&quot;</span><span class=p>:</span> <span class=n>product_entity</span><span class=p>,</span>
                <span class=s2>&quot;version&quot;</span><span class=p>:</span> <span class=n>version_entity</span><span class=p>,</span>
                <span class=s2>&quot;representation&quot;</span><span class=p>:</span> <span class=n>repre_entity</span><span class=p>,</span>
            <span class=p>})</span>

        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_load_representations_by_loader</span><span class=p>(</span>
            <span class=n>loader</span><span class=p>,</span> <span class=n>repre_contexts</span><span class=p>,</span> <span class=n>options</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_load_representations_by_loader</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>loader</span><span class=p>,</span>
        <span class=n>repre_contexts</span><span class=p>,</span>
        <span class=n>options</span>
    <span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Loops through list of repre_contexts and loads them with one loader</span>

<span class=sd>        Args:</span>
<span class=sd>            loader (LoaderPlugin): Loader plugin to use.</span>
<span class=sd>            repre_contexts (list[dict]): Full info about selected</span>
<span class=sd>                representations, containing repre, version, product, folder</span>
<span class=sd>                and project entities.</span>
<span class=sd>            options (dict): Data from options.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>error_info</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>for</span> <span class=n>repre_context</span> <span class=ow>in</span> <span class=n>repre_contexts</span><span class=p>:</span>
            <span class=n>version_entity</span> <span class=o>=</span> <span class=n>repre_context</span><span class=p>[</span><span class=s2>&quot;version&quot;</span><span class=p>]</span>
            <span class=n>version</span> <span class=o>=</span> <span class=n>version_entity</span><span class=p>[</span><span class=s2>&quot;version&quot;</span><span class=p>]</span>
            <span class=k>if</span> <span class=n>version</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
                <span class=n>version</span> <span class=o>=</span> <span class=s2>&quot;Hero&quot;</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=n>load_with_repre_context</span><span class=p>(</span>
                    <span class=n>loader</span><span class=p>,</span>
                    <span class=n>repre_context</span><span class=p>,</span>
                    <span class=n>options</span><span class=o>=</span><span class=n>options</span>
                <span class=p>)</span>

            <span class=k>except</span> <span class=n>IncompatibleLoaderError</span> <span class=k>as</span> <span class=n>exc</span><span class=p>:</span>
                <span class=nb>print</span><span class=p>(</span><span class=n>exc</span><span class=p>)</span>
                <span class=n>error_info</span><span class=o>.</span><span class=n>append</span><span class=p>((</span>
                    <span class=s2>&quot;Incompatible Loader&quot;</span><span class=p>,</span>
                    <span class=kc>None</span><span class=p>,</span>
                    <span class=n>repre_context</span><span class=p>[</span><span class=s2>&quot;representation&quot;</span><span class=p>][</span><span class=s2>&quot;name&quot;</span><span class=p>],</span>
                    <span class=n>repre_context</span><span class=p>[</span><span class=s2>&quot;product&quot;</span><span class=p>][</span><span class=s2>&quot;name&quot;</span><span class=p>],</span>
                    <span class=n>version</span>
                <span class=p>))</span>

            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>exc</span><span class=p>:</span>
                <span class=n>formatted_traceback</span> <span class=o>=</span> <span class=kc>None</span>
                <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>exc</span><span class=p>,</span> <span class=n>LoadError</span><span class=p>):</span>
                    <span class=n>exc_type</span><span class=p>,</span> <span class=n>exc_value</span><span class=p>,</span> <span class=n>exc_traceback</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>exc_info</span><span class=p>()</span>
                    <span class=n>formatted_traceback</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>traceback</span><span class=o>.</span><span class=n>format_exception</span><span class=p>(</span>
                        <span class=n>exc_type</span><span class=p>,</span> <span class=n>exc_value</span><span class=p>,</span> <span class=n>exc_traceback</span>
                    <span class=p>))</span>

                <span class=n>error_info</span><span class=o>.</span><span class=n>append</span><span class=p>((</span>
                    <span class=nb>str</span><span class=p>(</span><span class=n>exc</span><span class=p>),</span>
                    <span class=n>formatted_traceback</span><span class=p>,</span>
                    <span class=n>repre_context</span><span class=p>[</span><span class=s2>&quot;representation&quot;</span><span class=p>][</span><span class=s2>&quot;name&quot;</span><span class=p>],</span>
                    <span class=n>repre_context</span><span class=p>[</span><span class=s2>&quot;product&quot;</span><span class=p>][</span><span class=s2>&quot;name&quot;</span><span class=p>],</span>
                    <span class=n>version</span>
                <span class=p>))</span>
        <span class=k>return</span> <span class=n>error_info</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_load_products_by_loader</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>loader</span><span class=p>,</span>
        <span class=n>version_contexts</span><span class=p>,</span>
        <span class=n>options</span>
    <span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Triggers load with ProductLoader type of loaders.</span>

<span class=sd>        Warning:</span>
<span class=sd>            Plugin is named &#39;ProductLoader&#39; but version is passed to context</span>
<span class=sd>                too.</span>

<span class=sd>        Args:</span>
<span class=sd>            loader (ProductLoader): Loader used to load.</span>
<span class=sd>            version_contexts (list[dict[str, Any]]): For context for each</span>
<span class=sd>                version.</span>
<span class=sd>            options (dict[str, Any]): Options for loader that user could fill.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>error_info</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>if</span> <span class=n>loader</span><span class=o>.</span><span class=n>is_multiple_contexts_compatible</span><span class=p>:</span>
            <span class=n>product_names</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=k>for</span> <span class=n>context</span> <span class=ow>in</span> <span class=n>version_contexts</span><span class=p>:</span>
                <span class=n>product_name</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;product&quot;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name&quot;</span><span class=p>)</span> <span class=ow>or</span> <span class=s2>&quot;N/A&quot;</span>
                <span class=n>product_names</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=n>load_with_product_contexts</span><span class=p>(</span>
                    <span class=n>loader</span><span class=p>,</span>
                    <span class=n>version_contexts</span><span class=p>,</span>
                    <span class=n>options</span><span class=o>=</span><span class=n>options</span>
                <span class=p>)</span>
            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>exc</span><span class=p>:</span>
                <span class=n>formatted_traceback</span> <span class=o>=</span> <span class=kc>None</span>
                <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>exc</span><span class=p>,</span> <span class=n>LoadError</span><span class=p>):</span>
                    <span class=n>exc_type</span><span class=p>,</span> <span class=n>exc_value</span><span class=p>,</span> <span class=n>exc_traceback</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>exc_info</span><span class=p>()</span>
                    <span class=n>formatted_traceback</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>traceback</span><span class=o>.</span><span class=n>format_exception</span><span class=p>(</span>
                        <span class=n>exc_type</span><span class=p>,</span> <span class=n>exc_value</span><span class=p>,</span> <span class=n>exc_traceback</span>
                    <span class=p>))</span>
                <span class=n>error_info</span><span class=o>.</span><span class=n>append</span><span class=p>((</span>
                    <span class=nb>str</span><span class=p>(</span><span class=n>exc</span><span class=p>),</span>
                    <span class=n>formatted_traceback</span><span class=p>,</span>
                    <span class=kc>None</span><span class=p>,</span>
                    <span class=s2>&quot;, &quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>product_names</span><span class=p>),</span>
                    <span class=kc>None</span>
                <span class=p>))</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>for</span> <span class=n>version_context</span> <span class=ow>in</span> <span class=n>version_contexts</span><span class=p>:</span>
                <span class=n>product_name</span> <span class=o>=</span> <span class=p>(</span>
                    <span class=n>version_context</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;product&quot;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name&quot;</span><span class=p>)</span> <span class=ow>or</span> <span class=s2>&quot;N/A&quot;</span>
                <span class=p>)</span>
                <span class=k>try</span><span class=p>:</span>
                    <span class=n>load_with_product_context</span><span class=p>(</span>
                        <span class=n>loader</span><span class=p>,</span>
                        <span class=n>version_context</span><span class=p>,</span>
                        <span class=n>options</span><span class=o>=</span><span class=n>options</span>
                    <span class=p>)</span>

                <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>exc</span><span class=p>:</span>
                    <span class=n>formatted_traceback</span> <span class=o>=</span> <span class=kc>None</span>
                    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>exc</span><span class=p>,</span> <span class=n>LoadError</span><span class=p>):</span>
                        <span class=n>exc_type</span><span class=p>,</span> <span class=n>exc_value</span><span class=p>,</span> <span class=n>exc_traceback</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>exc_info</span><span class=p>()</span>
                        <span class=n>formatted_traceback</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
                            <span class=n>traceback</span><span class=o>.</span><span class=n>format_exception</span><span class=p>(</span>
                                <span class=n>exc_type</span><span class=p>,</span> <span class=n>exc_value</span><span class=p>,</span> <span class=n>exc_traceback</span>
                            <span class=p>)</span>
                        <span class=p>)</span>

                    <span class=n>error_info</span><span class=o>.</span><span class=n>append</span><span class=p>((</span>
                        <span class=nb>str</span><span class=p>(</span><span class=n>exc</span><span class=p>),</span>
                        <span class=n>formatted_traceback</span><span class=p>,</span>
                        <span class=kc>None</span><span class=p>,</span>
                        <span class=n>product_name</span><span class=p>,</span>
                        <span class=kc>None</span>
                    <span class=p>))</span>

        <span class=k>return</span> <span class=n>error_info</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.LoaderActionsModel.get_representations_action_items class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_representations_action_items</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Get action items for given representation ids.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Project name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>representation_ids</code> </td> <td> <code><span title=Iterable>Iterable</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Representation ids.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>list[ActionItem]: List of action items.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/actions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_representations_action_items</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get action items for given representation ids.</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (str): Project name.</span>
<span class=sd>        representation_ids (Iterable[str]): Representation ids.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list[ActionItem]: List of action items.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=p>(</span>
        <span class=n>product_context_by_id</span><span class=p>,</span>
        <span class=n>repre_context_by_id</span>
    <span class=p>)</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_contexts_for_representations</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>representation_ids</span>
    <span class=p>)</span>
    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_action_items_for_contexts</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>product_context_by_id</span><span class=p>,</span>
        <span class=n>repre_context_by_id</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.LoaderActionsModel.get_versions_action_items class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_versions_action_items</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Get action items for given version ids.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Project name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>version_ids</code> </td> <td> <code><span title=Iterable>Iterable</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Version ids.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>list[ActionItem]: List of action items.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/actions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>64</span>
<span class=normal>65</span>
<span class=normal>66</span>
<span class=normal>67</span>
<span class=normal>68</span>
<span class=normal>69</span>
<span class=normal>70</span>
<span class=normal>71</span>
<span class=normal>72</span>
<span class=normal>73</span>
<span class=normal>74</span>
<span class=normal>75</span>
<span class=normal>76</span>
<span class=normal>77</span>
<span class=normal>78</span>
<span class=normal>79</span>
<span class=normal>80</span>
<span class=normal>81</span>
<span class=normal>82</span>
<span class=normal>83</span>
<span class=normal>84</span>
<span class=normal>85</span>
<span class=normal>86</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_versions_action_items</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get action items for given version ids.</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (str): Project name.</span>
<span class=sd>        version_ids (Iterable[str]): Version ids.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list[ActionItem]: List of action items.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=p>(</span>
        <span class=n>version_context_by_id</span><span class=p>,</span>
        <span class=n>repre_context_by_id</span>
    <span class=p>)</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_contexts_for_versions</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>version_ids</span>
    <span class=p>)</span>
    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_action_items_for_contexts</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>version_context_by_id</span><span class=p>,</span>
        <span class=n>repre_context_by_id</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.LoaderActionsModel.reset class="doc doc-heading"> <code class="highlight language-python"><span class=n>reset</span><span class=p>()</span></code> </h3> <div class="doc doc-contents "> <p>Reset the model with all cached items.</p> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/actions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>reset</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Reset the model with all cached items.&quot;&quot;&quot;</span>

    <span class=bp>self</span><span class=o>.</span><span class=n>_current_context_project</span> <span class=o>=</span> <span class=n>NOT_SET</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_loaders_by_identifier</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_product_loaders</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_repre_loaders</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.LoaderActionsModel.trigger_action_item class="doc doc-heading"> <code class="highlight language-python"><span class=n>trigger_action_item</span><span class=p>(</span><span class=n>identifier</span><span class=p>,</span> <span class=n>options</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>,</span> <span class=n>representation_ids</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Trigger action by identifier.</p> <p>Triggers the action by identifier for given contexts.</p> <p>Triggers events "load.started" and "load.finished". Finished event also contains "error_info" key with error information if any happened.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>identifier</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Loader identifier.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>options</code> </td> <td> <code><span title=dict>dict</span>[<span title=str>str</span>, <span title=Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>Loader option values.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Project name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>version_ids</code> </td> <td> <code><span title=Iterable>Iterable</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Version ids.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>representation_ids</code> </td> <td> <code><span title=Iterable>Iterable</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Representation ids.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/actions.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span>
<span class=normal>150</span>
<span class=normal>151</span>
<span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span>
<span class=normal>164</span>
<span class=normal>165</span>
<span class=normal>166</span>
<span class=normal>167</span>
<span class=normal>168</span>
<span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>trigger_action_item</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span>
    <span class=n>identifier</span><span class=p>,</span>
    <span class=n>options</span><span class=p>,</span>
    <span class=n>project_name</span><span class=p>,</span>
    <span class=n>version_ids</span><span class=p>,</span>
    <span class=n>representation_ids</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Trigger action by identifier.</span>

<span class=sd>    Triggers the action by identifier for given contexts.</span>

<span class=sd>    Triggers events &quot;load.started&quot; and &quot;load.finished&quot;. Finished event</span>
<span class=sd>        also contains &quot;error_info&quot; key with error information if any</span>
<span class=sd>        happened.</span>

<span class=sd>    Args:</span>
<span class=sd>        identifier (str): Loader identifier.</span>
<span class=sd>        options (dict[str, Any]): Loader option values.</span>
<span class=sd>        project_name (str): Project name.</span>
<span class=sd>        version_ids (Iterable[str]): Version ids.</span>
<span class=sd>        representation_ids (Iterable[str]): Representation ids.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>event_data</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;identifier&quot;</span><span class=p>:</span> <span class=n>identifier</span><span class=p>,</span>
        <span class=s2>&quot;id&quot;</span><span class=p>:</span> <span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>()</span><span class=o>.</span><span class=n>hex</span><span class=p>,</span>
    <span class=p>}</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>emit_event</span><span class=p>(</span>
        <span class=s2>&quot;load.started&quot;</span><span class=p>,</span>
        <span class=n>event_data</span><span class=p>,</span>
        <span class=n>ACTIONS_MODEL_SENDER</span><span class=p>,</span>
    <span class=p>)</span>
    <span class=n>loader</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_loader_by_identifier</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>identifier</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>representation_ids</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>error_info</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_trigger_representation_loader</span><span class=p>(</span>
            <span class=n>loader</span><span class=p>,</span>
            <span class=n>options</span><span class=p>,</span>
            <span class=n>project_name</span><span class=p>,</span>
            <span class=n>representation_ids</span><span class=p>,</span>
        <span class=p>)</span>
    <span class=k>elif</span> <span class=n>version_ids</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>error_info</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_trigger_version_loader</span><span class=p>(</span>
            <span class=n>loader</span><span class=p>,</span>
            <span class=n>options</span><span class=p>,</span>
            <span class=n>project_name</span><span class=p>,</span>
            <span class=n>version_ids</span><span class=p>,</span>
        <span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>NotImplementedError</span><span class=p>(</span>
            <span class=s2>&quot;Invalid arguments to trigger action item&quot;</span><span class=p>)</span>

    <span class=n>event_data</span><span class=p>[</span><span class=s2>&quot;error_info&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>error_info</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>emit_event</span><span class=p>(</span>
        <span class=s2>&quot;load.finished&quot;</span><span class=p>,</span>
        <span class=n>event_data</span><span class=p>,</span>
        <span class=n>ACTIONS_MODEL_SENDER</span><span class=p>,</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=client.ayon_core.tools.loader.models.ProductsModel class="doc doc-heading"> <code>ProductsModel</code> </h2> <div class="doc doc-contents "> <p>Model for products, version and representation.</p> <p>All the entities are product based. This model prepares data for UI and caches it for faster access.</p> <details class=note open> <summary>Note</summary> <p>Data are not used for actions model because that would require to break OpenPype compatibility of 'LoaderPlugin's.</p> </details> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/products.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span>
<span class=normal>150</span>
<span class=normal>151</span>
<span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span>
<span class=normal>164</span>
<span class=normal>165</span>
<span class=normal>166</span>
<span class=normal>167</span>
<span class=normal>168</span>
<span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span>
<span class=normal>172</span>
<span class=normal>173</span>
<span class=normal>174</span>
<span class=normal>175</span>
<span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span>
<span class=normal>200</span>
<span class=normal>201</span>
<span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span>
<span class=normal>242</span>
<span class=normal>243</span>
<span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span>
<span class=normal>288</span>
<span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span>
<span class=normal>295</span>
<span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span>
<span class=normal>366</span>
<span class=normal>367</span>
<span class=normal>368</span>
<span class=normal>369</span>
<span class=normal>370</span>
<span class=normal>371</span>
<span class=normal>372</span>
<span class=normal>373</span>
<span class=normal>374</span>
<span class=normal>375</span>
<span class=normal>376</span>
<span class=normal>377</span>
<span class=normal>378</span>
<span class=normal>379</span>
<span class=normal>380</span>
<span class=normal>381</span>
<span class=normal>382</span>
<span class=normal>383</span>
<span class=normal>384</span>
<span class=normal>385</span>
<span class=normal>386</span>
<span class=normal>387</span>
<span class=normal>388</span>
<span class=normal>389</span>
<span class=normal>390</span>
<span class=normal>391</span>
<span class=normal>392</span>
<span class=normal>393</span>
<span class=normal>394</span>
<span class=normal>395</span>
<span class=normal>396</span>
<span class=normal>397</span>
<span class=normal>398</span>
<span class=normal>399</span>
<span class=normal>400</span>
<span class=normal>401</span>
<span class=normal>402</span>
<span class=normal>403</span>
<span class=normal>404</span>
<span class=normal>405</span>
<span class=normal>406</span>
<span class=normal>407</span>
<span class=normal>408</span>
<span class=normal>409</span>
<span class=normal>410</span>
<span class=normal>411</span>
<span class=normal>412</span>
<span class=normal>413</span>
<span class=normal>414</span>
<span class=normal>415</span>
<span class=normal>416</span>
<span class=normal>417</span>
<span class=normal>418</span>
<span class=normal>419</span>
<span class=normal>420</span>
<span class=normal>421</span>
<span class=normal>422</span>
<span class=normal>423</span>
<span class=normal>424</span>
<span class=normal>425</span>
<span class=normal>426</span>
<span class=normal>427</span>
<span class=normal>428</span>
<span class=normal>429</span>
<span class=normal>430</span>
<span class=normal>431</span>
<span class=normal>432</span>
<span class=normal>433</span>
<span class=normal>434</span>
<span class=normal>435</span>
<span class=normal>436</span>
<span class=normal>437</span>
<span class=normal>438</span>
<span class=normal>439</span>
<span class=normal>440</span>
<span class=normal>441</span>
<span class=normal>442</span>
<span class=normal>443</span>
<span class=normal>444</span>
<span class=normal>445</span>
<span class=normal>446</span>
<span class=normal>447</span>
<span class=normal>448</span>
<span class=normal>449</span>
<span class=normal>450</span>
<span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span>
<span class=normal>464</span>
<span class=normal>465</span>
<span class=normal>466</span>
<span class=normal>467</span>
<span class=normal>468</span>
<span class=normal>469</span>
<span class=normal>470</span>
<span class=normal>471</span>
<span class=normal>472</span>
<span class=normal>473</span>
<span class=normal>474</span>
<span class=normal>475</span>
<span class=normal>476</span>
<span class=normal>477</span>
<span class=normal>478</span>
<span class=normal>479</span>
<span class=normal>480</span>
<span class=normal>481</span>
<span class=normal>482</span>
<span class=normal>483</span>
<span class=normal>484</span>
<span class=normal>485</span>
<span class=normal>486</span>
<span class=normal>487</span>
<span class=normal>488</span>
<span class=normal>489</span>
<span class=normal>490</span>
<span class=normal>491</span>
<span class=normal>492</span>
<span class=normal>493</span>
<span class=normal>494</span>
<span class=normal>495</span>
<span class=normal>496</span>
<span class=normal>497</span>
<span class=normal>498</span>
<span class=normal>499</span>
<span class=normal>500</span>
<span class=normal>501</span>
<span class=normal>502</span>
<span class=normal>503</span>
<span class=normal>504</span>
<span class=normal>505</span>
<span class=normal>506</span>
<span class=normal>507</span>
<span class=normal>508</span>
<span class=normal>509</span>
<span class=normal>510</span>
<span class=normal>511</span>
<span class=normal>512</span>
<span class=normal>513</span>
<span class=normal>514</span>
<span class=normal>515</span>
<span class=normal>516</span>
<span class=normal>517</span>
<span class=normal>518</span>
<span class=normal>519</span>
<span class=normal>520</span>
<span class=normal>521</span>
<span class=normal>522</span>
<span class=normal>523</span>
<span class=normal>524</span>
<span class=normal>525</span>
<span class=normal>526</span>
<span class=normal>527</span>
<span class=normal>528</span>
<span class=normal>529</span>
<span class=normal>530</span>
<span class=normal>531</span>
<span class=normal>532</span>
<span class=normal>533</span>
<span class=normal>534</span>
<span class=normal>535</span>
<span class=normal>536</span>
<span class=normal>537</span>
<span class=normal>538</span>
<span class=normal>539</span>
<span class=normal>540</span>
<span class=normal>541</span>
<span class=normal>542</span>
<span class=normal>543</span>
<span class=normal>544</span>
<span class=normal>545</span>
<span class=normal>546</span>
<span class=normal>547</span>
<span class=normal>548</span>
<span class=normal>549</span>
<span class=normal>550</span>
<span class=normal>551</span>
<span class=normal>552</span>
<span class=normal>553</span>
<span class=normal>554</span>
<span class=normal>555</span>
<span class=normal>556</span>
<span class=normal>557</span>
<span class=normal>558</span>
<span class=normal>559</span>
<span class=normal>560</span>
<span class=normal>561</span>
<span class=normal>562</span>
<span class=normal>563</span>
<span class=normal>564</span>
<span class=normal>565</span>
<span class=normal>566</span>
<span class=normal>567</span>
<span class=normal>568</span>
<span class=normal>569</span>
<span class=normal>570</span>
<span class=normal>571</span>
<span class=normal>572</span>
<span class=normal>573</span>
<span class=normal>574</span>
<span class=normal>575</span>
<span class=normal>576</span>
<span class=normal>577</span>
<span class=normal>578</span>
<span class=normal>579</span>
<span class=normal>580</span>
<span class=normal>581</span>
<span class=normal>582</span>
<span class=normal>583</span>
<span class=normal>584</span>
<span class=normal>585</span>
<span class=normal>586</span>
<span class=normal>587</span>
<span class=normal>588</span>
<span class=normal>589</span>
<span class=normal>590</span>
<span class=normal>591</span>
<span class=normal>592</span>
<span class=normal>593</span>
<span class=normal>594</span>
<span class=normal>595</span>
<span class=normal>596</span>
<span class=normal>597</span>
<span class=normal>598</span>
<span class=normal>599</span>
<span class=normal>600</span>
<span class=normal>601</span>
<span class=normal>602</span>
<span class=normal>603</span>
<span class=normal>604</span>
<span class=normal>605</span>
<span class=normal>606</span>
<span class=normal>607</span>
<span class=normal>608</span>
<span class=normal>609</span>
<span class=normal>610</span>
<span class=normal>611</span>
<span class=normal>612</span>
<span class=normal>613</span>
<span class=normal>614</span>
<span class=normal>615</span>
<span class=normal>616</span>
<span class=normal>617</span>
<span class=normal>618</span>
<span class=normal>619</span>
<span class=normal>620</span>
<span class=normal>621</span>
<span class=normal>622</span>
<span class=normal>623</span>
<span class=normal>624</span>
<span class=normal>625</span>
<span class=normal>626</span>
<span class=normal>627</span>
<span class=normal>628</span>
<span class=normal>629</span>
<span class=normal>630</span>
<span class=normal>631</span>
<span class=normal>632</span>
<span class=normal>633</span>
<span class=normal>634</span>
<span class=normal>635</span>
<span class=normal>636</span>
<span class=normal>637</span>
<span class=normal>638</span>
<span class=normal>639</span>
<span class=normal>640</span>
<span class=normal>641</span>
<span class=normal>642</span>
<span class=normal>643</span>
<span class=normal>644</span>
<span class=normal>645</span>
<span class=normal>646</span>
<span class=normal>647</span>
<span class=normal>648</span>
<span class=normal>649</span>
<span class=normal>650</span>
<span class=normal>651</span>
<span class=normal>652</span>
<span class=normal>653</span>
<span class=normal>654</span>
<span class=normal>655</span>
<span class=normal>656</span>
<span class=normal>657</span>
<span class=normal>658</span>
<span class=normal>659</span>
<span class=normal>660</span>
<span class=normal>661</span>
<span class=normal>662</span>
<span class=normal>663</span>
<span class=normal>664</span>
<span class=normal>665</span>
<span class=normal>666</span>
<span class=normal>667</span>
<span class=normal>668</span>
<span class=normal>669</span>
<span class=normal>670</span>
<span class=normal>671</span>
<span class=normal>672</span>
<span class=normal>673</span>
<span class=normal>674</span>
<span class=normal>675</span>
<span class=normal>676</span>
<span class=normal>677</span>
<span class=normal>678</span>
<span class=normal>679</span>
<span class=normal>680</span>
<span class=normal>681</span>
<span class=normal>682</span>
<span class=normal>683</span>
<span class=normal>684</span>
<span class=normal>685</span>
<span class=normal>686</span>
<span class=normal>687</span>
<span class=normal>688</span>
<span class=normal>689</span>
<span class=normal>690</span>
<span class=normal>691</span>
<span class=normal>692</span>
<span class=normal>693</span>
<span class=normal>694</span>
<span class=normal>695</span>
<span class=normal>696</span>
<span class=normal>697</span>
<span class=normal>698</span>
<span class=normal>699</span>
<span class=normal>700</span>
<span class=normal>701</span>
<span class=normal>702</span>
<span class=normal>703</span>
<span class=normal>704</span>
<span class=normal>705</span>
<span class=normal>706</span>
<span class=normal>707</span>
<span class=normal>708</span>
<span class=normal>709</span>
<span class=normal>710</span>
<span class=normal>711</span>
<span class=normal>712</span>
<span class=normal>713</span>
<span class=normal>714</span>
<span class=normal>715</span>
<span class=normal>716</span>
<span class=normal>717</span>
<span class=normal>718</span>
<span class=normal>719</span>
<span class=normal>720</span>
<span class=normal>721</span>
<span class=normal>722</span>
<span class=normal>723</span>
<span class=normal>724</span>
<span class=normal>725</span>
<span class=normal>726</span>
<span class=normal>727</span>
<span class=normal>728</span>
<span class=normal>729</span>
<span class=normal>730</span>
<span class=normal>731</span>
<span class=normal>732</span>
<span class=normal>733</span>
<span class=normal>734</span>
<span class=normal>735</span>
<span class=normal>736</span>
<span class=normal>737</span>
<span class=normal>738</span>
<span class=normal>739</span>
<span class=normal>740</span>
<span class=normal>741</span>
<span class=normal>742</span>
<span class=normal>743</span>
<span class=normal>744</span>
<span class=normal>745</span>
<span class=normal>746</span>
<span class=normal>747</span>
<span class=normal>748</span>
<span class=normal>749</span>
<span class=normal>750</span>
<span class=normal>751</span>
<span class=normal>752</span>
<span class=normal>753</span>
<span class=normal>754</span>
<span class=normal>755</span>
<span class=normal>756</span>
<span class=normal>757</span>
<span class=normal>758</span>
<span class=normal>759</span>
<span class=normal>760</span>
<span class=normal>761</span>
<span class=normal>762</span>
<span class=normal>763</span>
<span class=normal>764</span>
<span class=normal>765</span>
<span class=normal>766</span>
<span class=normal>767</span>
<span class=normal>768</span>
<span class=normal>769</span>
<span class=normal>770</span>
<span class=normal>771</span>
<span class=normal>772</span>
<span class=normal>773</span>
<span class=normal>774</span>
<span class=normal>775</span>
<span class=normal>776</span>
<span class=normal>777</span>
<span class=normal>778</span>
<span class=normal>779</span>
<span class=normal>780</span>
<span class=normal>781</span>
<span class=normal>782</span>
<span class=normal>783</span>
<span class=normal>784</span>
<span class=normal>785</span>
<span class=normal>786</span>
<span class=normal>787</span>
<span class=normal>788</span>
<span class=normal>789</span>
<span class=normal>790</span>
<span class=normal>791</span>
<span class=normal>792</span>
<span class=normal>793</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>ProductsModel</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Model for products, version and representation.</span>

<span class=sd>    All the entities are product based. This model prepares data for UI</span>
<span class=sd>    and caches it for faster access.</span>

<span class=sd>    Note:</span>
<span class=sd>        Data are not used for actions model because that would require to</span>
<span class=sd>            break OpenPype compatibility of &#39;LoaderPlugin&#39;s.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>lifetime</span> <span class=o>=</span> <span class=mi>60</span>  <span class=c1># In seconds (minute by default)</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>controller</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span> <span class=o>=</span> <span class=n>controller</span>

        <span class=c1># Mapping helpers</span>
        <span class=c1># NOTE - mapping must be cleaned up with cache cleanup</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_product_item_by_id</span> <span class=o>=</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_version_item_by_id</span> <span class=o>=</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_product_folder_ids_mapping</span> <span class=o>=</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>

        <span class=c1># Cache helpers</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_product_type_items_cache</span> <span class=o>=</span> <span class=n>NestedCacheItem</span><span class=p>(</span>
            <span class=n>levels</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>default_factory</span><span class=o>=</span><span class=nb>list</span><span class=p>,</span> <span class=n>lifetime</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>lifetime</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_product_base_type_items_cache</span> <span class=o>=</span> <span class=n>NestedCacheItem</span><span class=p>(</span>
            <span class=n>levels</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>default_factory</span><span class=o>=</span><span class=nb>list</span><span class=p>,</span> <span class=n>lifetime</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>lifetime</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_product_items_cache</span> <span class=o>=</span> <span class=n>NestedCacheItem</span><span class=p>(</span>
            <span class=n>levels</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>default_factory</span><span class=o>=</span><span class=nb>dict</span><span class=p>,</span> <span class=n>lifetime</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>lifetime</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_repre_items_cache</span> <span class=o>=</span> <span class=n>NestedCacheItem</span><span class=p>(</span>
            <span class=n>levels</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>default_factory</span><span class=o>=</span><span class=nb>dict</span><span class=p>,</span> <span class=n>lifetime</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>lifetime</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>reset</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Reset model with all cached data.&quot;&quot;&quot;</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_product_item_by_id</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_version_item_by_id</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_product_folder_ids_mapping</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_product_type_items_cache</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_product_items_cache</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_repre_items_cache</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_product_type_items</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=n>ProductTypeItem</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Product type items for project.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (Union[str, None]): Project name.</span>

<span class=sd>        Returns:</span>
<span class=sd>            list[ProductTypeItem]: Product type items.</span>

<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>project_name</span><span class=p>:</span>
            <span class=k>return</span> <span class=p>[]</span>

        <span class=n>cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_type_items_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
            <span class=n>icons_mapping</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_product_type_icons</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
            <span class=n>product_types</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_project_product_types</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
            <span class=n>cache</span><span class=o>.</span><span class=n>update_data</span><span class=p>([</span>
                <span class=n>ProductTypeItem</span><span class=p>(</span>
                    <span class=n>product_type</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>],</span>
                    <span class=n>icons_mapping</span><span class=o>.</span><span class=n>get_icon</span><span class=p>(</span><span class=n>product_type</span><span class=o>=</span><span class=n>product_type</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]),</span>
                <span class=p>)</span>
                <span class=k>for</span> <span class=n>product_type</span> <span class=ow>in</span> <span class=n>product_types</span>
            <span class=p>])</span>
        <span class=k>return</span> <span class=n>cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_product_base_type_items</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=n>ProductBaseTypeItem</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Product base type items for the project.</span>

<span class=sd>        Notes:</span>
<span class=sd>            This will be used for filtering product types in UI when</span>
<span class=sd>                product base types are fully implemented.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (optional, str): Project name.</span>

<span class=sd>        Returns:</span>
<span class=sd>            list[ProductBaseTypeDict]: Product base type items.</span>

<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>project_name</span><span class=p>:</span>
            <span class=k>return</span> <span class=p>[]</span>

        <span class=n>cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_base_type_items_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
            <span class=n>icons_mapping</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_product_type_icons</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
            <span class=n>product_base_types</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=c1># TODO add temp implementation here when it is actually</span>
            <span class=c1>#   implemented and available on server.</span>
            <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>ayon_api</span><span class=p>,</span> <span class=s2>&quot;get_project_product_base_types&quot;</span><span class=p>):</span>
                <span class=n>product_base_types</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_project_product_base_types</span><span class=p>(</span>
                    <span class=n>project_name</span>
                <span class=p>)</span>
            <span class=n>cache</span><span class=o>.</span><span class=n>update_data</span><span class=p>([</span>
                <span class=n>ProductBaseTypeItem</span><span class=p>(</span>
                    <span class=n>product_base_type</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>],</span>
                    <span class=n>icons_mapping</span><span class=o>.</span><span class=n>get_icon</span><span class=p>(</span><span class=n>product_base_type</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]),</span>
                <span class=p>)</span>
                <span class=k>for</span> <span class=n>product_base_type</span> <span class=ow>in</span> <span class=n>product_base_types</span>
            <span class=p>])</span>
        <span class=k>return</span> <span class=n>cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_product_items</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>folder_ids</span><span class=p>,</span> <span class=n>sender</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Product items with versions for project and folder ids.</span>

<span class=sd>        Product items also contain version items. They&#39;re directly connected</span>
<span class=sd>        to product items in the UI and the separation is not needed.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (Union[str, None]): Project name.</span>
<span class=sd>            folder_ids (Iterable[str]): Folder ids.</span>
<span class=sd>            sender (Union[str, None]): Who triggered the method.</span>

<span class=sd>        Returns:</span>
<span class=sd>            list[ProductItem]: Product items.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>project_name</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>folder_ids</span><span class=p>:</span>
            <span class=k>return</span> <span class=p>[]</span>

        <span class=n>project_cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_items_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=n>output</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=n>folder_ids_to_update</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
        <span class=k>for</span> <span class=n>folder_id</span> <span class=ow>in</span> <span class=n>folder_ids</span><span class=p>:</span>
            <span class=n>cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>folder_id</span><span class=p>]</span>
            <span class=k>if</span> <span class=n>cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
                <span class=n>output</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>folder_ids_to_update</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>folder_id</span><span class=p>)</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_refresh_product_items</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>folder_ids_to_update</span><span class=p>,</span> <span class=n>sender</span><span class=p>)</span>

        <span class=k>for</span> <span class=n>folder_id</span> <span class=ow>in</span> <span class=n>folder_ids_to_update</span><span class=p>:</span>
            <span class=n>cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>folder_id</span><span class=p>]</span>
            <span class=n>output</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
        <span class=k>return</span> <span class=n>output</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_product_item</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>product_id</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Get product item based on passed product id.</span>

<span class=sd>        This method is using cached items, but if cache is not valid it also</span>
<span class=sd>        can query the item.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (Union[str, None]): Where to look for product.</span>
<span class=sd>            product_id (Union[str, None]): Product id to receive.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Union[ProductItem, None]: Product item or &#39;None&#39; if not found.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=nb>any</span><span class=p>((</span><span class=n>project_name</span><span class=p>,</span> <span class=n>product_id</span><span class=p>)):</span>
            <span class=k>return</span> <span class=kc>None</span>

        <span class=n>product_items_by_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_item_by_id</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=n>product_item</span> <span class=o>=</span> <span class=n>product_items_by_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>product_item</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>product_item</span>
        <span class=k>for</span> <span class=n>product_item</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_query_product_items_by_ids</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span><span class=o>=</span><span class=p>[</span><span class=n>product_id</span><span class=p>]</span>
        <span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
            <span class=k>return</span> <span class=n>product_item</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_product_ids_by_repre_ids</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_ids</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Get product ids based on passed representation ids.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Where to look for representations.</span>
<span class=sd>            repre_ids (Iterable[str]): Representation ids.</span>

<span class=sd>        Returns:</span>
<span class=sd>            set[str]: Product ids for passed representation ids.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=c1># TODO look out how to use single server call</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>repre_ids</span><span class=p>:</span>
            <span class=k>return</span> <span class=nb>set</span><span class=p>()</span>
        <span class=n>repres</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_representations</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_ids</span><span class=p>,</span> <span class=n>fields</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;versionId&quot;</span><span class=p>]</span>
        <span class=p>)</span>
        <span class=n>version_ids</span> <span class=o>=</span> <span class=p>{</span><span class=n>repre</span><span class=p>[</span><span class=s2>&quot;versionId&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>repre</span> <span class=ow>in</span> <span class=n>repres</span><span class=p>}</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>version_ids</span><span class=p>:</span>
            <span class=k>return</span> <span class=nb>set</span><span class=p>()</span>
        <span class=n>versions</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_versions</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=o>=</span><span class=n>version_ids</span><span class=p>,</span> <span class=n>fields</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;productId&quot;</span><span class=p>]</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=p>{</span><span class=n>v</span><span class=p>[</span><span class=s2>&quot;productId&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>versions</span><span class=p>}</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_repre_items</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>,</span> <span class=n>sender</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Get representation items for passed version ids.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            version_ids (Iterable[str]): Version ids.</span>
<span class=sd>            sender (Union[str, None]): Who triggered the method.</span>

<span class=sd>        Returns:</span>
<span class=sd>            list[RepreItem]: Representation items.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>output</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=nb>any</span><span class=p>((</span><span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>)):</span>
            <span class=k>return</span> <span class=n>output</span>

        <span class=n>invalid_version_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
        <span class=n>project_cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_repre_items_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>version_ids</span><span class=p>:</span>
            <span class=n>version_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
            <span class=k>if</span> <span class=n>version_cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
                <span class=n>output</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>version_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>invalid_version_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>version_id</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>invalid_version_ids</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>refresh_representation_items</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span> <span class=n>invalid_version_ids</span><span class=p>,</span> <span class=n>sender</span>
            <span class=p>)</span>

        <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>invalid_version_ids</span><span class=p>:</span>
            <span class=n>version_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
            <span class=n>output</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>version_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>

        <span class=k>return</span> <span class=n>output</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_versions_repre_count</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>,</span> <span class=n>sender</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Get representation count for passed version ids.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            version_ids (Iterable[str]): Version ids.</span>
<span class=sd>            sender (Union[str, None]): Who triggered the method.</span>

<span class=sd>        Returns:</span>
<span class=sd>            dict[str, int]: Number of representations by version id.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>output</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=nb>any</span><span class=p>((</span><span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>)):</span>
            <span class=k>return</span> <span class=n>output</span>

        <span class=n>invalid_version_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
        <span class=n>project_cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_repre_items_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>version_ids</span><span class=p>:</span>
            <span class=n>version_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
            <span class=k>if</span> <span class=n>version_cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
                <span class=n>output</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>version_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>())</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>invalid_version_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>version_id</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>invalid_version_ids</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>refresh_representation_items</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span> <span class=n>invalid_version_ids</span><span class=p>,</span> <span class=n>sender</span>
            <span class=p>)</span>

        <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>invalid_version_ids</span><span class=p>:</span>
            <span class=n>version_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
            <span class=n>output</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>version_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>())</span>

        <span class=k>return</span> <span class=n>output</span>

    <span class=k>def</span><span class=w> </span><span class=nf>change_products_group</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span><span class=p>,</span> <span class=n>group_name</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Change group name for passed product ids.</span>

<span class=sd>        Group name is stored in &#39;attrib&#39; of product entity and is used in UI</span>
<span class=sd>        to group items.</span>

<span class=sd>        Method triggers &quot;products.group.changed&quot; event with data:</span>
<span class=sd>            {</span>
<span class=sd>                &quot;project_name&quot;: project_name,</span>
<span class=sd>                &quot;folder_ids&quot;: folder_ids,</span>
<span class=sd>                &quot;product_ids&quot;: product_ids,</span>
<span class=sd>                &quot;group_name&quot;: group_name</span>
<span class=sd>            }</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            product_ids (Iterable[str]): Product ids to change group name for.</span>
<span class=sd>            group_name (str): Group name to set.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>product_ids</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=n>product_items</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_product_items_by_id</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span>
        <span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>product_items</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=n>session</span> <span class=o>=</span> <span class=n>OperationsSession</span><span class=p>()</span>
        <span class=n>folder_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
        <span class=k>for</span> <span class=n>product_item</span> <span class=ow>in</span> <span class=n>product_items</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
            <span class=n>session</span><span class=o>.</span><span class=n>update_entity</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span>
                <span class=s2>&quot;product&quot;</span><span class=p>,</span>
                <span class=n>product_item</span><span class=o>.</span><span class=n>product_id</span><span class=p>,</span>
                <span class=p>{</span><span class=s2>&quot;attrib&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;productGroup&quot;</span><span class=p>:</span> <span class=n>group_name</span><span class=p>}}</span>
            <span class=p>)</span>
            <span class=n>folder_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>product_item</span><span class=o>.</span><span class=n>folder_id</span><span class=p>)</span>
            <span class=n>product_item</span><span class=o>.</span><span class=n>group_name</span> <span class=o>=</span> <span class=n>group_name</span>

        <span class=n>session</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>emit_event</span><span class=p>(</span>
            <span class=s2>&quot;products.group.changed&quot;</span><span class=p>,</span>
            <span class=p>{</span>
                <span class=s2>&quot;project_name&quot;</span><span class=p>:</span> <span class=n>project_name</span><span class=p>,</span>
                <span class=s2>&quot;folder_ids&quot;</span><span class=p>:</span> <span class=n>folder_ids</span><span class=p>,</span>
                <span class=s2>&quot;product_ids&quot;</span><span class=p>:</span> <span class=n>product_ids</span><span class=p>,</span>
                <span class=s2>&quot;group_name&quot;</span><span class=p>:</span> <span class=n>group_name</span><span class=p>,</span>
            <span class=p>},</span>
            <span class=n>PRODUCTS_MODEL_SENDER</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_product_type_icons</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ProductTypeIconMapping</span><span class=p>:</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>get_product_type_icons_mapping</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_product_items_by_id</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span><span class=p>):</span>
        <span class=n>product_item_by_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_item_by_id</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=n>missing_product_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
        <span class=n>output</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>for</span> <span class=n>product_id</span> <span class=ow>in</span> <span class=n>product_ids</span><span class=p>:</span>
            <span class=n>product_item</span> <span class=o>=</span> <span class=n>product_item_by_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>product_item</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>output</span><span class=p>[</span><span class=n>product_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>product_item</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>missing_product_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span>

        <span class=n>output</span><span class=o>.</span><span class=n>update</span><span class=p>(</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_query_product_items_by_ids</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span><span class=o>=</span><span class=n>missing_product_ids</span>
            <span class=p>)</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=n>output</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_version_items_by_id</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>):</span>
        <span class=n>version_item_by_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_version_item_by_id</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=n>missing_version_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
        <span class=n>output</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>version_ids</span><span class=p>:</span>
            <span class=n>version_item</span> <span class=o>=</span> <span class=n>version_item_by_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>version_id</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>version_item</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>output</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>version_item</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>missing_version_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>version_id</span><span class=p>)</span>

        <span class=n>output</span><span class=o>.</span><span class=n>update</span><span class=p>(</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_query_version_items_by_ids</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span> <span class=n>missing_version_ids</span>
            <span class=p>)</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=n>output</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_create_product_items</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>project_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
        <span class=n>products</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>ProductDict</span><span class=p>],</span>
        <span class=n>versions</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>VersionDict</span><span class=p>],</span>
        <span class=n>folder_items</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=p>):</span>
        <span class=k>if</span> <span class=n>folder_items</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>folder_items</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>get_folder_items</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>

        <span class=n>loaded_product_ids</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>get_loaded_product_ids</span><span class=p>()</span>

        <span class=n>versions_by_product_id</span> <span class=o>=</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>version</span> <span class=ow>in</span> <span class=n>versions</span><span class=p>:</span>
            <span class=n>versions_by_product_id</span><span class=p>[</span><span class=n>version</span><span class=p>[</span><span class=s2>&quot;productId&quot;</span><span class=p>]]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>version</span><span class=p>)</span>

        <span class=n>output</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>ProductItem</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=n>icons_mapping</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_product_type_icons</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>product</span> <span class=ow>in</span> <span class=n>products</span><span class=p>:</span>
            <span class=n>product_id</span> <span class=o>=</span> <span class=n>product</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span>
            <span class=n>folder_id</span> <span class=o>=</span> <span class=n>product</span><span class=p>[</span><span class=s2>&quot;folderId&quot;</span><span class=p>]</span>
            <span class=n>folder_item</span> <span class=o>=</span> <span class=n>folder_items</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>folder_id</span><span class=p>)</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>folder_item</span><span class=p>:</span>
                <span class=k>continue</span>
            <span class=n>versions</span> <span class=o>=</span> <span class=n>versions_by_product_id</span><span class=p>[</span><span class=n>product_id</span><span class=p>]</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>versions</span><span class=p>:</span>
                <span class=k>continue</span>
            <span class=n>product_item</span> <span class=o>=</span> <span class=n>product_item_from_entity</span><span class=p>(</span>
                <span class=n>product</span><span class=p>,</span>
                <span class=n>versions</span><span class=p>,</span>
                <span class=n>folder_item</span><span class=o>.</span><span class=n>label</span><span class=p>,</span>
                <span class=n>icons_mapping</span><span class=p>,</span>
                <span class=n>product_id</span> <span class=ow>in</span> <span class=n>loaded_product_ids</span><span class=p>,</span>
            <span class=p>)</span>
            <span class=n>output</span><span class=p>[</span><span class=n>product_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>product_item</span>
        <span class=k>return</span> <span class=n>output</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_query_product_items_by_ids</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>folder_ids</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>product_ids</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>folder_items</span><span class=o>=</span><span class=kc>None</span>
    <span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Query product items.</span>

<span class=sd>        This method does get from, or store to, cache attributes.</span>

<span class=sd>        One of &#39;product_ids&#39; or &#39;folder_ids&#39; must be passed to the method.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            folder_ids (Optional[Iterable[str]]): Folder ids under which are</span>
<span class=sd>                products.</span>
<span class=sd>            product_ids (Optional[Iterable[str]]): Product ids to use.</span>
<span class=sd>            folder_items (Optional[Dict[str, FolderItem]]): Prepared folder</span>
<span class=sd>                items from controller.</span>

<span class=sd>        Returns:</span>
<span class=sd>            dict[str, ProductItem]: Product items by product id.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>folder_ids</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>product_ids</span><span class=p>:</span>
            <span class=k>return</span> <span class=p>{}</span>

        <span class=n>kwargs</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>if</span> <span class=n>folder_ids</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;folder_ids&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>folder_ids</span>

        <span class=k>if</span> <span class=n>product_ids</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;product_ids&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>product_ids</span>

        <span class=n>products</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>ayon_api</span><span class=o>.</span><span class=n>get_products</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>))</span>
        <span class=n>product_ids</span> <span class=o>=</span> <span class=p>{</span><span class=n>product</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>product</span> <span class=ow>in</span> <span class=n>products</span><span class=p>}</span>

        <span class=c1># Add &#39;status&#39; to fields -&gt; fixed in ayon-python-api 1.0.4</span>
        <span class=n>fields</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_default_fields_for_type</span><span class=p>(</span><span class=s2>&quot;version&quot;</span><span class=p>)</span>
        <span class=n>fields</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=s2>&quot;status&quot;</span><span class=p>)</span>
        <span class=n>versions</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_versions</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span><span class=o>=</span><span class=n>product_ids</span><span class=p>,</span> <span class=n>fields</span><span class=o>=</span><span class=n>fields</span>
        <span class=p>)</span>

        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_product_items</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>products</span><span class=p>,</span> <span class=n>versions</span><span class=p>,</span> <span class=n>folder_items</span><span class=o>=</span><span class=n>folder_items</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_query_version_items_by_ids</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>):</span>
        <span class=n>versions</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>ayon_api</span><span class=o>.</span><span class=n>get_versions</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=o>=</span><span class=n>version_ids</span>
        <span class=p>))</span>
        <span class=n>product_ids</span> <span class=o>=</span> <span class=p>{</span><span class=n>version</span><span class=p>[</span><span class=s2>&quot;productId&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>version</span> <span class=ow>in</span> <span class=n>versions</span><span class=p>}</span>
        <span class=n>products</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>ayon_api</span><span class=o>.</span><span class=n>get_products</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span><span class=o>=</span><span class=n>product_ids</span>
        <span class=p>))</span>
        <span class=n>product_items</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_product_items</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>products</span><span class=p>,</span> <span class=n>versions</span>
        <span class=p>)</span>
        <span class=n>version_items</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>for</span> <span class=n>product_item</span> <span class=ow>in</span> <span class=n>product_items</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
            <span class=n>version_items</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>product_item</span><span class=o>.</span><span class=n>version_items</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>version_items</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_clear_product_version_items</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>folder_ids</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Clear product and version items from memory.</span>

<span class=sd>        When products are re-queried for a folders, the old product and version</span>
<span class=sd>        items in &#39;_product_item_by_id&#39; and &#39;_version_item_by_id&#39; should</span>
<span class=sd>        be cleaned up from memory. And mapping in stored in</span>
<span class=sd>        &#39;_product_folder_ids_mapping&#39; is not relevant either.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Name of project.</span>
<span class=sd>            folder_ids (Iterable[str]): Folder ids which are being refreshed.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>project_mapping</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_folder_ids_mapping</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>project_mapping</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=n>product_item_by_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_item_by_id</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=n>version_item_by_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_version_item_by_id</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=k>for</span> <span class=n>folder_id</span> <span class=ow>in</span> <span class=n>folder_ids</span><span class=p>:</span>
            <span class=n>product_ids</span> <span class=o>=</span> <span class=n>project_mapping</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>folder_id</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>product_ids</span><span class=p>:</span>
                <span class=k>continue</span>

            <span class=k>for</span> <span class=n>product_id</span> <span class=ow>in</span> <span class=n>product_ids</span><span class=p>:</span>
                <span class=n>product_item</span> <span class=o>=</span> <span class=n>product_item_by_id</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>product_id</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
                <span class=k>if</span> <span class=n>product_item</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=k>continue</span>
                <span class=k>for</span> <span class=n>version_item</span> <span class=ow>in</span> <span class=n>product_item</span><span class=o>.</span><span class=n>version_items</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
                    <span class=n>version_item_by_id</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>version_item</span><span class=o>.</span><span class=n>version_id</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_refresh_product_items</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>folder_ids</span><span class=p>,</span> <span class=n>sender</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Refresh product items and store them in cache.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Name of project.</span>
<span class=sd>            folder_ids (Iterable[str]): Folder ids which are being refreshed.</span>
<span class=sd>            sender (Union[str, None]): Who triggered the refresh.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>project_name</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>folder_ids</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_clear_product_version_items</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>folder_ids</span><span class=p>)</span>

        <span class=n>project_mapping</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_folder_ids_mapping</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=n>product_item_by_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_item_by_id</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=n>version_item_by_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_version_item_by_id</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>

        <span class=k>for</span> <span class=n>folder_id</span> <span class=ow>in</span> <span class=n>folder_ids</span><span class=p>:</span>
            <span class=n>project_mapping</span><span class=p>[</span><span class=n>folder_id</span><span class=p>]</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>

        <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_refresh_event_manager</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>folder_ids</span><span class=p>,</span> <span class=n>sender</span>
        <span class=p>):</span>
            <span class=n>folder_items</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>get_folder_items</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
            <span class=n>items_by_folder_id</span> <span class=o>=</span> <span class=p>{</span>
                <span class=n>folder_id</span><span class=p>:</span> <span class=p>{}</span>
                <span class=k>for</span> <span class=n>folder_id</span> <span class=ow>in</span> <span class=n>folder_ids</span>
            <span class=p>}</span>
            <span class=n>product_items_by_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_query_product_items_by_ids</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span>
                <span class=n>folder_ids</span><span class=o>=</span><span class=n>folder_ids</span><span class=p>,</span>
                <span class=n>folder_items</span><span class=o>=</span><span class=n>folder_items</span>
            <span class=p>)</span>
            <span class=k>for</span> <span class=n>product_id</span><span class=p>,</span> <span class=n>product_item</span> <span class=ow>in</span> <span class=n>product_items_by_id</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                <span class=n>folder_id</span> <span class=o>=</span> <span class=n>product_item</span><span class=o>.</span><span class=n>folder_id</span>
                <span class=n>items_by_folder_id</span><span class=p>[</span><span class=n>product_item</span><span class=o>.</span><span class=n>folder_id</span><span class=p>][</span><span class=n>product_id</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
                    <span class=n>product_item</span>
                <span class=p>)</span>

                <span class=n>project_mapping</span><span class=p>[</span><span class=n>folder_id</span><span class=p>]</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span>
                <span class=n>product_item_by_id</span><span class=p>[</span><span class=n>product_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>product_item</span>
                <span class=k>for</span> <span class=n>version_id</span><span class=p>,</span> <span class=n>version_item</span> <span class=ow>in</span> <span class=p>(</span>
                    <span class=n>product_item</span><span class=o>.</span><span class=n>version_items</span><span class=o>.</span><span class=n>items</span><span class=p>()</span>
                <span class=p>):</span>
                    <span class=n>version_item_by_id</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>version_item</span>

            <span class=n>project_cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_items_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
            <span class=k>for</span> <span class=n>folder_id</span><span class=p>,</span> <span class=n>product_items</span> <span class=ow>in</span> <span class=n>items_by_folder_id</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                <span class=n>project_cache</span><span class=p>[</span><span class=n>folder_id</span><span class=p>]</span><span class=o>.</span><span class=n>update_data</span><span class=p>(</span><span class=n>product_items</span><span class=p>)</span>

    <span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_product_refresh_event_manager</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>folder_ids</span><span class=p>,</span> <span class=n>sender</span>
    <span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>emit_event</span><span class=p>(</span>
            <span class=s2>&quot;products.refresh.started&quot;</span><span class=p>,</span>
            <span class=p>{</span>
                <span class=s2>&quot;project_name&quot;</span><span class=p>:</span> <span class=n>project_name</span><span class=p>,</span>
                <span class=s2>&quot;folder_ids&quot;</span><span class=p>:</span> <span class=n>folder_ids</span><span class=p>,</span>
                <span class=s2>&quot;sender&quot;</span><span class=p>:</span> <span class=n>sender</span><span class=p>,</span>
            <span class=p>},</span>
            <span class=n>PRODUCTS_MODEL_SENDER</span>
        <span class=p>)</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=k>yield</span>

        <span class=k>finally</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>emit_event</span><span class=p>(</span>
                <span class=s2>&quot;products.refresh.finished&quot;</span><span class=p>,</span>
                <span class=p>{</span>
                    <span class=s2>&quot;project_name&quot;</span><span class=p>:</span> <span class=n>project_name</span><span class=p>,</span>
                    <span class=s2>&quot;folder_ids&quot;</span><span class=p>:</span> <span class=n>folder_ids</span><span class=p>,</span>
                    <span class=s2>&quot;sender&quot;</span><span class=p>:</span> <span class=n>sender</span><span class=p>,</span>
                <span class=p>},</span>
                <span class=n>PRODUCTS_MODEL_SENDER</span>
            <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>refresh_representation_items</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>,</span> <span class=n>sender</span>
    <span class=p>):</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=nb>any</span><span class=p>((</span><span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>)):</span>
            <span class=k>return</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>emit_event</span><span class=p>(</span>
            <span class=s2>&quot;model.representations.refresh.started&quot;</span><span class=p>,</span>
            <span class=p>{</span>
                <span class=s2>&quot;project_name&quot;</span><span class=p>:</span> <span class=n>project_name</span><span class=p>,</span>
                <span class=s2>&quot;version_ids&quot;</span><span class=p>:</span> <span class=n>version_ids</span><span class=p>,</span>
                <span class=s2>&quot;sender&quot;</span><span class=p>:</span> <span class=n>sender</span><span class=p>,</span>
            <span class=p>},</span>
            <span class=n>PRODUCTS_MODEL_SENDER</span>
        <span class=p>)</span>
        <span class=n>failed</span> <span class=o>=</span> <span class=kc>False</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_refresh_representation_items</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>)</span>
        <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
            <span class=c1># TODO add more information about failed refresh</span>
            <span class=n>failed</span> <span class=o>=</span> <span class=kc>True</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>emit_event</span><span class=p>(</span>
            <span class=s2>&quot;model.representations.refresh.finished&quot;</span><span class=p>,</span>
            <span class=p>{</span>
                <span class=s2>&quot;project_name&quot;</span><span class=p>:</span> <span class=n>project_name</span><span class=p>,</span>
                <span class=s2>&quot;version_ids&quot;</span><span class=p>:</span> <span class=n>version_ids</span><span class=p>,</span>
                <span class=s2>&quot;sender&quot;</span><span class=p>:</span> <span class=n>sender</span><span class=p>,</span>
                <span class=s2>&quot;failed&quot;</span><span class=p>:</span> <span class=n>failed</span><span class=p>,</span>
            <span class=p>},</span>
            <span class=n>PRODUCTS_MODEL_SENDER</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_refresh_representation_items</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>):</span>
        <span class=n>representations</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>ayon_api</span><span class=o>.</span><span class=n>get_representations</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span>
            <span class=n>version_ids</span><span class=o>=</span><span class=n>version_ids</span><span class=p>,</span>
            <span class=n>fields</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>,</span> <span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;versionId&quot;</span><span class=p>]</span>
        <span class=p>))</span>

        <span class=n>version_items_by_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_version_items_by_id</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span>
        <span class=p>)</span>
        <span class=n>product_ids</span> <span class=o>=</span> <span class=p>{</span>
            <span class=n>version_item</span><span class=o>.</span><span class=n>product_id</span>
            <span class=k>for</span> <span class=n>version_item</span> <span class=ow>in</span> <span class=n>version_items_by_id</span><span class=o>.</span><span class=n>values</span><span class=p>()</span>
        <span class=p>}</span>
        <span class=n>product_items_by_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_product_items_by_id</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span>
        <span class=p>)</span>
        <span class=n>repre_icon</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=s2>&quot;awesome-font&quot;</span><span class=p>,</span>
            <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=s2>&quot;fa.file-o&quot;</span><span class=p>,</span>
            <span class=s2>&quot;color&quot;</span><span class=p>:</span> <span class=n>get_default_entity_icon_color</span><span class=p>(),</span>
        <span class=p>}</span>
        <span class=n>repre_items_by_version_id</span> <span class=o>=</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>representation</span> <span class=ow>in</span> <span class=n>representations</span><span class=p>:</span>
            <span class=n>version_id</span> <span class=o>=</span> <span class=n>representation</span><span class=p>[</span><span class=s2>&quot;versionId&quot;</span><span class=p>]</span>
            <span class=n>version_item</span> <span class=o>=</span> <span class=n>version_items_by_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>version_id</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>version_item</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                <span class=k>continue</span>
            <span class=n>product_item</span> <span class=o>=</span> <span class=n>product_items_by_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>version_item</span><span class=o>.</span><span class=n>product_id</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>product_item</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                <span class=k>continue</span>
            <span class=n>repre_id</span> <span class=o>=</span> <span class=n>representation</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span>
            <span class=n>repre_item</span> <span class=o>=</span> <span class=n>RepreItem</span><span class=p>(</span>
                <span class=n>repre_id</span><span class=p>,</span>
                <span class=n>representation</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>],</span>
                <span class=n>repre_icon</span><span class=p>,</span>
                <span class=n>product_item</span><span class=o>.</span><span class=n>product_name</span><span class=p>,</span>
                <span class=n>product_item</span><span class=o>.</span><span class=n>folder_label</span><span class=p>,</span>
            <span class=p>)</span>
            <span class=n>repre_items_by_version_id</span><span class=p>[</span><span class=n>version_id</span><span class=p>][</span><span class=n>repre_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>repre_item</span>

        <span class=n>project_cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_repre_items_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=k>for</span> <span class=n>version_id</span><span class=p>,</span> <span class=n>repre_items</span> <span class=ow>in</span> <span class=n>repre_items_by_version_id</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=n>version_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
            <span class=n>version_cache</span><span class=o>.</span><span class=n>update_data</span><span class=p>(</span><span class=n>repre_items</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.ProductsModel.change_products_group class="doc doc-heading"> <code class="highlight language-python"><span class=n>change_products_group</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span><span class=p>,</span> <span class=n>group_name</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Change group name for passed product ids.</p> <p>Group name is stored in 'attrib' of product entity and is used in UI to group items.</p> <p>Method triggers "products.group.changed" event with data: { "project_name": project_name, "folder_ids": folder_ids, "product_ids": product_ids, "group_name": group_name }</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Project name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>product_ids</code> </td> <td> <code><span title=typing.Iterable>Iterable</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Product ids to change group name for.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>group_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Group name to set.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/products.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>412</span>
<span class=normal>413</span>
<span class=normal>414</span>
<span class=normal>415</span>
<span class=normal>416</span>
<span class=normal>417</span>
<span class=normal>418</span>
<span class=normal>419</span>
<span class=normal>420</span>
<span class=normal>421</span>
<span class=normal>422</span>
<span class=normal>423</span>
<span class=normal>424</span>
<span class=normal>425</span>
<span class=normal>426</span>
<span class=normal>427</span>
<span class=normal>428</span>
<span class=normal>429</span>
<span class=normal>430</span>
<span class=normal>431</span>
<span class=normal>432</span>
<span class=normal>433</span>
<span class=normal>434</span>
<span class=normal>435</span>
<span class=normal>436</span>
<span class=normal>437</span>
<span class=normal>438</span>
<span class=normal>439</span>
<span class=normal>440</span>
<span class=normal>441</span>
<span class=normal>442</span>
<span class=normal>443</span>
<span class=normal>444</span>
<span class=normal>445</span>
<span class=normal>446</span>
<span class=normal>447</span>
<span class=normal>448</span>
<span class=normal>449</span>
<span class=normal>450</span>
<span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>change_products_group</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span><span class=p>,</span> <span class=n>group_name</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Change group name for passed product ids.</span>

<span class=sd>    Group name is stored in &#39;attrib&#39; of product entity and is used in UI</span>
<span class=sd>    to group items.</span>

<span class=sd>    Method triggers &quot;products.group.changed&quot; event with data:</span>
<span class=sd>        {</span>
<span class=sd>            &quot;project_name&quot;: project_name,</span>
<span class=sd>            &quot;folder_ids&quot;: folder_ids,</span>
<span class=sd>            &quot;product_ids&quot;: product_ids,</span>
<span class=sd>            &quot;group_name&quot;: group_name</span>
<span class=sd>        }</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (str): Project name.</span>
<span class=sd>        product_ids (Iterable[str]): Product ids to change group name for.</span>
<span class=sd>        group_name (str): Group name to set.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>product_ids</span><span class=p>:</span>
        <span class=k>return</span>

    <span class=n>product_items</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_product_items_by_id</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span>
    <span class=p>)</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>product_items</span><span class=p>:</span>
        <span class=k>return</span>

    <span class=n>session</span> <span class=o>=</span> <span class=n>OperationsSession</span><span class=p>()</span>
    <span class=n>folder_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>product_item</span> <span class=ow>in</span> <span class=n>product_items</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
        <span class=n>session</span><span class=o>.</span><span class=n>update_entity</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span>
            <span class=s2>&quot;product&quot;</span><span class=p>,</span>
            <span class=n>product_item</span><span class=o>.</span><span class=n>product_id</span><span class=p>,</span>
            <span class=p>{</span><span class=s2>&quot;attrib&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;productGroup&quot;</span><span class=p>:</span> <span class=n>group_name</span><span class=p>}}</span>
        <span class=p>)</span>
        <span class=n>folder_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>product_item</span><span class=o>.</span><span class=n>folder_id</span><span class=p>)</span>
        <span class=n>product_item</span><span class=o>.</span><span class=n>group_name</span> <span class=o>=</span> <span class=n>group_name</span>

    <span class=n>session</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>emit_event</span><span class=p>(</span>
        <span class=s2>&quot;products.group.changed&quot;</span><span class=p>,</span>
        <span class=p>{</span>
            <span class=s2>&quot;project_name&quot;</span><span class=p>:</span> <span class=n>project_name</span><span class=p>,</span>
            <span class=s2>&quot;folder_ids&quot;</span><span class=p>:</span> <span class=n>folder_ids</span><span class=p>,</span>
            <span class=s2>&quot;product_ids&quot;</span><span class=p>:</span> <span class=n>product_ids</span><span class=p>,</span>
            <span class=s2>&quot;group_name&quot;</span><span class=p>:</span> <span class=n>group_name</span><span class=p>,</span>
        <span class=p>},</span>
        <span class=n>PRODUCTS_MODEL_SENDER</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.ProductsModel.get_product_base_type_items class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_product_base_type_items</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Product base type items for the project.</p> <details class=notes open> <summary>Notes</summary> <p>This will be used for filtering product types in UI when product base types are fully implemented.</p> </details> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code>(<span title=optional>optional</span>, <span title=str>str</span>)</code> </td> <td> <div class=doc-md-description> <p>Project name.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=ayon_core.tools.loader.abstract.ProductBaseTypeItem>ProductBaseTypeItem</span>]</code> </td> <td> <div class=doc-md-description> <p>list[ProductBaseTypeDict]: Product base type items.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/products.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span>
<span class=normal>242</span>
<span class=normal>243</span>
<span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_product_base_type_items</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=n>ProductBaseTypeItem</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Product base type items for the project.</span>

<span class=sd>    Notes:</span>
<span class=sd>        This will be used for filtering product types in UI when</span>
<span class=sd>            product base types are fully implemented.</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (optional, str): Project name.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list[ProductBaseTypeDict]: Product base type items.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>project_name</span><span class=p>:</span>
        <span class=k>return</span> <span class=p>[]</span>

    <span class=n>cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_base_type_items_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
        <span class=n>icons_mapping</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_product_type_icons</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
        <span class=n>product_base_types</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=c1># TODO add temp implementation here when it is actually</span>
        <span class=c1>#   implemented and available on server.</span>
        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>ayon_api</span><span class=p>,</span> <span class=s2>&quot;get_project_product_base_types&quot;</span><span class=p>):</span>
            <span class=n>product_base_types</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_project_product_base_types</span><span class=p>(</span>
                <span class=n>project_name</span>
            <span class=p>)</span>
        <span class=n>cache</span><span class=o>.</span><span class=n>update_data</span><span class=p>([</span>
            <span class=n>ProductBaseTypeItem</span><span class=p>(</span>
                <span class=n>product_base_type</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>],</span>
                <span class=n>icons_mapping</span><span class=o>.</span><span class=n>get_icon</span><span class=p>(</span><span class=n>product_base_type</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]),</span>
            <span class=p>)</span>
            <span class=k>for</span> <span class=n>product_base_type</span> <span class=ow>in</span> <span class=n>product_base_types</span>
        <span class=p>])</span>
    <span class=k>return</span> <span class=n>cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.ProductsModel.get_product_ids_by_repre_ids class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_product_ids_by_repre_ids</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>repre_ids</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Get product ids based on passed representation ids.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Where to look for representations.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>repre_ids</code> </td> <td> <code><span title=typing.Iterable>Iterable</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Representation ids.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>set[str]: Product ids for passed representation ids.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/products.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_product_ids_by_repre_ids</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_ids</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get product ids based on passed representation ids.</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (str): Where to look for representations.</span>
<span class=sd>        repre_ids (Iterable[str]): Representation ids.</span>

<span class=sd>    Returns:</span>
<span class=sd>        set[str]: Product ids for passed representation ids.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=c1># TODO look out how to use single server call</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>repre_ids</span><span class=p>:</span>
        <span class=k>return</span> <span class=nb>set</span><span class=p>()</span>
    <span class=n>repres</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_representations</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_ids</span><span class=p>,</span> <span class=n>fields</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;versionId&quot;</span><span class=p>]</span>
    <span class=p>)</span>
    <span class=n>version_ids</span> <span class=o>=</span> <span class=p>{</span><span class=n>repre</span><span class=p>[</span><span class=s2>&quot;versionId&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>repre</span> <span class=ow>in</span> <span class=n>repres</span><span class=p>}</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>version_ids</span><span class=p>:</span>
        <span class=k>return</span> <span class=nb>set</span><span class=p>()</span>
    <span class=n>versions</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_versions</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=o>=</span><span class=n>version_ids</span><span class=p>,</span> <span class=n>fields</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;productId&quot;</span><span class=p>]</span>
    <span class=p>)</span>
    <span class=k>return</span> <span class=p>{</span><span class=n>v</span><span class=p>[</span><span class=s2>&quot;productId&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>versions</span><span class=p>}</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.ProductsModel.get_product_item class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_product_item</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>product_id</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Get product item based on passed product id.</p> <p>This method is using cached items, but if cache is not valid it also can query the item.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=Union>Union</span>[<span title=str>str</span>, None]</code> </td> <td> <div class=doc-md-description> <p>Where to look for product.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>product_id</code> </td> <td> <code><span title=Union>Union</span>[<span title=str>str</span>, None]</code> </td> <td> <div class=doc-md-description> <p>Product id to receive.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>Union[ProductItem, None]: Product item or 'None' if not found.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/products.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span>
<span class=normal>295</span>
<span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_product_item</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>product_id</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get product item based on passed product id.</span>

<span class=sd>    This method is using cached items, but if cache is not valid it also</span>
<span class=sd>    can query the item.</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (Union[str, None]): Where to look for product.</span>
<span class=sd>        product_id (Union[str, None]): Product id to receive.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Union[ProductItem, None]: Product item or &#39;None&#39; if not found.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=nb>any</span><span class=p>((</span><span class=n>project_name</span><span class=p>,</span> <span class=n>product_id</span><span class=p>)):</span>
        <span class=k>return</span> <span class=kc>None</span>

    <span class=n>product_items_by_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_item_by_id</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
    <span class=n>product_item</span> <span class=o>=</span> <span class=n>product_items_by_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>product_item</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>product_item</span>
    <span class=k>for</span> <span class=n>product_item</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_query_product_items_by_ids</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span> <span class=n>product_ids</span><span class=o>=</span><span class=p>[</span><span class=n>product_id</span><span class=p>]</span>
    <span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
        <span class=k>return</span> <span class=n>product_item</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.ProductsModel.get_product_items class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_product_items</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>folder_ids</span><span class=p>,</span> <span class=n>sender</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Product items with versions for project and folder ids.</p> <p>Product items also contain version items. They're directly connected to product items in the UI and the separation is not needed.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=Union>Union</span>[<span title=str>str</span>, None]</code> </td> <td> <div class=doc-md-description> <p>Project name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>folder_ids</code> </td> <td> <code><span title=typing.Iterable>Iterable</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Folder ids.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>sender</code> </td> <td> <code><span title=Union>Union</span>[<span title=str>str</span>, None]</code> </td> <td> <div class=doc-md-description> <p>Who triggered the method.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>list[ProductItem]: Product items.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/products.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_product_items</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>folder_ids</span><span class=p>,</span> <span class=n>sender</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Product items with versions for project and folder ids.</span>

<span class=sd>    Product items also contain version items. They&#39;re directly connected</span>
<span class=sd>    to product items in the UI and the separation is not needed.</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (Union[str, None]): Project name.</span>
<span class=sd>        folder_ids (Iterable[str]): Folder ids.</span>
<span class=sd>        sender (Union[str, None]): Who triggered the method.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list[ProductItem]: Product items.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>project_name</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>folder_ids</span><span class=p>:</span>
        <span class=k>return</span> <span class=p>[]</span>

    <span class=n>project_cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_items_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
    <span class=n>output</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>folder_ids_to_update</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>folder_id</span> <span class=ow>in</span> <span class=n>folder_ids</span><span class=p>:</span>
        <span class=n>cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>folder_id</span><span class=p>]</span>
        <span class=k>if</span> <span class=n>cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
            <span class=n>output</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>folder_ids_to_update</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>folder_id</span><span class=p>)</span>

    <span class=bp>self</span><span class=o>.</span><span class=n>_refresh_product_items</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span> <span class=n>folder_ids_to_update</span><span class=p>,</span> <span class=n>sender</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>folder_id</span> <span class=ow>in</span> <span class=n>folder_ids_to_update</span><span class=p>:</span>
        <span class=n>cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>folder_id</span><span class=p>]</span>
        <span class=n>output</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
    <span class=k>return</span> <span class=n>output</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.ProductsModel.get_product_type_items class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_product_type_items</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Product type items for project.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=Union>Union</span>[<span title=str>str</span>, None]</code> </td> <td> <div class=doc-md-description> <p>Project name.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=ayon_core.tools.loader.abstract.ProductTypeItem>ProductTypeItem</span>]</code> </td> <td> <div class=doc-md-description> <p>list[ProductTypeItem]: Product type items.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/products.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span>
<span class=normal>200</span>
<span class=normal>201</span>
<span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_product_type_items</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=n>ProductTypeItem</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Product type items for project.</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (Union[str, None]): Project name.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list[ProductTypeItem]: Product type items.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>project_name</span><span class=p>:</span>
        <span class=k>return</span> <span class=p>[]</span>

    <span class=n>cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_type_items_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
        <span class=n>icons_mapping</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_product_type_icons</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
        <span class=n>product_types</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_project_product_types</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
        <span class=n>cache</span><span class=o>.</span><span class=n>update_data</span><span class=p>([</span>
            <span class=n>ProductTypeItem</span><span class=p>(</span>
                <span class=n>product_type</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>],</span>
                <span class=n>icons_mapping</span><span class=o>.</span><span class=n>get_icon</span><span class=p>(</span><span class=n>product_type</span><span class=o>=</span><span class=n>product_type</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]),</span>
            <span class=p>)</span>
            <span class=k>for</span> <span class=n>product_type</span> <span class=ow>in</span> <span class=n>product_types</span>
        <span class=p>])</span>
    <span class=k>return</span> <span class=n>cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.ProductsModel.get_repre_items class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_repre_items</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>,</span> <span class=n>sender</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Get representation items for passed version ids.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Project name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>version_ids</code> </td> <td> <code><span title=typing.Iterable>Iterable</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Version ids.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>sender</code> </td> <td> <code><span title=Union>Union</span>[<span title=str>str</span>, None]</code> </td> <td> <div class=doc-md-description> <p>Who triggered the method.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>list[RepreItem]: Representation items.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/products.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span>
<span class=normal>366</span>
<span class=normal>367</span>
<span class=normal>368</span>
<span class=normal>369</span>
<span class=normal>370</span>
<span class=normal>371</span>
<span class=normal>372</span>
<span class=normal>373</span>
<span class=normal>374</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_repre_items</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>,</span> <span class=n>sender</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get representation items for passed version ids.</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (str): Project name.</span>
<span class=sd>        version_ids (Iterable[str]): Version ids.</span>
<span class=sd>        sender (Union[str, None]): Who triggered the method.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list[RepreItem]: Representation items.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>output</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=nb>any</span><span class=p>((</span><span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>)):</span>
        <span class=k>return</span> <span class=n>output</span>

    <span class=n>invalid_version_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
    <span class=n>project_cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_repre_items_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
    <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>version_ids</span><span class=p>:</span>
        <span class=n>version_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
        <span class=k>if</span> <span class=n>version_cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
            <span class=n>output</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>version_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>invalid_version_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>version_id</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>invalid_version_ids</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>refresh_representation_items</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>invalid_version_ids</span><span class=p>,</span> <span class=n>sender</span>
        <span class=p>)</span>

    <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>invalid_version_ids</span><span class=p>:</span>
        <span class=n>version_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
        <span class=n>output</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>version_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>

    <span class=k>return</span> <span class=n>output</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.ProductsModel.get_versions_repre_count class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_versions_repre_count</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>,</span> <span class=n>sender</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Get representation count for passed version ids.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Project name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>version_ids</code> </td> <td> <code><span title=typing.Iterable>Iterable</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Version ids.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>sender</code> </td> <td> <code><span title=Union>Union</span>[<span title=str>str</span>, None]</code> </td> <td> <div class=doc-md-description> <p>Who triggered the method.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>dict[str, int]: Number of representations by version id.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/products.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>376</span>
<span class=normal>377</span>
<span class=normal>378</span>
<span class=normal>379</span>
<span class=normal>380</span>
<span class=normal>381</span>
<span class=normal>382</span>
<span class=normal>383</span>
<span class=normal>384</span>
<span class=normal>385</span>
<span class=normal>386</span>
<span class=normal>387</span>
<span class=normal>388</span>
<span class=normal>389</span>
<span class=normal>390</span>
<span class=normal>391</span>
<span class=normal>392</span>
<span class=normal>393</span>
<span class=normal>394</span>
<span class=normal>395</span>
<span class=normal>396</span>
<span class=normal>397</span>
<span class=normal>398</span>
<span class=normal>399</span>
<span class=normal>400</span>
<span class=normal>401</span>
<span class=normal>402</span>
<span class=normal>403</span>
<span class=normal>404</span>
<span class=normal>405</span>
<span class=normal>406</span>
<span class=normal>407</span>
<span class=normal>408</span>
<span class=normal>409</span>
<span class=normal>410</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_versions_repre_count</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>,</span> <span class=n>sender</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get representation count for passed version ids.</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (str): Project name.</span>
<span class=sd>        version_ids (Iterable[str]): Version ids.</span>
<span class=sd>        sender (Union[str, None]): Who triggered the method.</span>

<span class=sd>    Returns:</span>
<span class=sd>        dict[str, int]: Number of representations by version id.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>output</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=nb>any</span><span class=p>((</span><span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>)):</span>
        <span class=k>return</span> <span class=n>output</span>

    <span class=n>invalid_version_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
    <span class=n>project_cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_repre_items_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
    <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>version_ids</span><span class=p>:</span>
        <span class=n>version_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
        <span class=k>if</span> <span class=n>version_cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
            <span class=n>output</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>version_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>())</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>invalid_version_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>version_id</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>invalid_version_ids</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>refresh_representation_items</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>invalid_version_ids</span><span class=p>,</span> <span class=n>sender</span>
        <span class=p>)</span>

    <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>invalid_version_ids</span><span class=p>:</span>
        <span class=n>version_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
        <span class=n>output</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>version_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>())</span>

    <span class=k>return</span> <span class=n>output</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.ProductsModel.reset class="doc doc-heading"> <code class="highlight language-python"><span class=n>reset</span><span class=p>()</span></code> </h3> <div class="doc doc-contents "> <p>Reset model with all cached data.</p> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/products.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>reset</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Reset model with all cached data.&quot;&quot;&quot;</span>

    <span class=bp>self</span><span class=o>.</span><span class=n>_product_item_by_id</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_version_item_by_id</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_product_folder_ids_mapping</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>

    <span class=bp>self</span><span class=o>.</span><span class=n>_product_type_items_cache</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_product_items_cache</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_repre_items_cache</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=client.ayon_core.tools.loader.models.SelectionModel class="doc doc-heading"> <code>SelectionModel</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=object>object</span></code></p> <p>Model handling selection changes.</p> <p>Triggering events: - "selection.project.changed" - "selection.folders.changed" - "selection.versions.changed"</p> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/selection.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>  4</span>
<span class=normal>  5</span>
<span class=normal>  6</span>
<span class=normal>  7</span>
<span class=normal>  8</span>
<span class=normal>  9</span>
<span class=normal> 10</span>
<span class=normal> 11</span>
<span class=normal> 12</span>
<span class=normal> 13</span>
<span class=normal> 14</span>
<span class=normal> 15</span>
<span class=normal> 16</span>
<span class=normal> 17</span>
<span class=normal> 18</span>
<span class=normal> 19</span>
<span class=normal> 20</span>
<span class=normal> 21</span>
<span class=normal> 22</span>
<span class=normal> 23</span>
<span class=normal> 24</span>
<span class=normal> 25</span>
<span class=normal> 26</span>
<span class=normal> 27</span>
<span class=normal> 28</span>
<span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>SelectionModel</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Model handling selection changes.</span>

<span class=sd>    Triggering events:</span>
<span class=sd>    - &quot;selection.project.changed&quot;</span>
<span class=sd>    - &quot;selection.folders.changed&quot;</span>
<span class=sd>    - &quot;selection.versions.changed&quot;</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>event_source</span> <span class=o>=</span> <span class=s2>&quot;selection.model&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>controller</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span> <span class=o>=</span> <span class=n>controller</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_project_name</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_folder_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_task_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_version_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_representation_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_selected_project_name</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_project_name</span>

    <span class=k>def</span><span class=w> </span><span class=nf>set_selected_project</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>):</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_project_name</span> <span class=o>==</span> <span class=n>project_name</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_project_name</span> <span class=o>=</span> <span class=n>project_name</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>emit_event</span><span class=p>(</span>
            <span class=s2>&quot;selection.project.changed&quot;</span><span class=p>,</span>
            <span class=p>{</span><span class=s2>&quot;project_name&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_project_name</span><span class=p>},</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>event_source</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_selected_folder_ids</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_folder_ids</span>

    <span class=k>def</span><span class=w> </span><span class=nf>set_selected_folders</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>folder_ids</span><span class=p>):</span>
        <span class=k>if</span> <span class=n>folder_ids</span> <span class=o>==</span> <span class=bp>self</span><span class=o>.</span><span class=n>_folder_ids</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_folder_ids</span> <span class=o>=</span> <span class=n>folder_ids</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>emit_event</span><span class=p>(</span>
            <span class=s2>&quot;selection.folders.changed&quot;</span><span class=p>,</span>
            <span class=p>{</span>
                <span class=s2>&quot;project_name&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_project_name</span><span class=p>,</span>
                <span class=s2>&quot;folder_ids&quot;</span><span class=p>:</span> <span class=n>folder_ids</span><span class=p>,</span>
            <span class=p>},</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>event_source</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_selected_task_ids</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_task_ids</span>

    <span class=k>def</span><span class=w> </span><span class=nf>set_selected_tasks</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>task_ids</span><span class=p>):</span>
        <span class=k>if</span> <span class=n>task_ids</span> <span class=o>==</span> <span class=bp>self</span><span class=o>.</span><span class=n>_task_ids</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_task_ids</span> <span class=o>=</span> <span class=n>task_ids</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>emit_event</span><span class=p>(</span>
            <span class=s2>&quot;selection.tasks.changed&quot;</span><span class=p>,</span>
            <span class=p>{</span>
                <span class=s2>&quot;project_name&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_project_name</span><span class=p>,</span>
                <span class=s2>&quot;task_ids&quot;</span><span class=p>:</span> <span class=n>task_ids</span><span class=p>,</span>
            <span class=p>},</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>event_source</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_selected_version_ids</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_version_ids</span>

    <span class=k>def</span><span class=w> </span><span class=nf>set_selected_versions</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>):</span>
        <span class=k>if</span> <span class=n>version_ids</span> <span class=o>==</span> <span class=bp>self</span><span class=o>.</span><span class=n>_version_ids</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_version_ids</span> <span class=o>=</span> <span class=n>version_ids</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>emit_event</span><span class=p>(</span>
            <span class=s2>&quot;selection.versions.changed&quot;</span><span class=p>,</span>
            <span class=p>{</span>
                <span class=s2>&quot;project_name&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_project_name</span><span class=p>,</span>
                <span class=s2>&quot;folder_ids&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_folder_ids</span><span class=p>,</span>
                <span class=s2>&quot;version_ids&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_version_ids</span><span class=p>,</span>
            <span class=p>},</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>event_source</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_selected_representation_ids</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_representation_ids</span>

    <span class=k>def</span><span class=w> </span><span class=nf>set_selected_representations</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>repre_ids</span><span class=p>):</span>
        <span class=k>if</span> <span class=n>repre_ids</span> <span class=o>==</span> <span class=bp>self</span><span class=o>.</span><span class=n>_representation_ids</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_representation_ids</span> <span class=o>=</span> <span class=n>repre_ids</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span><span class=o>.</span><span class=n>emit_event</span><span class=p>(</span>
            <span class=s2>&quot;selection.representations.changed&quot;</span><span class=p>,</span>
            <span class=p>{</span>
                <span class=s2>&quot;project_name&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_project_name</span><span class=p>,</span>
                <span class=s2>&quot;folder_ids&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_folder_ids</span><span class=p>,</span>
                <span class=s2>&quot;version_ids&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_version_ids</span><span class=p>,</span>
                <span class=s2>&quot;representation_ids&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_representation_ids</span><span class=p>,</span>
            <span class=p>}</span>
        <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=client.ayon_core.tools.loader.models.SiteSyncModel class="doc doc-heading"> <code>SiteSyncModel</code> </h2> <div class="doc doc-contents "> <p>Model handling site sync logic.</p> <p>Model cares about handling of site sync functionality. All public functions should be possible to call even if site sync is not available.</p> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/sitesync.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span>
<span class=normal>150</span>
<span class=normal>151</span>
<span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span>
<span class=normal>164</span>
<span class=normal>165</span>
<span class=normal>166</span>
<span class=normal>167</span>
<span class=normal>168</span>
<span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span>
<span class=normal>172</span>
<span class=normal>173</span>
<span class=normal>174</span>
<span class=normal>175</span>
<span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span>
<span class=normal>200</span>
<span class=normal>201</span>
<span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span>
<span class=normal>242</span>
<span class=normal>243</span>
<span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span>
<span class=normal>288</span>
<span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span>
<span class=normal>295</span>
<span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span>
<span class=normal>366</span>
<span class=normal>367</span>
<span class=normal>368</span>
<span class=normal>369</span>
<span class=normal>370</span>
<span class=normal>371</span>
<span class=normal>372</span>
<span class=normal>373</span>
<span class=normal>374</span>
<span class=normal>375</span>
<span class=normal>376</span>
<span class=normal>377</span>
<span class=normal>378</span>
<span class=normal>379</span>
<span class=normal>380</span>
<span class=normal>381</span>
<span class=normal>382</span>
<span class=normal>383</span>
<span class=normal>384</span>
<span class=normal>385</span>
<span class=normal>386</span>
<span class=normal>387</span>
<span class=normal>388</span>
<span class=normal>389</span>
<span class=normal>390</span>
<span class=normal>391</span>
<span class=normal>392</span>
<span class=normal>393</span>
<span class=normal>394</span>
<span class=normal>395</span>
<span class=normal>396</span>
<span class=normal>397</span>
<span class=normal>398</span>
<span class=normal>399</span>
<span class=normal>400</span>
<span class=normal>401</span>
<span class=normal>402</span>
<span class=normal>403</span>
<span class=normal>404</span>
<span class=normal>405</span>
<span class=normal>406</span>
<span class=normal>407</span>
<span class=normal>408</span>
<span class=normal>409</span>
<span class=normal>410</span>
<span class=normal>411</span>
<span class=normal>412</span>
<span class=normal>413</span>
<span class=normal>414</span>
<span class=normal>415</span>
<span class=normal>416</span>
<span class=normal>417</span>
<span class=normal>418</span>
<span class=normal>419</span>
<span class=normal>420</span>
<span class=normal>421</span>
<span class=normal>422</span>
<span class=normal>423</span>
<span class=normal>424</span>
<span class=normal>425</span>
<span class=normal>426</span>
<span class=normal>427</span>
<span class=normal>428</span>
<span class=normal>429</span>
<span class=normal>430</span>
<span class=normal>431</span>
<span class=normal>432</span>
<span class=normal>433</span>
<span class=normal>434</span>
<span class=normal>435</span>
<span class=normal>436</span>
<span class=normal>437</span>
<span class=normal>438</span>
<span class=normal>439</span>
<span class=normal>440</span>
<span class=normal>441</span>
<span class=normal>442</span>
<span class=normal>443</span>
<span class=normal>444</span>
<span class=normal>445</span>
<span class=normal>446</span>
<span class=normal>447</span>
<span class=normal>448</span>
<span class=normal>449</span>
<span class=normal>450</span>
<span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span>
<span class=normal>464</span>
<span class=normal>465</span>
<span class=normal>466</span>
<span class=normal>467</span>
<span class=normal>468</span>
<span class=normal>469</span>
<span class=normal>470</span>
<span class=normal>471</span>
<span class=normal>472</span>
<span class=normal>473</span>
<span class=normal>474</span>
<span class=normal>475</span>
<span class=normal>476</span>
<span class=normal>477</span>
<span class=normal>478</span>
<span class=normal>479</span>
<span class=normal>480</span>
<span class=normal>481</span>
<span class=normal>482</span>
<span class=normal>483</span>
<span class=normal>484</span>
<span class=normal>485</span>
<span class=normal>486</span>
<span class=normal>487</span>
<span class=normal>488</span>
<span class=normal>489</span>
<span class=normal>490</span>
<span class=normal>491</span>
<span class=normal>492</span>
<span class=normal>493</span>
<span class=normal>494</span>
<span class=normal>495</span>
<span class=normal>496</span>
<span class=normal>497</span>
<span class=normal>498</span>
<span class=normal>499</span>
<span class=normal>500</span>
<span class=normal>501</span>
<span class=normal>502</span>
<span class=normal>503</span>
<span class=normal>504</span>
<span class=normal>505</span>
<span class=normal>506</span>
<span class=normal>507</span>
<span class=normal>508</span>
<span class=normal>509</span>
<span class=normal>510</span>
<span class=normal>511</span>
<span class=normal>512</span>
<span class=normal>513</span>
<span class=normal>514</span>
<span class=normal>515</span>
<span class=normal>516</span>
<span class=normal>517</span>
<span class=normal>518</span>
<span class=normal>519</span>
<span class=normal>520</span>
<span class=normal>521</span>
<span class=normal>522</span>
<span class=normal>523</span>
<span class=normal>524</span>
<span class=normal>525</span>
<span class=normal>526</span>
<span class=normal>527</span>
<span class=normal>528</span>
<span class=normal>529</span>
<span class=normal>530</span>
<span class=normal>531</span>
<span class=normal>532</span>
<span class=normal>533</span>
<span class=normal>534</span>
<span class=normal>535</span>
<span class=normal>536</span>
<span class=normal>537</span>
<span class=normal>538</span>
<span class=normal>539</span>
<span class=normal>540</span>
<span class=normal>541</span>
<span class=normal>542</span>
<span class=normal>543</span>
<span class=normal>544</span>
<span class=normal>545</span>
<span class=normal>546</span>
<span class=normal>547</span>
<span class=normal>548</span>
<span class=normal>549</span>
<span class=normal>550</span>
<span class=normal>551</span>
<span class=normal>552</span>
<span class=normal>553</span>
<span class=normal>554</span>
<span class=normal>555</span>
<span class=normal>556</span>
<span class=normal>557</span>
<span class=normal>558</span>
<span class=normal>559</span>
<span class=normal>560</span>
<span class=normal>561</span>
<span class=normal>562</span>
<span class=normal>563</span>
<span class=normal>564</span>
<span class=normal>565</span>
<span class=normal>566</span>
<span class=normal>567</span>
<span class=normal>568</span>
<span class=normal>569</span>
<span class=normal>570</span>
<span class=normal>571</span>
<span class=normal>572</span>
<span class=normal>573</span>
<span class=normal>574</span>
<span class=normal>575</span>
<span class=normal>576</span>
<span class=normal>577</span>
<span class=normal>578</span>
<span class=normal>579</span>
<span class=normal>580</span>
<span class=normal>581</span>
<span class=normal>582</span>
<span class=normal>583</span>
<span class=normal>584</span>
<span class=normal>585</span>
<span class=normal>586</span>
<span class=normal>587</span>
<span class=normal>588</span>
<span class=normal>589</span>
<span class=normal>590</span>
<span class=normal>591</span>
<span class=normal>592</span>
<span class=normal>593</span>
<span class=normal>594</span>
<span class=normal>595</span>
<span class=normal>596</span>
<span class=normal>597</span>
<span class=normal>598</span>
<span class=normal>599</span>
<span class=normal>600</span>
<span class=normal>601</span>
<span class=normal>602</span>
<span class=normal>603</span>
<span class=normal>604</span>
<span class=normal>605</span>
<span class=normal>606</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>SiteSyncModel</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Model handling site sync logic.</span>

<span class=sd>    Model cares about handling of site sync functionality. All public</span>
<span class=sd>    functions should be possible to call even if site sync is not available.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>lifetime</span> <span class=o>=</span> <span class=mi>60</span>  <span class=c1># In seconds (minute by default)</span>
    <span class=n>status_lifetime</span> <span class=o>=</span> <span class=mi>20</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>controller</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_controller</span> <span class=o>=</span> <span class=n>controller</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_site_icons</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_enabled_cache</span> <span class=o>=</span> <span class=n>NestedCacheItem</span><span class=p>(</span>
            <span class=n>levels</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lifetime</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>lifetime</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_active_site_cache</span> <span class=o>=</span> <span class=n>NestedCacheItem</span><span class=p>(</span>
            <span class=n>levels</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lifetime</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>lifetime</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_remote_site_cache</span> <span class=o>=</span> <span class=n>NestedCacheItem</span><span class=p>(</span>
            <span class=n>levels</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lifetime</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>lifetime</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_version_availability_cache</span> <span class=o>=</span> <span class=n>NestedCacheItem</span><span class=p>(</span>
            <span class=n>levels</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
            <span class=n>default_factory</span><span class=o>=</span><span class=n>_default_version_availability</span><span class=p>,</span>
            <span class=n>lifetime</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>status_lifetime</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_repre_status_cache</span> <span class=o>=</span> <span class=n>NestedCacheItem</span><span class=p>(</span>
            <span class=n>levels</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
            <span class=n>default_factory</span><span class=o>=</span><span class=n>_default_repre_status</span><span class=p>,</span>
            <span class=n>lifetime</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>status_lifetime</span>
        <span class=p>)</span>

        <span class=n>manager</span> <span class=o>=</span> <span class=n>AddonsManager</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span> <span class=o>=</span> <span class=n>manager</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;sitesync&quot;</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>reset</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_site_icons</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_enabled_cache</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_active_site_cache</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_remote_site_cache</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_version_availability_cache</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_repre_status_cache</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>

    <span class=k>def</span><span class=w> </span><span class=nf>is_sitesync_enabled</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Site sync is enabled for a project.</span>

<span class=sd>        Returns false if site sync addon is not available or enabled</span>
<span class=sd>            or project has disabled it.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (Union[str, None]): Project name. If project name</span>
<span class=sd>                is &#39;None&#39;, True is returned if site sync addon</span>
<span class=sd>                is available and enabled.</span>

<span class=sd>        Returns:</span>
<span class=sd>            bool: Site sync is enabled.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_is_sitesync_addon_enabled</span><span class=p>():</span>
            <span class=k>return</span> <span class=kc>False</span>
        <span class=n>cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_enabled_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
            <span class=n>enabled</span> <span class=o>=</span> <span class=kc>True</span>
            <span class=k>if</span> <span class=n>project_name</span><span class=p>:</span>
                <span class=n>enabled</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>is_project_enabled</span><span class=p>(</span>
                    <span class=n>project_name</span><span class=p>,</span> <span class=n>single</span><span class=o>=</span><span class=kc>True</span>
                <span class=p>)</span>
            <span class=n>cache</span><span class=o>.</span><span class=n>update_data</span><span class=p>(</span><span class=n>enabled</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_active_site</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Active site name for a project.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Project name.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Union[str, None]: Remote site name.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_active_site_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
            <span class=n>site_name</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=k>if</span> <span class=n>project_name</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_is_sitesync_addon_enabled</span><span class=p>():</span>
                <span class=n>site_name</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>get_active_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
            <span class=n>cache</span><span class=o>.</span><span class=n>update_data</span><span class=p>(</span><span class=n>site_name</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_remote_site</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Remote site name for a project.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Project name.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Union[str, None]: Remote site name.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_remote_site_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
            <span class=n>site_name</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=k>if</span> <span class=n>project_name</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_is_sitesync_addon_enabled</span><span class=p>():</span>
                <span class=n>site_name</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>get_remote_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
            <span class=n>cache</span><span class=o>.</span><span class=n>update_data</span><span class=p>(</span><span class=n>site_name</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_active_site_icon_def</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Active site icon definition.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (Union[str, None]): Name of project.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Union[dict[str, Any], None]: Site icon definition.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>project_name</span> <span class=ow>or</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_sitesync_enabled</span><span class=p>(</span><span class=n>project_name</span><span class=p>):</span>
            <span class=k>return</span> <span class=kc>None</span>
        <span class=n>active_site</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_active_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_site_icon_def</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>active_site</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_remote_site_icon_def</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Remote site icon definition.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (Union[str, None]): Name of project.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Union[dict[str, Any], None]: Site icon definition.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>project_name</span> <span class=ow>or</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_sitesync_enabled</span><span class=p>(</span><span class=n>project_name</span><span class=p>):</span>
            <span class=k>return</span> <span class=kc>None</span>
        <span class=n>remote_site</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_remote_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_site_icon_def</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>remote_site</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_site_icon_def</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>site_name</span><span class=p>):</span>
        <span class=c1># use different icon for studio even if provider is &#39;local_drive&#39;</span>
        <span class=k>if</span> <span class=n>site_name</span> <span class=o>==</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>DEFAULT_SITE</span><span class=p>:</span>
            <span class=n>provider</span> <span class=o>=</span> <span class=s2>&quot;studio&quot;</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>provider</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_provider_for_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>site_name</span><span class=p>)</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_provider_icon</span><span class=p>(</span><span class=n>provider</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_version_sync_availability</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Returns how many representations are available on sites.</span>

<span class=sd>        Returned value `{version_id: (4, 6)}` denotes that locally are</span>
<span class=sd>            available 4 and remotely 6 representation.</span>
<span class=sd>        NOTE: Available means they were synced to site.</span>

<span class=sd>        Returns:</span>
<span class=sd>            dict[str, tuple[int, int]]</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_sitesync_enabled</span><span class=p>(</span><span class=n>project_name</span><span class=p>):</span>
            <span class=k>return</span> <span class=p>{</span>
                <span class=n>version_id</span><span class=p>:</span> <span class=n>_default_version_availability</span><span class=p>()</span>
                <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>version_ids</span>
            <span class=p>}</span>

        <span class=n>output</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=n>project_cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_version_availability_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=n>invalid_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
        <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>version_ids</span><span class=p>:</span>
            <span class=n>repre_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
            <span class=k>if</span> <span class=n>repre_cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
                <span class=n>output</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>repre_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>invalid_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>version_id</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>invalid_ids</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_refresh_version_availability</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span> <span class=n>invalid_ids</span>
            <span class=p>)</span>
            <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>invalid_ids</span><span class=p>:</span>
                <span class=n>version_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
                <span class=n>output</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>version_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>output</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_representations_sync_status</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span>
    <span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            representation_ids (Iterable[str]): Representation ids.</span>

<span class=sd>        Returns:</span>
<span class=sd>            dict[str, tuple[float, float]]</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_sitesync_enabled</span><span class=p>(</span><span class=n>project_name</span><span class=p>):</span>
            <span class=k>return</span> <span class=p>{</span>
                <span class=n>repre_id</span><span class=p>:</span> <span class=n>_default_repre_status</span><span class=p>()</span>
                <span class=k>for</span> <span class=n>repre_id</span> <span class=ow>in</span> <span class=n>representation_ids</span>
            <span class=p>}</span>

        <span class=n>output</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=n>project_cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_repre_status_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=n>invalid_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
        <span class=k>for</span> <span class=n>repre_id</span> <span class=ow>in</span> <span class=n>representation_ids</span><span class=p>:</span>
            <span class=n>repre_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>repre_id</span><span class=p>]</span>
            <span class=k>if</span> <span class=n>repre_cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
                <span class=n>output</span><span class=p>[</span><span class=n>repre_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>repre_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>invalid_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>repre_id</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>invalid_ids</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_refresh_representations_sync_status</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span> <span class=n>invalid_ids</span>
            <span class=p>)</span>
            <span class=k>for</span> <span class=n>repre_id</span> <span class=ow>in</span> <span class=n>invalid_ids</span><span class=p>:</span>
                <span class=n>repre_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>repre_id</span><span class=p>]</span>
                <span class=n>output</span><span class=p>[</span><span class=n>repre_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>repre_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>output</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_sitesync_action_items</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>

<span class=sd>        Args:</span>
<span class=sd>             project_name (str): Project name.</span>
<span class=sd>             representation_ids (Iterable[str]): Representation ids.</span>

<span class=sd>        Returns:</span>
<span class=sd>            list[ActionItem]: Actions that can be shown in loader.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_sitesync_enabled</span><span class=p>(</span><span class=n>project_name</span><span class=p>):</span>
            <span class=k>return</span> <span class=p>[]</span>

        <span class=n>repres_status</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_representations_sync_status</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span>
        <span class=p>)</span>

        <span class=n>repre_ids_per_identifier</span> <span class=o>=</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=nb>set</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>repre_id</span> <span class=ow>in</span> <span class=n>representation_ids</span><span class=p>:</span>
            <span class=n>repre_status</span> <span class=o>=</span> <span class=n>repres_status</span><span class=p>[</span><span class=n>repre_id</span><span class=p>]</span>
            <span class=n>local_status</span><span class=p>,</span> <span class=n>remote_status</span> <span class=o>=</span> <span class=n>repre_status</span>

            <span class=k>if</span> <span class=n>local_status</span><span class=p>:</span>
                <span class=n>repre_ids_per_identifier</span><span class=p>[</span><span class=n>UPLOAD_IDENTIFIER</span><span class=p>]</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>repre_id</span><span class=p>)</span>
                <span class=n>repre_ids_per_identifier</span><span class=p>[</span><span class=n>REMOVE_IDENTIFIER</span><span class=p>]</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>repre_id</span><span class=p>)</span>

            <span class=k>if</span> <span class=n>remote_status</span><span class=p>:</span>
                <span class=n>repre_ids_per_identifier</span><span class=p>[</span><span class=n>DOWNLOAD_IDENTIFIER</span><span class=p>]</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>repre_id</span><span class=p>)</span>

        <span class=n>action_items</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>for</span> <span class=n>identifier</span><span class=p>,</span> <span class=n>repre_ids</span> <span class=ow>in</span> <span class=n>repre_ids_per_identifier</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=k>if</span> <span class=n>identifier</span> <span class=o>==</span> <span class=n>DOWNLOAD_IDENTIFIER</span><span class=p>:</span>
                <span class=n>action_items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_create_download_action_item</span><span class=p>(</span>
                    <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_ids</span>
                <span class=p>))</span>
            <span class=k>elif</span> <span class=n>identifier</span> <span class=o>==</span> <span class=n>UPLOAD_IDENTIFIER</span><span class=p>:</span>
                <span class=n>action_items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_create_upload_action_item</span><span class=p>(</span>
                    <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_ids</span>
                <span class=p>))</span>
            <span class=k>elif</span> <span class=n>identifier</span> <span class=o>==</span> <span class=n>REMOVE_IDENTIFIER</span><span class=p>:</span>
                <span class=n>action_items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_create_delete_action_item</span><span class=p>(</span>
                    <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_ids</span>
                <span class=p>))</span>

        <span class=k>return</span> <span class=n>action_items</span>

    <span class=k>def</span><span class=w> </span><span class=nf>is_sitesync_action</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>identifier</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Should be `identifier` handled by SiteSync.</span>

<span class=sd>        Args:</span>
<span class=sd>            identifier (str): Action identifier.</span>

<span class=sd>        Returns:</span>
<span class=sd>            bool: Should action be handled by SiteSync.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>return</span> <span class=n>identifier</span> <span class=ow>in</span> <span class=p>{</span>
            <span class=n>UPLOAD_IDENTIFIER</span><span class=p>,</span>
            <span class=n>DOWNLOAD_IDENTIFIER</span><span class=p>,</span>
            <span class=n>REMOVE_IDENTIFIER</span><span class=p>,</span>
        <span class=p>}</span>

    <span class=k>def</span><span class=w> </span><span class=nf>trigger_action_item</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>identifier</span><span class=p>,</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>representation_ids</span>
    <span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Resets status for site_name or remove local files.</span>

<span class=sd>        Args:</span>
<span class=sd>            identifier (str): Action identifier.</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            representation_ids (Iterable[str]): Representation ids.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=n>active_site</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_active_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
        <span class=n>remote_site</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_remote_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>

        <span class=n>repre_entities_by_id</span> <span class=o>=</span> <span class=p>{</span>
            <span class=n>repre_entity</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]:</span> <span class=n>repre_entity</span>
            <span class=k>for</span> <span class=n>repre_entity</span> <span class=ow>in</span> <span class=n>get_representations</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span><span class=o>=</span><span class=n>representation_ids</span>
            <span class=p>)</span>
        <span class=p>}</span>
        <span class=c1># TODO get product type from product entity instead of &#39;context&#39;</span>
        <span class=c1>#   on representation</span>
        <span class=n>product_type_by_repre_id</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>for</span> <span class=n>repre_id</span><span class=p>,</span> <span class=n>repre_entity</span> <span class=ow>in</span> <span class=n>repre_entities_by_id</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=n>repre_context</span> <span class=o>=</span> <span class=n>repre_entity</span><span class=p>[</span><span class=s2>&quot;context&quot;</span><span class=p>]</span>
            <span class=n>product_type</span> <span class=o>=</span> <span class=n>repre_context</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;product&quot;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;type&quot;</span><span class=p>)</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>product_type</span><span class=p>:</span>
                <span class=n>product_type</span> <span class=o>=</span> <span class=n>repre_context</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;family&quot;</span><span class=p>)</span>

            <span class=n>product_type_by_repre_id</span><span class=p>[</span><span class=n>repre_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>product_type</span>

        <span class=k>for</span> <span class=n>repre_id</span> <span class=ow>in</span> <span class=n>representation_ids</span><span class=p>:</span>
            <span class=n>repre_entity</span> <span class=o>=</span> <span class=n>repre_entities_by_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>repre_id</span><span class=p>)</span>
            <span class=n>product_type</span> <span class=o>=</span> <span class=n>product_type_by_repre_id</span><span class=p>[</span><span class=n>repre_id</span><span class=p>]</span>
            <span class=k>if</span> <span class=n>identifier</span> <span class=o>==</span> <span class=n>DOWNLOAD_IDENTIFIER</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_add_site</span><span class=p>(</span>
                    <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_entity</span><span class=p>,</span> <span class=n>active_site</span><span class=p>,</span> <span class=n>product_type</span>
                <span class=p>)</span>

            <span class=k>elif</span> <span class=n>identifier</span> <span class=o>==</span> <span class=n>UPLOAD_IDENTIFIER</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_add_site</span><span class=p>(</span>
                    <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_entity</span><span class=p>,</span> <span class=n>remote_site</span><span class=p>,</span> <span class=n>product_type</span>
                <span class=p>)</span>

            <span class=k>elif</span> <span class=n>identifier</span> <span class=o>==</span> <span class=n>REMOVE_IDENTIFIER</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>remove_site</span><span class=p>(</span>
                    <span class=n>project_name</span><span class=p>,</span>
                    <span class=n>repre_id</span><span class=p>,</span>
                    <span class=n>active_site</span><span class=p>,</span>
                    <span class=n>remove_local_files</span><span class=o>=</span><span class=kc>True</span>
                <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_is_sitesync_addon_enabled</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Returns:</span>
<span class=sd>            bool: Site sync addon is enabled.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>return</span> <span class=kc>False</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>enabled</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_provider_for_site</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>site_name</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Provider for a site.</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Project name.</span>
<span class=sd>            site_name (str): Site name.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Union[str, None]: Provider name.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_is_sitesync_addon_enabled</span><span class=p>():</span>
            <span class=k>return</span> <span class=kc>None</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>get_provider_for_site</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>site_name</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_provider_icon</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>provider</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;site provider icons.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Union[dict[str, Any], None]: Icon of site provider.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>provider</span><span class=p>:</span>
            <span class=k>return</span> <span class=kc>None</span>

        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_site_icons</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_site_icons</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>get_site_icons</span><span class=p>()</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_site_icons</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>provider</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_refresh_version_availability</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>):</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>project_name</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>version_ids</span><span class=p>:</span>
            <span class=k>return</span>
        <span class=n>project_cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_version_availability_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>

        <span class=n>avail_by_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>get_version_availability</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span>
            <span class=n>version_ids</span><span class=p>,</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>get_active_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>),</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>get_remote_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>),</span>
        <span class=p>)</span>
        <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>version_ids</span><span class=p>:</span>
            <span class=n>status</span> <span class=o>=</span> <span class=n>avail_by_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>version_id</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>status</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>status</span> <span class=o>=</span> <span class=n>_default_version_availability</span><span class=p>()</span>
            <span class=n>project_cache</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span><span class=o>.</span><span class=n>update_data</span><span class=p>(</span><span class=n>status</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_refresh_representations_sync_status</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span>
    <span class=p>):</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>project_name</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>representation_ids</span><span class=p>:</span>
            <span class=k>return</span>
        <span class=n>project_cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_repre_status_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
        <span class=n>status_by_repre_id</span> <span class=o>=</span> <span class=p>(</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>get_representations_sync_state</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span>
                <span class=n>representation_ids</span><span class=p>,</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>get_active_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>),</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>get_remote_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>),</span>
            <span class=p>)</span>
        <span class=p>)</span>
        <span class=k>for</span> <span class=n>repre_id</span> <span class=ow>in</span> <span class=n>representation_ids</span><span class=p>:</span>
            <span class=n>status</span> <span class=o>=</span> <span class=n>status_by_repre_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>repre_id</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>status</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>status</span> <span class=o>=</span> <span class=n>_default_repre_status</span><span class=p>()</span>
            <span class=n>project_cache</span><span class=p>[</span><span class=n>repre_id</span><span class=p>]</span><span class=o>.</span><span class=n>update_data</span><span class=p>(</span><span class=n>status</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_create_download_action_item</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_action_item</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span>
            <span class=n>representation_ids</span><span class=p>,</span>
            <span class=n>DOWNLOAD_IDENTIFIER</span><span class=p>,</span>
            <span class=s2>&quot;Download&quot;</span><span class=p>,</span>
            <span class=s2>&quot;Mark representation for download locally&quot;</span><span class=p>,</span>
            <span class=s2>&quot;fa.download&quot;</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_create_upload_action_item</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_action_item</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span>
            <span class=n>representation_ids</span><span class=p>,</span>
            <span class=n>UPLOAD_IDENTIFIER</span><span class=p>,</span>
            <span class=s2>&quot;Upload&quot;</span><span class=p>,</span>
            <span class=s2>&quot;Mark representation for upload remotely&quot;</span><span class=p>,</span>
            <span class=s2>&quot;fa.upload&quot;</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_create_delete_action_item</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_action_item</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span>
            <span class=n>representation_ids</span><span class=p>,</span>
            <span class=n>REMOVE_IDENTIFIER</span><span class=p>,</span>
            <span class=s2>&quot;Remove from local&quot;</span><span class=p>,</span>
            <span class=s2>&quot;Remove local synchronization&quot;</span><span class=p>,</span>
            <span class=s2>&quot;fa.trash&quot;</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_create_action_item</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>representation_ids</span><span class=p>,</span>
        <span class=n>identifier</span><span class=p>,</span>
        <span class=n>label</span><span class=p>,</span>
        <span class=n>tooltip</span><span class=p>,</span>
        <span class=n>icon_name</span>
    <span class=p>):</span>
        <span class=k>return</span> <span class=n>ActionItem</span><span class=p>(</span>
            <span class=n>identifier</span><span class=p>,</span>
            <span class=n>label</span><span class=p>,</span>
            <span class=n>icon</span><span class=o>=</span><span class=p>{</span>
                <span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=s2>&quot;awesome-font&quot;</span><span class=p>,</span>
                <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>icon_name</span><span class=p>,</span>
                <span class=s2>&quot;color&quot;</span><span class=p>:</span> <span class=s2>&quot;#999999&quot;</span>
            <span class=p>},</span>
            <span class=n>tooltip</span><span class=o>=</span><span class=n>tooltip</span><span class=p>,</span>
            <span class=n>options</span><span class=o>=</span><span class=p>{},</span>
            <span class=n>order</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
            <span class=n>project_name</span><span class=o>=</span><span class=n>project_name</span><span class=p>,</span>
            <span class=n>folder_ids</span><span class=o>=</span><span class=p>[],</span>
            <span class=n>product_ids</span><span class=o>=</span><span class=p>[],</span>
            <span class=n>version_ids</span><span class=o>=</span><span class=p>[],</span>
            <span class=n>representation_ids</span><span class=o>=</span><span class=n>representation_ids</span><span class=p>,</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_add_site</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_entity</span><span class=p>,</span> <span class=n>site_name</span><span class=p>,</span> <span class=n>product_type</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>add_site</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_entity</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>],</span> <span class=n>site_name</span><span class=p>,</span> <span class=n>force</span><span class=o>=</span><span class=kc>True</span>
        <span class=p>)</span>

        <span class=c1># TODO this should happen in site sync addon</span>
        <span class=k>if</span> <span class=n>product_type</span> <span class=o>!=</span> <span class=s2>&quot;workfile&quot;</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=n>links</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_linked_representation_id</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span>
            <span class=n>repre_entity</span><span class=p>,</span>
            <span class=s2>&quot;reference&quot;</span>
        <span class=p>)</span>
        <span class=k>for</span> <span class=n>link_repre_id</span> <span class=ow>in</span> <span class=n>links</span><span class=p>:</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>is_representation_on_site</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span>
                <span class=n>link_repre_id</span><span class=p>,</span>
                <span class=n>site_name</span>
            <span class=p>):</span>
                <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Adding </span><span class=si>{}</span><span class=s2> to linked representation: </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                    <span class=n>site_name</span><span class=p>,</span> <span class=n>link_repre_id</span><span class=p>))</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>add_site</span><span class=p>(</span>
                    <span class=n>project_name</span><span class=p>,</span>
                    <span class=n>link_repre_id</span><span class=p>,</span>
                    <span class=n>site_name</span><span class=p>,</span>
                    <span class=n>force</span><span class=o>=</span><span class=kc>True</span>
                <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_linked_representation_id</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>repre_entity</span><span class=p>,</span>
        <span class=n>link_type</span><span class=p>,</span>
        <span class=n>max_depth</span><span class=o>=</span><span class=kc>None</span>
    <span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Returns list of linked ids of particular type (if provided).</span>

<span class=sd>        One of representation document or representation id must be passed.</span>
<span class=sd>        Note:</span>
<span class=sd>            Representation links now works only from representation through</span>
<span class=sd>                version back to representations.</span>

<span class=sd>        Todos:</span>
<span class=sd>            Missing depth query. Not sure how it did find more representations</span>
<span class=sd>                in depth, probably links to version?</span>
<span class=sd>            This function should probably live in sitesync addon?</span>

<span class=sd>        Args:</span>
<span class=sd>            project_name (str): Name of project where look for links.</span>
<span class=sd>            repre_entity (dict[str, Any]): Representation entity.</span>
<span class=sd>            link_type (str): Type of link (e.g. &#39;reference&#39;, ...).</span>
<span class=sd>            max_depth (int): Limit recursion level. Default: 0</span>

<span class=sd>        Returns:</span>
<span class=sd>            List[ObjectId] Linked representation ids.</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>repre_entity</span><span class=p>:</span>
            <span class=k>return</span> <span class=p>[]</span>

        <span class=n>version_id</span> <span class=o>=</span> <span class=n>repre_entity</span><span class=p>[</span><span class=s2>&quot;versionId&quot;</span><span class=p>]</span>
        <span class=k>if</span> <span class=n>max_depth</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>max_depth</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
            <span class=n>max_depth</span> <span class=o>=</span> <span class=mi>1</span>

        <span class=n>link_types</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=k>if</span> <span class=n>link_type</span><span class=p>:</span>
            <span class=n>link_types</span> <span class=o>=</span> <span class=p>[</span><span class=n>link_type</span><span class=p>]</span>

        <span class=c1># Store already found version ids to avoid recursion, and also to store</span>
        <span class=c1>#   output -&gt; Don&#39;t forget to remove &#39;version_id&#39; at the end!!!</span>
        <span class=n>linked_version_ids</span> <span class=o>=</span> <span class=p>{</span><span class=n>version_id</span><span class=p>}</span>
        <span class=c1># Each loop of depth will reset this variable</span>
        <span class=n>versions_to_check</span> <span class=o>=</span> <span class=p>{</span><span class=n>version_id</span><span class=p>}</span>
        <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>max_depth</span><span class=p>):</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>versions_to_check</span><span class=p>:</span>
                <span class=k>break</span>

            <span class=n>versions_links</span> <span class=o>=</span> <span class=n>get_versions_links</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span>
                <span class=n>versions_to_check</span><span class=p>,</span>
                <span class=n>link_types</span><span class=o>=</span><span class=n>link_types</span><span class=p>,</span>
                <span class=n>link_direction</span><span class=o>=</span><span class=s2>&quot;in&quot;</span><span class=p>)</span>  <span class=c1># looking for &#39;in&#39;puts for version</span>

            <span class=n>versions_to_check</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
            <span class=k>for</span> <span class=n>links</span> <span class=ow>in</span> <span class=n>versions_links</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
                <span class=k>for</span> <span class=n>link</span> <span class=ow>in</span> <span class=n>links</span><span class=p>:</span>
                    <span class=c1># Care only about version links</span>
                    <span class=k>if</span> <span class=n>link</span><span class=p>[</span><span class=s2>&quot;entityType&quot;</span><span class=p>]</span> <span class=o>!=</span> <span class=s2>&quot;version&quot;</span><span class=p>:</span>
                        <span class=k>continue</span>
                    <span class=n>entity_id</span> <span class=o>=</span> <span class=n>link</span><span class=p>[</span><span class=s2>&quot;entityId&quot;</span><span class=p>]</span>
                    <span class=n>linked_version_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>entity_id</span><span class=p>)</span>
                    <span class=n>versions_to_check</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>entity_id</span><span class=p>)</span>

        <span class=n>linked_version_ids</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>version_id</span><span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>linked_version_ids</span><span class=p>:</span>
            <span class=k>return</span> <span class=p>[]</span>
        <span class=n>representations</span> <span class=o>=</span> <span class=n>get_representations</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span>
            <span class=n>version_ids</span><span class=o>=</span><span class=n>linked_version_ids</span><span class=p>,</span>
            <span class=n>fields</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>])</span>
        <span class=k>return</span> <span class=p>[</span>
            <span class=n>repre</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span>
            <span class=k>for</span> <span class=n>repre</span> <span class=ow>in</span> <span class=n>representations</span>
        <span class=p>]</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.SiteSyncModel.get_active_site class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_active_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Active site name for a project.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Project name.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>Union[str, None]: Remote site name.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/sitesync.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_active_site</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Active site name for a project.</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (str): Project name.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Union[str, None]: Remote site name.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_active_site_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
        <span class=n>site_name</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=k>if</span> <span class=n>project_name</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_is_sitesync_addon_enabled</span><span class=p>():</span>
            <span class=n>site_name</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>get_active_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
        <span class=n>cache</span><span class=o>.</span><span class=n>update_data</span><span class=p>(</span><span class=n>site_name</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.SiteSyncModel.get_active_site_icon_def class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_active_site_icon_def</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Active site icon definition.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=Union>Union</span>[<span title=str>str</span>, None]</code> </td> <td> <div class=doc-md-description> <p>Name of project.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>Union[dict[str, Any], None]: Site icon definition.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/sitesync.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span>
<span class=normal>150</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_active_site_icon_def</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Active site icon definition.</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (Union[str, None]): Name of project.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Union[dict[str, Any], None]: Site icon definition.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>project_name</span> <span class=ow>or</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_sitesync_enabled</span><span class=p>(</span><span class=n>project_name</span><span class=p>):</span>
        <span class=k>return</span> <span class=kc>None</span>
    <span class=n>active_site</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_active_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_site_icon_def</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>active_site</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.SiteSyncModel.get_remote_site class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_remote_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Remote site name for a project.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Project name.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>Union[str, None]: Remote site name.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/sitesync.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_remote_site</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Remote site name for a project.</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (str): Project name.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Union[str, None]: Remote site name.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_remote_site_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
        <span class=n>site_name</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=k>if</span> <span class=n>project_name</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_is_sitesync_addon_enabled</span><span class=p>():</span>
            <span class=n>site_name</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>get_remote_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
        <span class=n>cache</span><span class=o>.</span><span class=n>update_data</span><span class=p>(</span><span class=n>site_name</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.SiteSyncModel.get_remote_site_icon_def class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_remote_site_icon_def</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Remote site icon definition.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=Union>Union</span>[<span title=str>str</span>, None]</code> </td> <td> <div class=doc-md-description> <p>Name of project.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>Union[dict[str, Any], None]: Site icon definition.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/sitesync.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span>
<span class=normal>164</span>
<span class=normal>165</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_remote_site_icon_def</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Remote site icon definition.</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (Union[str, None]): Name of project.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Union[dict[str, Any], None]: Site icon definition.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>project_name</span> <span class=ow>or</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_sitesync_enabled</span><span class=p>(</span><span class=n>project_name</span><span class=p>):</span>
        <span class=k>return</span> <span class=kc>None</span>
    <span class=n>remote_site</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_remote_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_site_icon_def</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>remote_site</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.SiteSyncModel.get_representations_sync_status class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_representations_sync_status</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Project name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>representation_ids</code> </td> <td> <code><span title=Iterable>Iterable</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Representation ids.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>dict[str, tuple[float, float]]</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/sitesync.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span>
<span class=normal>242</span>
<span class=normal>243</span>
<span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_representations_sync_status</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (str): Project name.</span>
<span class=sd>        representation_ids (Iterable[str]): Representation ids.</span>

<span class=sd>    Returns:</span>
<span class=sd>        dict[str, tuple[float, float]]</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_sitesync_enabled</span><span class=p>(</span><span class=n>project_name</span><span class=p>):</span>
        <span class=k>return</span> <span class=p>{</span>
            <span class=n>repre_id</span><span class=p>:</span> <span class=n>_default_repre_status</span><span class=p>()</span>
            <span class=k>for</span> <span class=n>repre_id</span> <span class=ow>in</span> <span class=n>representation_ids</span>
        <span class=p>}</span>

    <span class=n>output</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=n>project_cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_repre_status_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
    <span class=n>invalid_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>repre_id</span> <span class=ow>in</span> <span class=n>representation_ids</span><span class=p>:</span>
        <span class=n>repre_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>repre_id</span><span class=p>]</span>
        <span class=k>if</span> <span class=n>repre_cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
            <span class=n>output</span><span class=p>[</span><span class=n>repre_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>repre_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>invalid_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>repre_id</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>invalid_ids</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_refresh_representations_sync_status</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>invalid_ids</span>
        <span class=p>)</span>
        <span class=k>for</span> <span class=n>repre_id</span> <span class=ow>in</span> <span class=n>invalid_ids</span><span class=p>:</span>
            <span class=n>repre_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>repre_id</span><span class=p>]</span>
            <span class=n>output</span><span class=p>[</span><span class=n>repre_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>repre_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>
    <span class=k>return</span> <span class=n>output</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.SiteSyncModel.get_sitesync_action_items class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_sitesync_action_items</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Project name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>representation_ids</code> </td> <td> <code><span title=Iterable>Iterable</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Representation ids.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>list[ActionItem]: Actions that can be shown in loader.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/sitesync.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span>
<span class=normal>288</span>
<span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_sitesync_action_items</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>

<span class=sd>    Args:</span>
<span class=sd>         project_name (str): Project name.</span>
<span class=sd>         representation_ids (Iterable[str]): Representation ids.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list[ActionItem]: Actions that can be shown in loader.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_sitesync_enabled</span><span class=p>(</span><span class=n>project_name</span><span class=p>):</span>
        <span class=k>return</span> <span class=p>[]</span>

    <span class=n>repres_status</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_representations_sync_status</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span>
    <span class=p>)</span>

    <span class=n>repre_ids_per_identifier</span> <span class=o>=</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=nb>set</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>repre_id</span> <span class=ow>in</span> <span class=n>representation_ids</span><span class=p>:</span>
        <span class=n>repre_status</span> <span class=o>=</span> <span class=n>repres_status</span><span class=p>[</span><span class=n>repre_id</span><span class=p>]</span>
        <span class=n>local_status</span><span class=p>,</span> <span class=n>remote_status</span> <span class=o>=</span> <span class=n>repre_status</span>

        <span class=k>if</span> <span class=n>local_status</span><span class=p>:</span>
            <span class=n>repre_ids_per_identifier</span><span class=p>[</span><span class=n>UPLOAD_IDENTIFIER</span><span class=p>]</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>repre_id</span><span class=p>)</span>
            <span class=n>repre_ids_per_identifier</span><span class=p>[</span><span class=n>REMOVE_IDENTIFIER</span><span class=p>]</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>repre_id</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>remote_status</span><span class=p>:</span>
            <span class=n>repre_ids_per_identifier</span><span class=p>[</span><span class=n>DOWNLOAD_IDENTIFIER</span><span class=p>]</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>repre_id</span><span class=p>)</span>

    <span class=n>action_items</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>identifier</span><span class=p>,</span> <span class=n>repre_ids</span> <span class=ow>in</span> <span class=n>repre_ids_per_identifier</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=k>if</span> <span class=n>identifier</span> <span class=o>==</span> <span class=n>DOWNLOAD_IDENTIFIER</span><span class=p>:</span>
            <span class=n>action_items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_create_download_action_item</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_ids</span>
            <span class=p>))</span>
        <span class=k>elif</span> <span class=n>identifier</span> <span class=o>==</span> <span class=n>UPLOAD_IDENTIFIER</span><span class=p>:</span>
            <span class=n>action_items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_create_upload_action_item</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_ids</span>
            <span class=p>))</span>
        <span class=k>elif</span> <span class=n>identifier</span> <span class=o>==</span> <span class=n>REMOVE_IDENTIFIER</span><span class=p>:</span>
            <span class=n>action_items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_create_delete_action_item</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_ids</span>
            <span class=p>))</span>

    <span class=k>return</span> <span class=n>action_items</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.SiteSyncModel.get_version_sync_availability class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_version_sync_availability</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Returns how many representations are available on sites.</p> <p>Returned value <code>{version_id: (4, 6)}</code> denotes that locally are available 4 and remotely 6 representation. NOTE: Available means they were synced to site.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>dict[str, tuple[int, int]]</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/sitesync.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>175</span>
<span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span>
<span class=normal>200</span>
<span class=normal>201</span>
<span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_version_sync_availability</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>version_ids</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns how many representations are available on sites.</span>

<span class=sd>    Returned value `{version_id: (4, 6)}` denotes that locally are</span>
<span class=sd>        available 4 and remotely 6 representation.</span>
<span class=sd>    NOTE: Available means they were synced to site.</span>

<span class=sd>    Returns:</span>
<span class=sd>        dict[str, tuple[int, int]]</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_sitesync_enabled</span><span class=p>(</span><span class=n>project_name</span><span class=p>):</span>
        <span class=k>return</span> <span class=p>{</span>
            <span class=n>version_id</span><span class=p>:</span> <span class=n>_default_version_availability</span><span class=p>()</span>
            <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>version_ids</span>
        <span class=p>}</span>

    <span class=n>output</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=n>project_cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_version_availability_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
    <span class=n>invalid_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>version_ids</span><span class=p>:</span>
        <span class=n>repre_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
        <span class=k>if</span> <span class=n>repre_cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
            <span class=n>output</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>repre_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>invalid_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>version_id</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>invalid_ids</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_refresh_version_availability</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>invalid_ids</span>
        <span class=p>)</span>
        <span class=k>for</span> <span class=n>version_id</span> <span class=ow>in</span> <span class=n>invalid_ids</span><span class=p>:</span>
            <span class=n>version_cache</span> <span class=o>=</span> <span class=n>project_cache</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
            <span class=n>output</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>version_cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>
    <span class=k>return</span> <span class=n>output</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.SiteSyncModel.is_sitesync_action class="doc doc-heading"> <code class="highlight language-python"><span class=n>is_sitesync_action</span><span class=p>(</span><span class=n>identifier</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Should be <code>identifier</code> handled by SiteSync.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>identifier</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Action identifier.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>bool</code></td> <td> </td> <td> <div class=doc-md-description> <p>Should action be handled by SiteSync.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/sitesync.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>is_sitesync_action</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>identifier</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Should be `identifier` handled by SiteSync.</span>

<span class=sd>    Args:</span>
<span class=sd>        identifier (str): Action identifier.</span>

<span class=sd>    Returns:</span>
<span class=sd>        bool: Should action be handled by SiteSync.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>return</span> <span class=n>identifier</span> <span class=ow>in</span> <span class=p>{</span>
        <span class=n>UPLOAD_IDENTIFIER</span><span class=p>,</span>
        <span class=n>DOWNLOAD_IDENTIFIER</span><span class=p>,</span>
        <span class=n>REMOVE_IDENTIFIER</span><span class=p>,</span>
    <span class=p>}</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.SiteSyncModel.is_sitesync_enabled class="doc doc-heading"> <code class="highlight language-python"><span class=n>is_sitesync_enabled</span><span class=p>(</span><span class=n>project_name</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Site sync is enabled for a project.</p> <p>Returns false if site sync addon is not available or enabled or project has disabled it.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=Union>Union</span>[<span title=str>str</span>, None]</code> </td> <td> <div class=doc-md-description> <p>Project name. If project name is 'None', True is returned if site sync addon is available and enabled.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>bool</code></td> <td> </td> <td> <div class=doc-md-description> <p>Site sync is enabled.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/sitesync.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>74</span>
<span class=normal>75</span>
<span class=normal>76</span>
<span class=normal>77</span>
<span class=normal>78</span>
<span class=normal>79</span>
<span class=normal>80</span>
<span class=normal>81</span>
<span class=normal>82</span>
<span class=normal>83</span>
<span class=normal>84</span>
<span class=normal>85</span>
<span class=normal>86</span>
<span class=normal>87</span>
<span class=normal>88</span>
<span class=normal>89</span>
<span class=normal>90</span>
<span class=normal>91</span>
<span class=normal>92</span>
<span class=normal>93</span>
<span class=normal>94</span>
<span class=normal>95</span>
<span class=normal>96</span>
<span class=normal>97</span>
<span class=normal>98</span>
<span class=normal>99</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>is_sitesync_enabled</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_name</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Site sync is enabled for a project.</span>

<span class=sd>    Returns false if site sync addon is not available or enabled</span>
<span class=sd>        or project has disabled it.</span>

<span class=sd>    Args:</span>
<span class=sd>        project_name (Union[str, None]): Project name. If project name</span>
<span class=sd>            is &#39;None&#39;, True is returned if site sync addon</span>
<span class=sd>            is available and enabled.</span>

<span class=sd>    Returns:</span>
<span class=sd>        bool: Site sync is enabled.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_is_sitesync_addon_enabled</span><span class=p>():</span>
        <span class=k>return</span> <span class=kc>False</span>
    <span class=n>cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_enabled_cache</span><span class=p>[</span><span class=n>project_name</span><span class=p>]</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>cache</span><span class=o>.</span><span class=n>is_valid</span><span class=p>:</span>
        <span class=n>enabled</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=k>if</span> <span class=n>project_name</span><span class=p>:</span>
            <span class=n>enabled</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>is_project_enabled</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span> <span class=n>single</span><span class=o>=</span><span class=kc>True</span>
            <span class=p>)</span>
        <span class=n>cache</span><span class=o>.</span><span class=n>update_data</span><span class=p>(</span><span class=n>enabled</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>cache</span><span class=o>.</span><span class=n>get_data</span><span class=p>()</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_core.tools.loader.models.SiteSyncModel.trigger_action_item class="doc doc-heading"> <code class="highlight language-python"><span class=n>trigger_action_item</span><span class=p>(</span><span class=n>identifier</span><span class=p>,</span> <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Resets status for site_name or remove local files.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>identifier</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Action identifier.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>project_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Project name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>representation_ids</code> </td> <td> <code><span title=Iterable>Iterable</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Representation ids.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>client/ayon_core/tools/loader/models/sitesync.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>trigger_action_item</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span>
    <span class=n>identifier</span><span class=p>,</span>
    <span class=n>project_name</span><span class=p>,</span>
    <span class=n>representation_ids</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Resets status for site_name or remove local files.</span>

<span class=sd>    Args:</span>
<span class=sd>        identifier (str): Action identifier.</span>
<span class=sd>        project_name (str): Project name.</span>
<span class=sd>        representation_ids (Iterable[str]): Representation ids.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>active_site</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_active_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
    <span class=n>remote_site</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_remote_site</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>

    <span class=n>repre_entities_by_id</span> <span class=o>=</span> <span class=p>{</span>
        <span class=n>repre_entity</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]:</span> <span class=n>repre_entity</span>
        <span class=k>for</span> <span class=n>repre_entity</span> <span class=ow>in</span> <span class=n>get_representations</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>representation_ids</span><span class=o>=</span><span class=n>representation_ids</span>
        <span class=p>)</span>
    <span class=p>}</span>
    <span class=c1># TODO get product type from product entity instead of &#39;context&#39;</span>
    <span class=c1>#   on representation</span>
    <span class=n>product_type_by_repre_id</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=k>for</span> <span class=n>repre_id</span><span class=p>,</span> <span class=n>repre_entity</span> <span class=ow>in</span> <span class=n>repre_entities_by_id</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>repre_context</span> <span class=o>=</span> <span class=n>repre_entity</span><span class=p>[</span><span class=s2>&quot;context&quot;</span><span class=p>]</span>
        <span class=n>product_type</span> <span class=o>=</span> <span class=n>repre_context</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;product&quot;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;type&quot;</span><span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>product_type</span><span class=p>:</span>
            <span class=n>product_type</span> <span class=o>=</span> <span class=n>repre_context</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;family&quot;</span><span class=p>)</span>

        <span class=n>product_type_by_repre_id</span><span class=p>[</span><span class=n>repre_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>product_type</span>

    <span class=k>for</span> <span class=n>repre_id</span> <span class=ow>in</span> <span class=n>representation_ids</span><span class=p>:</span>
        <span class=n>repre_entity</span> <span class=o>=</span> <span class=n>repre_entities_by_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>repre_id</span><span class=p>)</span>
        <span class=n>product_type</span> <span class=o>=</span> <span class=n>product_type_by_repre_id</span><span class=p>[</span><span class=n>repre_id</span><span class=p>]</span>
        <span class=k>if</span> <span class=n>identifier</span> <span class=o>==</span> <span class=n>DOWNLOAD_IDENTIFIER</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_add_site</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_entity</span><span class=p>,</span> <span class=n>active_site</span><span class=p>,</span> <span class=n>product_type</span>
            <span class=p>)</span>

        <span class=k>elif</span> <span class=n>identifier</span> <span class=o>==</span> <span class=n>UPLOAD_IDENTIFIER</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_add_site</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span> <span class=n>repre_entity</span><span class=p>,</span> <span class=n>remote_site</span><span class=p>,</span> <span class=n>product_type</span>
            <span class=p>)</span>

        <span class=k>elif</span> <span class=n>identifier</span> <span class=o>==</span> <span class=n>REMOVE_IDENTIFIER</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_sitesync_addon</span><span class=o>.</span><span class=n>remove_site</span><span class=p>(</span>
                <span class=n>project_name</span><span class=p>,</span>
                <span class=n>repre_id</span><span class=p>,</span>
                <span class=n>active_site</span><span class=p>,</span>
                <span class=n>remove_local_files</span><span class=o>=</span><span class=kc>True</span>
            <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../../../..", "features": ["navigation.sections", "navigation.path", "navigation.prune"], "search": "../../../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../../../../assets/javascripts/bundle.f55a23d4.min.js></script> </body> </html>